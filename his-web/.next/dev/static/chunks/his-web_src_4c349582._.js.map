{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/useMenu.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { MenuItem } from '@/types';\nimport { menuApi } from '@/lib/api';\n\ninterface UseMenuReturn {\n  menus: MenuItem[];\n  flatMenus: MenuItem[];\n  isLoading: boolean;\n  error: string | null;\n  refetch: () => Promise<void>;\n  getMenuByCode: (code: string) => MenuItem | undefined;\n  getMenuByPath: (path: string) => MenuItem | undefined;\n  hasAccess: (menuCode: string, action?: 'view' | 'create' | 'edit' | 'delete' | 'export' | 'print') => boolean;\n}\n\n// Build tree structure from flat menu list\nconst buildMenuTree = (items: MenuItem[], parentId: number | null = null): MenuItem[] => {\n  return items\n    .filter((item) => item.parent_id === parentId)\n    .sort((a, b) => a.sort_order - b.sort_order)\n    .map((item) => ({\n      ...item,\n      children: buildMenuTree(items, item.id),\n    }));\n};\n\n// Flatten tree to list\nconst flattenMenuTree = (items: MenuItem[]): MenuItem[] => {\n  const result: MenuItem[] = [];\n  const traverse = (menuItems: MenuItem[]) => {\n    for (const item of menuItems) {\n      result.push(item);\n      if (item.children && item.children.length > 0) {\n        traverse(item.children);\n      }\n    }\n  };\n  traverse(items);\n  return result;\n};\n\nexport function useMenu(): UseMenuReturn {\n  const [menus, setMenus] = useState<MenuItem[]>([]);\n  const [flatMenus, setFlatMenus] = useState<MenuItem[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchMenus = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await menuApi.getUserMenus();\n\n      if (response.success && response.data) {\n        const menuTree = buildMenuTree(response.data);\n        setMenus(menuTree);\n        setFlatMenus(response.data);\n      }\n    } catch (err: unknown) {\n      const error = err as { message?: string };\n      setError(error.message || 'Failed to fetch menus');\n      setMenus([]);\n      setFlatMenus([]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchMenus();\n  }, [fetchMenus]);\n\n  const getMenuByCode = useCallback(\n    (code: string): MenuItem | undefined => {\n      return flatMenus.find((menu) => menu.menu_code === code);\n    },\n    [flatMenus]\n  );\n\n  const getMenuByPath = useCallback(\n    (path: string): MenuItem | undefined => {\n      return flatMenus.find((menu) => menu.route_path === path);\n    },\n    [flatMenus]\n  );\n\n  const hasAccess = useCallback(\n    (\n      menuCode: string,\n      action: 'view' | 'create' | 'edit' | 'delete' | 'export' | 'print' = 'view'\n    ): boolean => {\n      const menu = getMenuByCode(menuCode);\n      if (!menu) return false;\n\n      switch (action) {\n        case 'view':\n          return menu.can_view ?? false;\n        case 'create':\n          return menu.can_create ?? false;\n        case 'edit':\n          return menu.can_edit ?? false;\n        case 'delete':\n          return menu.can_delete ?? false;\n        case 'export':\n          return menu.can_export ?? false;\n        case 'print':\n          return menu.can_print ?? false;\n        default:\n          return false;\n      }\n    },\n    [getMenuByCode]\n  );\n\n  return {\n    menus,\n    flatMenus,\n    isLoading,\n    error,\n    refetch: fetchMenus,\n    getMenuByCode,\n    getMenuByPath,\n    hasAccess,\n  };\n}"],"names":[],"mappings":";;;;AAEA;AAEA;;AAJA;;;AAiBA,2CAA2C;AAC3C,MAAM,gBAAgB,CAAC,OAAmB,WAA0B,IAAI;IACtE,OAAO,MACJ,MAAM,CAAC,CAAC,OAAS,KAAK,SAAS,KAAK,UACpC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,UAAU,GAAG,EAAE,UAAU,EAC1C,GAAG,CAAC,CAAC,OAAS,CAAC;YACd,GAAG,IAAI;YACP,UAAU,cAAc,OAAO,KAAK,EAAE;QACxC,CAAC;AACL;AAEA,uBAAuB;AACvB,MAAM,kBAAkB,CAAC;IACvB,MAAM,SAAqB,EAAE;IAC7B,MAAM,WAAW,CAAC;QAChB,KAAK,MAAM,QAAQ,UAAW;YAC5B,OAAO,IAAI,CAAC;YACZ,IAAI,KAAK,QAAQ,IAAI,KAAK,QAAQ,CAAC,MAAM,GAAG,GAAG;gBAC7C,SAAS,KAAK,QAAQ;YACxB;QACF;IACF;IACA,SAAS;IACT,OAAO;AACT;AAEO,SAAS;;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,uLAAQ,EAAa,EAAE;IACjD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,uLAAQ,EAAa,EAAE;IACzD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,uLAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,uLAAQ,EAAgB;IAElD,MAAM,aAAa,IAAA,0LAAW;2CAAC;YAC7B,aAAa;YACb,SAAS;YAET,IAAI;gBACF,MAAM,WAAW,MAAM,6IAAO,CAAC,YAAY;gBAE3C,IAAI,SAAS,OAAO,IAAI,SAAS,IAAI,EAAE;oBACrC,MAAM,WAAW,cAAc,SAAS,IAAI;oBAC5C,SAAS;oBACT,aAAa,SAAS,IAAI;gBAC5B;YACF,EAAE,OAAO,KAAc;gBACrB,MAAM,QAAQ;gBACd,SAAS,MAAM,OAAO,IAAI;gBAC1B,SAAS,EAAE;gBACX,aAAa,EAAE;YACjB,SAAU;gBACR,aAAa;YACf;QACF;0CAAG,EAAE;IAEL,IAAA,wLAAS;6BAAC;YACR;QACF;4BAAG;QAAC;KAAW;IAEf,MAAM,gBAAgB,IAAA,0LAAW;8CAC/B,CAAC;YACC,OAAO,UAAU,IAAI;sDAAC,CAAC,OAAS,KAAK,SAAS,KAAK;;QACrD;6CACA;QAAC;KAAU;IAGb,MAAM,gBAAgB,IAAA,0LAAW;8CAC/B,CAAC;YACC,OAAO,UAAU,IAAI;sDAAC,CAAC,OAAS,KAAK,UAAU,KAAK;;QACtD;6CACA;QAAC;KAAU;IAGb,MAAM,YAAY,IAAA,0LAAW;0CAC3B,CACE,UACA,SAAqE,MAAM;YAE3E,MAAM,OAAO,cAAc;YAC3B,IAAI,CAAC,MAAM,OAAO;YAElB,OAAQ;gBACN,KAAK;oBACH,OAAO,KAAK,QAAQ,IAAI;gBAC1B,KAAK;oBACH,OAAO,KAAK,UAAU,IAAI;gBAC5B,KAAK;oBACH,OAAO,KAAK,QAAQ,IAAI;gBAC1B,KAAK;oBACH,OAAO,KAAK,UAAU,IAAI;gBAC5B,KAAK;oBACH,OAAO,KAAK,UAAU,IAAI;gBAC5B,KAAK;oBACH,OAAO,KAAK,SAAS,IAAI;gBAC3B;oBACE,OAAO;YACX;QACF;yCACA;QAAC;KAAc;IAGjB,OAAO;QACL;QACA;QACA;QACA;QACA,SAAS;QACT;QACA;QACA;IACF;AACF;GApFgB"}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/providers/index.ts"],"sourcesContent":["export * from './ThemeProvider';\nexport * from './LayoutProvider';\nexport * from './AuthProvider';\nexport * from './MenuProvider';"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/usePermissions.ts"],"sourcesContent":["'use client';\n\nimport { useCallback } from 'react';\nimport { useAuth } from '@/components/providers';\nimport { useMenu } from './useMenu';\n\ninterface UsePermissionsReturn {\n  hasPermission: (permissionCode: string) => boolean;\n  hasMenuAccess: (menuCode: string, action?: 'view' | 'create' | 'edit' | 'delete' | 'export' | 'print') => boolean;\n  hasAnyPermission: (permissionCodes: string[]) => boolean;\n  hasAllPermissions: (permissionCodes: string[]) => boolean;\n  isAdmin: boolean;\n}\n\nexport function usePermissions(): UsePermissionsReturn {\n  const { user } = useAuth();\n  const { hasAccess } = useMenu();\n\n  const hasPermission = useCallback(\n    (permissionCode: string): boolean => {\n      if (!user?.permissions) return false;\n      return user.permissions.includes(permissionCode);\n    },\n    [user?.permissions]\n  );\n\n  const hasMenuAccess = useCallback(\n    (\n      menuCode: string,\n      action: 'view' | 'create' | 'edit' | 'delete' | 'export' | 'print' = 'view'\n    ): boolean => {\n      return hasAccess(menuCode, action);\n    },\n    [hasAccess]\n  );\n\n  const hasAnyPermission = useCallback(\n    (permissionCodes: string[]): boolean => {\n      return permissionCodes.some((code) => hasPermission(code));\n    },\n    [hasPermission]\n  );\n\n  const hasAllPermissions = useCallback(\n    (permissionCodes: string[]): boolean => {\n      return permissionCodes.every((code) => hasPermission(code));\n    },\n    [hasPermission]\n  );\n\n  const isAdmin = user?.role === 'admin' || hasPermission('admin');\n\n  return {\n    hasPermission,\n    hasMenuAccess,\n    hasAnyPermission,\n    hasAllPermissions,\n    isAdmin,\n  };\n}"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;;AAJA;;;;AAcO,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,2KAAO;IACxB,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,mJAAO;IAE7B,MAAM,gBAAgB,IAAA,0LAAW;qDAC/B,CAAC;YACC,IAAI,CAAC,MAAM,aAAa,OAAO;YAC/B,OAAO,KAAK,WAAW,CAAC,QAAQ,CAAC;QACnC;oDACA;QAAC,MAAM;KAAY;IAGrB,MAAM,gBAAgB,IAAA,0LAAW;qDAC/B,CACE,UACA,SAAqE,MAAM;YAE3E,OAAO,UAAU,UAAU;QAC7B;oDACA;QAAC;KAAU;IAGb,MAAM,mBAAmB,IAAA,0LAAW;wDAClC,CAAC;YACC,OAAO,gBAAgB,IAAI;gEAAC,CAAC,OAAS,cAAc;;QACtD;uDACA;QAAC;KAAc;IAGjB,MAAM,oBAAoB,IAAA,0LAAW;yDACnC,CAAC;YACC,OAAO,gBAAgB,KAAK;iEAAC,CAAC,OAAS,cAAc;;QACvD;wDACA;QAAC;KAAc;IAGjB,MAAM,UAAU,MAAM,SAAS,WAAW,cAAc;IAExD,OAAO;QACL;QACA;QACA;QACA;QACA;IACF;AACF;GA7CgB;;QACG,2KAAO;QACF,mJAAO"}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/usePatients.ts"],"sourcesContent":["// =============================================================================\n// File: src/hooks/usePatients.ts\n// Description: Patient data fetching hooks\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { patientApi } from '@/lib/api';\nimport { \n  PatientListItem, \n  PatientDetail, \n  PatientSearchParams, \n  PatientStats,\n  PatientListResponse,\n} from '@/types/patient.types';\n\n// ============================================\n// usePatientList - Get paginated patient list\n// ============================================\ninterface UsePatientListOptions {\n  initialPage?: number;\n  initialLimit?: number;\n  autoFetch?: boolean;\n}\n\ninterface UsePatientListReturn {\n  patients: PatientListItem[];\n  loading: boolean;\n  error: string | null;\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  };\n  filters: PatientSearchParams;\n  setFilters: (filters: PatientSearchParams) => void;\n  setPage: (page: number) => void;\n  setLimit: (limit: number) => void;\n  refresh: () => Promise<void>;\n}\n\nexport function usePatientList(options: UsePatientListOptions = {}): UsePatientListReturn {\n  const { initialPage = 1, initialLimit = 20, autoFetch = true } = options;\n\n  const [patients, setPatients] = useState<PatientListItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [pagination, setPagination] = useState({\n    page: initialPage,\n    limit: initialLimit,\n    total: 0,\n    totalPages: 0,\n  });\n  const [filters, setFilters] = useState<PatientSearchParams>({});\n\n  const fetchPatients = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const response = await patientApi.getList({\n        page: pagination.page,\n        limit: pagination.limit,\n        search: filters.query,\n        pttype: filters.pttype,\n        chwpart: filters.chwpart,\n        amppart: filters.amppart,\n        isActive: filters.isDead === undefined ? undefined : !filters.isDead,\n      });\n\n      setPatients(response.data);\n      setPagination(prev => ({\n        ...prev,\n        total: response.pagination.total,\n        totalPages: response.pagination.totalPages,\n      }));\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch patients';\n      setError(message);\n      console.error('Error fetching patients:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [pagination.page, pagination.limit, filters]);\n\n  useEffect(() => {\n    if (autoFetch) {\n      fetchPatients();\n    }\n  }, [fetchPatients, autoFetch]);\n\n  const setPage = useCallback((page: number) => {\n    setPagination(prev => ({ ...prev, page }));\n  }, []);\n\n  const setLimit = useCallback((limit: number) => {\n    setPagination(prev => ({ ...prev, page: 1, limit }));\n  }, []);\n\n  const handleSetFilters = useCallback((newFilters: PatientSearchParams) => {\n    setFilters(newFilters);\n    setPagination(prev => ({ ...prev, page: 1 }));\n  }, []);\n\n  return {\n    patients,\n    loading,\n    error,\n    pagination,\n    filters,\n    setFilters: handleSetFilters,\n    setPage,\n    setLimit,\n    refresh: fetchPatients,\n  };\n}\n\n// ============================================\n// usePatientDetail - Get single patient detail\n// ============================================\ninterface UsePatientDetailReturn {\n  patient: PatientDetail | null;\n  loading: boolean;\n  error: string | null;\n  refresh: () => Promise<void>;\n}\n\nexport function usePatientDetail(hn: string | null): UsePatientDetailReturn {\n  const [patient, setPatient] = useState<PatientDetail | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchPatient = useCallback(async () => {\n    if (!hn) {\n      setPatient(null);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await patientApi.getByHn(hn);\n      setPatient(response.data);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch patient';\n      setError(message);\n      console.error('Error fetching patient:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [hn]);\n\n  useEffect(() => {\n    fetchPatient();\n  }, [fetchPatient]);\n\n  return {\n    patient,\n    loading,\n    error,\n    refresh: fetchPatient,\n  };\n}\n\n// ============================================\n// usePatientSearch - Quick search patients\n// ============================================\ninterface UsePatientSearchReturn {\n  results: PatientListItem[];\n  loading: boolean;\n  search: (query: string) => Promise<void>;\n  clear: () => void;\n}\n\nexport function usePatientSearch(debounceMs = 300): UsePatientSearchReturn {\n  const [results, setResults] = useState<PatientListItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [searchTimeout, setSearchTimeout] = useState<NodeJS.Timeout | null>(null);\n\n  const search = useCallback(async (query: string) => {\n    // Clear previous timeout\n    if (searchTimeout) {\n      clearTimeout(searchTimeout);\n    }\n\n    if (!query || query.length < 2) {\n      setResults([]);\n      return;\n    }\n\n    setLoading(true);\n\n    // Debounce the search\n    const timeout = setTimeout(async () => {\n      try {\n        const data = await patientApi.search(query, 10);\n        setResults(data);\n      } catch (err) {\n        console.error('Error searching patients:', err);\n        setResults([]);\n      } finally {\n        setLoading(false);\n      }\n    }, debounceMs);\n\n    setSearchTimeout(timeout);\n  }, [debounceMs, searchTimeout]);\n\n  const clear = useCallback(() => {\n    if (searchTimeout) {\n      clearTimeout(searchTimeout);\n    }\n    setResults([]);\n    setLoading(false);\n  }, [searchTimeout]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (searchTimeout) {\n        clearTimeout(searchTimeout);\n      }\n    };\n  }, [searchTimeout]);\n\n  return {\n    results,\n    loading,\n    search,\n    clear,\n  };\n}\n\n// ============================================\n// usePatientStats - Get patient statistics\n// ============================================\ninterface UsePatientStatsReturn {\n  stats: PatientStats | null;\n  loading: boolean;\n  error: string | null;\n  refresh: () => Promise<void>;\n}\n\nexport function usePatientStats(): UsePatientStatsReturn {\n  const [stats, setStats] = useState<PatientStats | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchStats = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const data = await patientApi.getStats();\n      setStats(data);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch stats';\n      setError(message);\n      console.error('Error fetching patient stats:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchStats();\n  }, [fetchStats]);\n\n  return {\n    stats,\n    loading,\n    error,\n    refresh: fetchStats,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 495, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/useLookups.ts"],"sourcesContent":["// =============================================================================\n// File: src/hooks/useLookups.ts\n// Description: Lookup data fetching hooks for dropdowns\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { \n  lookupApi, \n  LookupItem, \n  PnameLookup, \n  PttypeLookup, \n  SubdistrictLookup,\n  AddressSearchResult,\n} from '@/lib/api';\n\n// ============================================\n// Generic Lookup Hook\n// ============================================\ninterface UseLookupReturn<T> {\n  data: T[];\n  loading: boolean;\n  error: string | null;\n  refresh: () => Promise<void>;\n}\n\nfunction createLookupHook<T>(\n  fetchFn: () => Promise<{ success: boolean; data: T[] }>\n) {\n  return function useLookup(): UseLookupReturn<T> {\n    const [data, setData] = useState<T[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const fetch = useCallback(async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const response = await fetchFn();\n        setData(response.data);\n      } catch (err) {\n        const message = err instanceof Error ? err.message : 'Failed to fetch data';\n        setError(message);\n        console.error('Lookup error:', err);\n      } finally {\n        setLoading(false);\n      }\n    }, []);\n\n    useEffect(() => {\n      fetch();\n    }, [fetch]);\n\n    return { data, loading, error, refresh: fetch };\n  };\n}\n\n// ============================================\n// Individual Lookup Hooks\n// ============================================\n\n// คำนำหน้าชื่อ\nexport function usePnames(sex?: 'M' | 'F'): UseLookupReturn<PnameLookup> {\n  const [data, setData] = useState<PnameLookup[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetch = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await lookupApi.getPnames(sex);\n      setData(response.data);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch pnames';\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }, [sex]);\n\n  useEffect(() => {\n    fetch();\n  }, [fetch]);\n\n  return { data, loading, error, refresh: fetch };\n}\n\n// อาชีพ\nexport const useOccupations = createLookupHook(lookupApi.getOccupations);\n\n// เชื้อชาติ/สัญชาติ\nexport const useNationalities = createLookupHook(lookupApi.getNationalities);\n\n// ศาสนา\nexport const useReligions = createLookupHook(lookupApi.getReligions);\n\n// สถานะสมรส\nexport const useMarryStatuses = createLookupHook(lookupApi.getMarryStatuses);\n\n// การศึกษา\nexport const useEducations = createLookupHook(lookupApi.getEducations);\n\n// ความสัมพันธ์\nexport const useRelationTypes = createLookupHook(lookupApi.getRelationTypes);\n\n// สิทธิการรักษา\nexport function usePttypes(activeOnly = true): UseLookupReturn<PttypeLookup> {\n  const [data, setData] = useState<PttypeLookup[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetch = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await lookupApi.getPttypes(activeOnly);\n      setData(response.data);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch pttypes';\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }, [activeOnly]);\n\n  useEffect(() => {\n    fetch();\n  }, [fetch]);\n\n  return { data, loading, error, refresh: fetch };\n}\n\n// ============================================\n// Thai Address Hooks\n// ============================================\n\n// จังหวัด\nexport const useProvinces = createLookupHook(lookupApi.getProvinces);\n\n// อำเภอ\nexport function useDistricts(chwpart: string | null): UseLookupReturn<LookupItem> {\n  const [data, setData] = useState<LookupItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetch = useCallback(async () => {\n    if (!chwpart) {\n      setData([]);\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await lookupApi.getDistricts(chwpart);\n      setData(response.data);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch districts';\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }, [chwpart]);\n\n  useEffect(() => {\n    fetch();\n  }, [fetch]);\n\n  return { data, loading, error, refresh: fetch };\n}\n\n// ตำบล\nexport function useSubdistricts(\n  chwpart: string | null, \n  amppart: string | null\n): UseLookupReturn<SubdistrictLookup> {\n  const [data, setData] = useState<SubdistrictLookup[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetch = useCallback(async () => {\n    if (!chwpart || !amppart) {\n      setData([]);\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await lookupApi.getSubdistricts(chwpart, amppart);\n      setData(response.data);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch subdistricts';\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }, [chwpart, amppart]);\n\n  useEffect(() => {\n    fetch();\n  }, [fetch]);\n\n  return { data, loading, error, refresh: fetch };\n}\n\n// ============================================\n// Address Search Hook\n// ============================================\ninterface UseAddressSearchReturn {\n  results: AddressSearchResult[];\n  loading: boolean;\n  search: (query: string) => Promise<void>;\n  clear: () => void;\n}\n\nexport function useAddressSearch(debounceMs = 300): UseAddressSearchReturn {\n  const [results, setResults] = useState<AddressSearchResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [searchTimeout, setSearchTimeout] = useState<NodeJS.Timeout | null>(null);\n\n  const search = useCallback(async (query: string) => {\n    if (searchTimeout) {\n      clearTimeout(searchTimeout);\n    }\n\n    if (!query || query.length < 2) {\n      setResults([]);\n      return;\n    }\n\n    setLoading(true);\n\n    const timeout = setTimeout(async () => {\n      try {\n        const response = await lookupApi.searchAddress(query, 20);\n        setResults(response.data);\n      } catch (err) {\n        console.error('Error searching address:', err);\n        setResults([]);\n      } finally {\n        setLoading(false);\n      }\n    }, debounceMs);\n\n    setSearchTimeout(timeout);\n  }, [debounceMs, searchTimeout]);\n\n  const clear = useCallback(() => {\n    if (searchTimeout) {\n      clearTimeout(searchTimeout);\n    }\n    setResults([]);\n    setLoading(false);\n  }, [searchTimeout]);\n\n  useEffect(() => {\n    return () => {\n      if (searchTimeout) {\n        clearTimeout(searchTimeout);\n      }\n    };\n  }, [searchTimeout]);\n\n  return { results, loading, search, clear };\n}\n\n// ============================================\n// Combined Thai Address Hook\n// ============================================\ninterface UseThaiAddressReturn {\n  provinces: LookupItem[];\n  districts: LookupItem[];\n  subdistricts: SubdistrictLookup[];\n  loadingProvinces: boolean;\n  loadingDistricts: boolean;\n  loadingSubdistricts: boolean;\n  selectedProvince: string | null;\n  selectedDistrict: string | null;\n  selectedSubdistrict: string | null;\n  setProvince: (code: string | null) => void;\n  setDistrict: (code: string | null) => void;\n  setSubdistrict: (code: string | null) => void;\n  getPostalCode: () => string | null;\n  reset: () => void;\n}\n\nexport function useThaiAddress(initialValues?: {\n  chwpart?: string | null;\n  amppart?: string | null;\n  tmbpart?: string | null;\n}): UseThaiAddressReturn {\n  const [selectedProvince, setSelectedProvince] = useState<string | null>(initialValues?.chwpart || null);\n  const [selectedDistrict, setSelectedDistrict] = useState<string | null>(initialValues?.amppart || null);\n  const [selectedSubdistrict, setSelectedSubdistrict] = useState<string | null>(initialValues?.tmbpart || null);\n\n  const { data: provinces, loading: loadingProvinces } = useProvinces();\n  const { data: districts, loading: loadingDistricts } = useDistricts(selectedProvince);\n  const { data: subdistricts, loading: loadingSubdistricts } = useSubdistricts(selectedProvince, selectedDistrict);\n\n  const setProvince = useCallback((code: string | null) => {\n    setSelectedProvince(code);\n    setSelectedDistrict(null);\n    setSelectedSubdistrict(null);\n  }, []);\n\n  const setDistrict = useCallback((code: string | null) => {\n    setSelectedDistrict(code);\n    setSelectedSubdistrict(null);\n  }, []);\n\n  const setSubdistrict = useCallback((code: string | null) => {\n    setSelectedSubdistrict(code);\n  }, []);\n\n  const getPostalCode = useCallback((): string | null => {\n    if (!selectedSubdistrict) return null;\n    const subdistrict = subdistricts.find(s => s.code === selectedSubdistrict);\n    return subdistrict?.pocode || null;\n  }, [selectedSubdistrict, subdistricts]);\n\n  const reset = useCallback(() => {\n    setSelectedProvince(null);\n    setSelectedDistrict(null);\n    setSelectedSubdistrict(null);\n  }, []);\n\n  return {\n    provinces,\n    districts,\n    subdistricts,\n    loadingProvinces,\n    loadingDistricts,\n    loadingSubdistricts,\n    selectedProvince,\n    selectedDistrict,\n    selectedSubdistrict,\n    setProvince,\n    setDistrict,\n    setSubdistrict,\n    getPostalCode,\n    reset,\n  };\n}\n\n// ============================================\n// All Lookups Hook (for forms)\n// ============================================\ninterface UseAllLookupsReturn {\n  pnames: PnameLookup[];\n  pttypes: PttypeLookup[];\n  occupations: LookupItem[];\n  nationalities: LookupItem[];\n  religions: LookupItem[];\n  marryStatuses: LookupItem[];\n  educations: LookupItem[];\n  relationTypes: LookupItem[];\n  loading: boolean;\n}\n\nexport function useAllLookups(): UseAllLookupsReturn {\n  const pnamesResult = usePnames();\n  const pttypesResult = usePttypes();\n  const occupationsResult = useOccupations();\n  const nationalitiesResult = useNationalities();\n  const religionsResult = useReligions();\n  const marryStatusesResult = useMarryStatuses();\n  const educationsResult = useEducations();\n  const relationTypesResult = useRelationTypes();\n\n  const loading = \n    pnamesResult.loading ||\n    pttypesResult.loading ||\n    occupationsResult.loading ||\n    nationalitiesResult.loading ||\n    religionsResult.loading ||\n    marryStatusesResult.loading ||\n    educationsResult.loading ||\n    relationTypesResult.loading;\n\n  return {\n    pnames: pnamesResult.data,\n    pttypes: pttypesResult.data,\n    occupations: occupationsResult.data,\n    nationalities: nationalitiesResult.data,\n    religions: religionsResult.data,\n    marryStatuses: marryStatusesResult.data,\n    educations: educationsResult.data,\n    relationTypes: relationTypesResult.data,\n    loading,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 914, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/index.ts"],"sourcesContent":["export * from './useMenu';\nexport * from './usePermissions';\nexport * from './usePatients';\nexport * from './useLookups';"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 930, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/usePatientImages.ts"],"sourcesContent":["// =============================================================================\n// File: src/hooks/usePatientImages.ts\n// Description: React hooks for patient images management\n// =============================================================================\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { patientImageApi } from '@/lib/api';\n\n// ============================================\n// Types\n// ============================================\nexport interface PatientImage {\n  hn: string;\n  imageName: string;\n  width: number | null;\n  height: number | null;\n  captureDate: string | null;\n}\n\nexport interface PatientImageWithData extends PatientImage {\n  image: string; // Base64 encoded\n}\n\n// ============================================\n// usePatientImages - Get all images for a patient\n// ============================================\nexport function usePatientImages(hn: string | null | undefined) {\n  const [images, setImages] = useState<PatientImage[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchImages = useCallback(async () => {\n    if (!hn) {\n      setImages([]);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const data = await patientImageApi.getByHn(hn);\n      setImages(data);\n    } catch (err) {\n      console.error('Error fetching patient images:', err);\n      setError('ไม่สามารถโหลดรูปภาพได้');\n      setImages([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [hn]);\n\n  useEffect(() => {\n    fetchImages();\n  }, [fetchImages]);\n\n  return {\n    images,\n    loading,\n    error,\n    refetch: fetchImages,\n  };\n}\n\n// ============================================\n// usePatientProfileImage - Get profile image for a patient\n// ============================================\nexport function usePatientProfileImage(hn: string | null | undefined) {\n  const [imageData, setImageData] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchImage = useCallback(async () => {\n    if (!hn) {\n      setImageData(null);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const data = await patientImageApi.getProfileImage(hn);\n      setImageData(data?.image || null);\n    } catch (err) {\n      console.error('Error fetching patient image:', err);\n      setError('ไม่สามารถโหลดรูปภาพได้');\n      setImageData(null);\n    } finally {\n      setLoading(false);\n    }\n  }, [hn]);\n\n  useEffect(() => {\n    fetchImage();\n  }, [fetchImage]);\n\n  return {\n    imageData,\n    loading,\n    error,\n    refetch: fetchImage,\n  };\n}\n\n// ============================================\n// usePatientImageUpload - Upload image for a patient\n// ============================================\nexport function usePatientImageUpload() {\n  const [uploading, setUploading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const upload = useCallback(async (\n    hn: string,\n    imageData: string,\n    width?: number,\n    height?: number\n  ): Promise<boolean> => {\n    setUploading(true);\n    setError(null);\n\n    try {\n      await patientImageApi.upload(hn, imageData, width, height);\n      return true;\n    } catch (err) {\n      console.error('Error uploading image:', err);\n      setError('ไม่สามารถอัปโหลดรูปภาพได้');\n      return false;\n    } finally {\n      setUploading(false);\n    }\n  }, []);\n\n  return {\n    upload,\n    uploading,\n    error,\n  };\n}\n\n// ============================================\n// usePatientImageDelete - Delete image for a patient\n// ============================================\nexport function usePatientImageDelete() {\n  const [deleting, setDeleting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const deleteImage = useCallback(async (hn: string): Promise<boolean> => {\n    setDeleting(true);\n    setError(null);\n\n    try {\n      await patientImageApi.delete(hn);\n      return true;\n    } catch (err) {\n      console.error('Error deleting image:', err);\n      setError('ไม่สามารถลบรูปภาพได้');\n      return false;\n    } finally {\n      setDeleting(false);\n    }\n  }, []);\n\n  return {\n    deleteImage,\n    deleting,\n    error,\n  };\n}\n\n// ============================================\n// usePatientImageManager - Full image management\n// ============================================\nexport function usePatientImageManager(hn: string | null | undefined) {\n  const { images, loading: loadingList, error: listError, refetch } = usePatientImages(hn);\n  const { imageData: primaryImage, loading: loadingPrimary, refetch: refetchImage } = usePatientProfileImage(hn);\n  const { upload, uploading, error: uploadError } = usePatientImageUpload();\n  const { deleteImage, deleting, error: deleteError } = usePatientImageDelete();\n\n  const handleUpload = useCallback(async (\n    imageData: string,\n    width?: number,\n    height?: number\n  ): Promise<boolean> => {\n    if (!hn) return false;\n\n    const success = await upload(hn, imageData, width, height);\n    if (success) {\n      await refetchImage();\n      await refetch();\n    }\n    return success;\n  }, [hn, upload, refetch, refetchImage]);\n\n  const handleDelete = useCallback(async (): Promise<boolean> => {\n    if (!hn) return false;\n\n    const success = await deleteImage(hn);\n    if (success) {\n      await refetchImage();\n      await refetch();\n    }\n    return success;\n  }, [hn, deleteImage, refetch, refetchImage]);\n\n  return {\n    images,\n    primaryImage,\n    loading: loadingList || loadingPrimary,\n    uploading,\n    deleting,\n    error: listError || uploadError || deleteError,\n    upload: handleUpload,\n    delete: handleDelete,\n    refetch,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1154, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/patient-image/PatientImageUpload.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/ui/patient-image/PatientImageUpload.tsx\n// Description: Patient Image Upload Component with Camera & File Browse\n// =============================================================================\n\n'use client';\n\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport {\n  Camera,\n  Upload,\n  X,\n  RefreshCw,\n  Trash2,\n  User,\n  Check,\n  SwitchCamera,\n  Image as ImageIcon,\n  ZoomIn,\n} from 'lucide-react';\n\ninterface PatientImageUploadProps {\n  hn?: string;\n  currentImage?: string | null;\n  onImageChange?: (imageData: string | null, width?: number, height?: number) => void;\n  onUpload?: (imageData: string, width: number, height: number) => Promise<void>;\n  size?: 'sm' | 'md' | 'lg';\n  editable?: boolean;\n  className?: string;\n}\n\nexport default function PatientImageUpload({\n  hn,\n  currentImage,\n  onImageChange,\n  onUpload,\n  size = 'md',\n  editable = true,\n  className = '',\n}: PatientImageUploadProps) {\n  const [image, setImage] = useState<string | null>(currentImage || null);\n  const [showCamera, setShowCamera] = useState(false);\n  const [showOptions, setShowOptions] = useState(false);\n  const [showPreview, setShowPreview] = useState(false);\n  const [cameraStream, setCameraStream] = useState<MediaStream | null>(null);\n  const [facingMode, setFacingMode] = useState<'user' | 'environment'>('user');\n  const [uploading, setUploading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const sizeClasses = {\n    sm: 'size-16',\n    md: 'size-24',\n    lg: 'size-32',\n  };\n\n  const iconSizes = {\n    sm: 20,\n    md: 32,\n    lg: 40,\n  };\n\n  // Update image when currentImage prop changes\n  useEffect(() => {\n    if (currentImage !== undefined) {\n      setImage(currentImage);\n    }\n  }, [currentImage]);\n\n  // Cleanup camera stream on unmount\n  useEffect(() => {\n    return () => {\n      if (cameraStream) {\n        cameraStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, [cameraStream]);\n\n  // Start camera\n  const startCamera = useCallback(async () => {\n    try {\n      setError(null);\n      \n      // Stop existing stream\n      if (cameraStream) {\n        cameraStream.getTracks().forEach(track => track.stop());\n      }\n\n      const constraints: MediaStreamConstraints = {\n        video: {\n          facingMode: facingMode,\n          width: { ideal: 640 },\n          height: { ideal: 480 },\n        },\n        audio: false,\n      };\n\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      setCameraStream(stream);\n\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        await videoRef.current.play();\n      }\n\n      setShowCamera(true);\n      setShowOptions(false);\n    } catch (err) {\n      console.error('Error accessing camera:', err);\n      setError('ไม่สามารถเข้าถึงกล้องได้ กรุณาอนุญาตการใช้งานกล้อง');\n    }\n  }, [facingMode, cameraStream]);\n\n  // Stop camera\n  const stopCamera = useCallback(() => {\n    if (cameraStream) {\n      cameraStream.getTracks().forEach(track => track.stop());\n      setCameraStream(null);\n    }\n    setShowCamera(false);\n  }, [cameraStream]);\n\n  // Switch camera (front/back)\n  const switchCamera = useCallback(async () => {\n    const newFacingMode = facingMode === 'user' ? 'environment' : 'user';\n    setFacingMode(newFacingMode);\n    \n    if (showCamera) {\n      // Restart camera with new facing mode\n      if (cameraStream) {\n        cameraStream.getTracks().forEach(track => track.stop());\n      }\n      \n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: { facingMode: newFacingMode, width: { ideal: 640 }, height: { ideal: 480 } },\n          audio: false,\n        });\n        setCameraStream(stream);\n        \n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n      } catch (err) {\n        console.error('Error switching camera:', err);\n      }\n    }\n  }, [facingMode, showCamera, cameraStream]);\n\n  // Capture photo from camera\n  const capturePhoto = useCallback(() => {\n    if (!videoRef.current || !canvasRef.current) return;\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n\n    if (!context) return;\n\n    // Set canvas size to video size\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n\n    // Draw video frame to canvas\n    context.drawImage(video, 0, 0);\n\n    // Get image data as base64\n    const imageData = canvas.toDataURL('image/jpeg', 0.9);\n    \n    setImage(imageData);\n    onImageChange?.(imageData, canvas.width, canvas.height);\n    \n    stopCamera();\n  }, [onImageChange, stopCamera]);\n\n  // Handle file selection\n  const handleFileSelect = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Check file type\n    if (!file.type.startsWith('image/')) {\n      setError('กรุณาเลือกไฟล์รูปภาพ');\n      return;\n    }\n\n    // Check file size (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      setError('ขนาดไฟล์ต้องไม่เกิน 5MB');\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      const imageData = event.target?.result as string;\n      \n      // Get image dimensions\n      const img = new Image();\n      img.onload = () => {\n        setImage(imageData);\n        onImageChange?.(imageData, img.width, img.height);\n        setShowOptions(false);\n        setError(null);\n      };\n      img.src = imageData;\n    };\n    reader.readAsDataURL(file);\n\n    // Reset input\n    e.target.value = '';\n  }, [onImageChange]);\n\n  // Handle upload\n  const handleUpload = useCallback(async () => {\n    if (!image || !onUpload) return;\n\n    setUploading(true);\n    setError(null);\n\n    try {\n      // Get image dimensions\n      const img = new Image();\n      await new Promise((resolve, reject) => {\n        img.onload = resolve;\n        img.onerror = reject;\n        img.src = image;\n      });\n\n      await onUpload(image, img.width, img.height);\n    } catch (err) {\n      console.error('Error uploading image:', err);\n      setError('ไม่สามารถอัปโหลดรูปได้');\n    } finally {\n      setUploading(false);\n    }\n  }, [image, onUpload]);\n\n  // Handle delete\n  const handleDelete = useCallback(() => {\n    setImage(null);\n    onImageChange?.(null);\n    setShowOptions(false);\n  }, [onImageChange]);\n\n  // Camera view\n  if (showCamera) {\n    return (\n      <div className=\"fixed inset-0 z-50 bg-black flex flex-col\">\n        {/* Camera Preview */}\n        <div className=\"flex-1 relative\">\n          <video\n            ref={videoRef}\n            autoPlay\n            playsInline\n            muted\n            className=\"w-full h-full object-cover\"\n          />\n          \n          {/* Overlay */}\n          <div className=\"absolute inset-0 pointer-events-none\">\n            {/* Guide circle */}\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n              <div className=\"size-64 border-4 border-white/50 rounded-full\" />\n            </div>\n          </div>\n        </div>\n\n        {/* Controls */}\n        <div className=\"bg-black/80 p-6 flex items-center justify-center gap-8\">\n          {/* Cancel */}\n          <button\n            onClick={stopCamera}\n            className=\"size-14 bg-white/20 rounded-full flex items-center justify-center text-white\"\n          >\n            <X size={24} />\n          </button>\n\n          {/* Capture */}\n          <button\n            onClick={capturePhoto}\n            className=\"size-20 bg-white rounded-full flex items-center justify-center border-4 border-white/50\"\n          >\n            <div className=\"size-16 bg-white rounded-full\" />\n          </button>\n\n          {/* Switch Camera */}\n          <button\n            onClick={switchCamera}\n            className=\"size-14 bg-white/20 rounded-full flex items-center justify-center text-white\"\n          >\n            <SwitchCamera size={24} />\n          </button>\n        </div>\n\n        {/* Hidden canvas for capture */}\n        <canvas ref={canvasRef} className=\"hidden\" />\n      </div>\n    );\n  }\n\n  // Preview modal\n  if (showPreview && image) {\n    return (\n      <div className=\"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4\">\n        <button\n          onClick={() => setShowPreview(false)}\n          className=\"absolute top-4 right-4 p-2 bg-white/20 rounded-full text-white\"\n        >\n          <X size={24} />\n        </button>\n        <img\n          src={image}\n          alt=\"Preview\"\n          className=\"max-w-full max-h-full object-contain rounded-lg\"\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className={`relative ${className}`}>\n      {/* Main Image Display */}\n      <div\n        className={`${sizeClasses[size]} rounded-full overflow-hidden bg-slate-100 dark:bg-slate-800 flex items-center justify-center cursor-pointer group relative`}\n        onClick={() => editable && setShowOptions(!showOptions)}\n      >\n        {image ? (\n          <>\n            <img\n              src={image}\n              alt=\"Patient\"\n              className=\"w-full h-full object-cover rounded-full\"\n            />\n            {/* Hover overlay */}\n            <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\n              {editable ? (\n                <Camera size={iconSizes[size] * 0.6} className=\"text-white\" />\n              ) : (\n                <ZoomIn size={iconSizes[size] * 0.6} className=\"text-white\" />\n              )}\n            </div>\n          </>\n        ) : (\n          <User size={iconSizes[size]} className=\"text-slate-400\" />\n        )}\n      </div>\n\n      {/* Options Menu */}\n      {showOptions && editable && (\n        <>\n          <div \n            className=\"fixed inset-0 z-40\" \n            onClick={() => setShowOptions(false)} \n          />\n          <div className=\"absolute left-full top-0 ml-2 bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 py-2 z-50 min-w-[180px]\">\n            <button\n              onClick={startCamera}\n              className=\"flex items-center gap-3 w-full px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800\"\n            >\n              <Camera size={18} className=\"text-blue-500\" />\n              ถ่ายรูป\n            </button>\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              className=\"flex items-center gap-3 w-full px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800\"\n            >\n              <ImageIcon size={18} className=\"text-emerald-500\" />\n              เลือกรูปภาพ\n            </button>\n            {image && (\n              <>\n                <div className=\"border-t border-slate-100 dark:border-slate-800 my-1\" />\n                <button\n                  onClick={() => { setShowPreview(true); setShowOptions(false); }}\n                  className=\"flex items-center gap-3 w-full px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800\"\n                >\n                  <ZoomIn size={18} className=\"text-purple-500\" />\n                  ดูรูปขนาดเต็ม\n                </button>\n                <button\n                  onClick={handleDelete}\n                  className=\"flex items-center gap-3 w-full px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-500/10\"\n                >\n                  <Trash2 size={18} />\n                  ลบรูป\n                </button>\n              </>\n            )}\n          </div>\n        </>\n      )}\n\n      {/* Error message */}\n      {error && (\n        <div className=\"absolute left-0 right-0 -bottom-8 text-xs text-red-500 text-center\">\n          {error}\n        </div>\n      )}\n\n      {/* Hidden file input */}\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        capture=\"environment\"\n        onChange={handleFileSelect}\n        className=\"hidden\"\n      />\n\n      {/* Hidden canvas */}\n      <canvas ref={canvasRef} className=\"hidden\" />\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,+DAA+D;AAC/D,wEAAwE;AACxE,gFAAgF;;;;;;AAIhF;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAHA;;;AA0Be,SAAS,mBAAmB,EACzC,EAAE,EACF,YAAY,EACZ,aAAa,EACb,QAAQ,EACR,OAAO,IAAI,EACX,WAAW,IAAI,EACf,YAAY,EAAE,EACU;;IACxB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,uLAAQ,EAAgB,gBAAgB;IAClE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uLAAQ,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,uLAAQ,EAAC;IAC/C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,uLAAQ,EAAC;IAC/C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,uLAAQ,EAAqB;IACrE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uLAAQ,EAAyB;IACrE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,uLAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,uLAAQ,EAAgB;IAElD,MAAM,WAAW,IAAA,qLAAM,EAAmB;IAC1C,MAAM,YAAY,IAAA,qLAAM,EAAoB;IAC5C,MAAM,eAAe,IAAA,qLAAM,EAAmB;IAE9C,MAAM,cAAc;QAClB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,MAAM,YAAY;QAChB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,8CAA8C;IAC9C,IAAA,wLAAS;wCAAC;YACR,IAAI,iBAAiB,WAAW;gBAC9B,SAAS;YACX;QACF;uCAAG;QAAC;KAAa;IAEjB,mCAAmC;IACnC,IAAA,wLAAS;wCAAC;YACR;gDAAO;oBACL,IAAI,cAAc;wBAChB,aAAa,SAAS,GAAG,OAAO;4DAAC,CAAA,QAAS,MAAM,IAAI;;oBACtD;gBACF;;QACF;uCAAG;QAAC;KAAa;IAEjB,eAAe;IACf,MAAM,cAAc,IAAA,0LAAW;uDAAC;YAC9B,IAAI;gBACF,SAAS;gBAET,uBAAuB;gBACvB,IAAI,cAAc;oBAChB,aAAa,SAAS,GAAG,OAAO;uEAAC,CAAA,QAAS,MAAM,IAAI;;gBACtD;gBAEA,MAAM,cAAsC;oBAC1C,OAAO;wBACL,YAAY;wBACZ,OAAO;4BAAE,OAAO;wBAAI;wBACpB,QAAQ;4BAAE,OAAO;wBAAI;oBACvB;oBACA,OAAO;gBACT;gBAEA,MAAM,SAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC;gBACzD,gBAAgB;gBAEhB,IAAI,SAAS,OAAO,EAAE;oBACpB,SAAS,OAAO,CAAC,SAAS,GAAG;oBAC7B,MAAM,SAAS,OAAO,CAAC,IAAI;gBAC7B;gBAEA,cAAc;gBACd,eAAe;YACjB,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,SAAS;YACX;QACF;sDAAG;QAAC;QAAY;KAAa;IAE7B,cAAc;IACd,MAAM,aAAa,IAAA,0LAAW;sDAAC;YAC7B,IAAI,cAAc;gBAChB,aAAa,SAAS,GAAG,OAAO;kEAAC,CAAA,QAAS,MAAM,IAAI;;gBACpD,gBAAgB;YAClB;YACA,cAAc;QAChB;qDAAG;QAAC;KAAa;IAEjB,6BAA6B;IAC7B,MAAM,eAAe,IAAA,0LAAW;wDAAC;YAC/B,MAAM,gBAAgB,eAAe,SAAS,gBAAgB;YAC9D,cAAc;YAEd,IAAI,YAAY;gBACd,sCAAsC;gBACtC,IAAI,cAAc;oBAChB,aAAa,SAAS,GAAG,OAAO;wEAAC,CAAA,QAAS,MAAM,IAAI;;gBACtD;gBAEA,IAAI;oBACF,MAAM,SAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC;wBACvD,OAAO;4BAAE,YAAY;4BAAe,OAAO;gCAAE,OAAO;4BAAI;4BAAG,QAAQ;gCAAE,OAAO;4BAAI;wBAAE;wBAClF,OAAO;oBACT;oBACA,gBAAgB;oBAEhB,IAAI,SAAS,OAAO,EAAE;wBACpB,SAAS,OAAO,CAAC,SAAS,GAAG;wBAC7B,MAAM,SAAS,OAAO,CAAC,IAAI;oBAC7B;gBACF,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,2BAA2B;gBAC3C;YACF;QACF;uDAAG;QAAC;QAAY;QAAY;KAAa;IAEzC,4BAA4B;IAC5B,MAAM,eAAe,IAAA,0LAAW;wDAAC;YAC/B,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC,UAAU,OAAO,EAAE;YAE7C,MAAM,QAAQ,SAAS,OAAO;YAC9B,MAAM,SAAS,UAAU,OAAO;YAChC,MAAM,UAAU,OAAO,UAAU,CAAC;YAElC,IAAI,CAAC,SAAS;YAEd,gCAAgC;YAChC,OAAO,KAAK,GAAG,MAAM,UAAU;YAC/B,OAAO,MAAM,GAAG,MAAM,WAAW;YAEjC,6BAA6B;YAC7B,QAAQ,SAAS,CAAC,OAAO,GAAG;YAE5B,2BAA2B;YAC3B,MAAM,YAAY,OAAO,SAAS,CAAC,cAAc;YAEjD,SAAS;YACT,gBAAgB,WAAW,OAAO,KAAK,EAAE,OAAO,MAAM;YAEtD;QACF;uDAAG;QAAC;QAAe;KAAW;IAE9B,wBAAwB;IACxB,MAAM,mBAAmB,IAAA,0LAAW;4DAAC,CAAC;YACpC,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;YAChC,IAAI,CAAC,MAAM;YAEX,kBAAkB;YAClB,IAAI,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW;gBACnC,SAAS;gBACT;YACF;YAEA,4BAA4B;YAC5B,IAAI,KAAK,IAAI,GAAG,IAAI,OAAO,MAAM;gBAC/B,SAAS;gBACT;YACF;YAEA,MAAM,SAAS,IAAI;YACnB,OAAO,MAAM;oEAAG,CAAC;oBACf,MAAM,YAAY,MAAM,MAAM,EAAE;oBAEhC,uBAAuB;oBACvB,MAAM,MAAM,IAAI;oBAChB,IAAI,MAAM;4EAAG;4BACX,SAAS;4BACT,gBAAgB,WAAW,IAAI,KAAK,EAAE,IAAI,MAAM;4BAChD,eAAe;4BACf,SAAS;wBACX;;oBACA,IAAI,GAAG,GAAG;gBACZ;;YACA,OAAO,aAAa,CAAC;YAErB,cAAc;YACd,EAAE,MAAM,CAAC,KAAK,GAAG;QACnB;2DAAG;QAAC;KAAc;IAElB,gBAAgB;IAChB,MAAM,eAAe,IAAA,0LAAW;wDAAC;YAC/B,IAAI,CAAC,SAAS,CAAC,UAAU;YAEzB,aAAa;YACb,SAAS;YAET,IAAI;gBACF,uBAAuB;gBACvB,MAAM,MAAM,IAAI;gBAChB,MAAM,IAAI;oEAAQ,CAAC,SAAS;wBAC1B,IAAI,MAAM,GAAG;wBACb,IAAI,OAAO,GAAG;wBACd,IAAI,GAAG,GAAG;oBACZ;;gBAEA,MAAM,SAAS,OAAO,IAAI,KAAK,EAAE,IAAI,MAAM;YAC7C,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,0BAA0B;gBACxC,SAAS;YACX,SAAU;gBACR,aAAa;YACf;QACF;uDAAG;QAAC;QAAO;KAAS;IAEpB,gBAAgB;IAChB,MAAM,eAAe,IAAA,0LAAW;wDAAC;YAC/B,SAAS;YACT,gBAAgB;YAChB,eAAe;QACjB;uDAAG;QAAC;KAAc;IAElB,cAAc;IACd,IAAI,YAAY;QACd,qBACE,2MAAC;YAAI,WAAU;;8BAEb,2MAAC;oBAAI,WAAU;;sCACb,2MAAC;4BACC,KAAK;4BACL,QAAQ;4BACR,WAAW;4BACX,KAAK;4BACL,WAAU;;;;;;sCAIZ,2MAAC;4BAAI,WAAU;sCAEb,cAAA,2MAAC;gCAAI,WAAU;0CACb,cAAA,2MAAC;oCAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;8BAMrB,2MAAC;oBAAI,WAAU;;sCAEb,2MAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,2MAAC,kNAAC;gCAAC,MAAM;;;;;;;;;;;sCAIX,2MAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,2MAAC;gCAAI,WAAU;;;;;;;;;;;sCAIjB,2MAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,2MAAC,uPAAY;gCAAC,MAAM;;;;;;;;;;;;;;;;;8BAKxB,2MAAC;oBAAO,KAAK;oBAAW,WAAU;;;;;;;;;;;;IAGxC;IAEA,gBAAgB;IAChB,IAAI,eAAe,OAAO;QACxB,qBACE,2MAAC;YAAI,WAAU;;8BACb,2MAAC;oBACC,SAAS,IAAM,eAAe;oBAC9B,WAAU;8BAEV,cAAA,2MAAC,kNAAC;wBAAC,MAAM;;;;;;;;;;;8BAEX,2MAAC;oBACC,KAAK;oBACL,KAAI;oBACJ,WAAU;;;;;;;;;;;;IAIlB;IAEA,qBACE,2MAAC;QAAI,WAAW,CAAC,SAAS,EAAE,WAAW;;0BAErC,2MAAC;gBACC,WAAW,GAAG,WAAW,CAAC,KAAK,CAAC,2HAA2H,CAAC;gBAC5J,SAAS,IAAM,YAAY,eAAe,CAAC;0BAE1C,sBACC;;sCACE,2MAAC;4BACC,KAAK;4BACL,KAAI;4BACJ,WAAU;;;;;;sCAGZ,2MAAC;4BAAI,WAAU;sCACZ,yBACC,2MAAC,iOAAM;gCAAC,MAAM,SAAS,CAAC,KAAK,GAAG;gCAAK,WAAU;;;;;qDAE/C,2MAAC,qOAAM;gCAAC,MAAM,SAAS,CAAC,KAAK,GAAG;gCAAK,WAAU;;;;;;;;;;;;iDAKrD,2MAAC,2NAAI;oBAAC,MAAM,SAAS,CAAC,KAAK;oBAAE,WAAU;;;;;;;;;;;YAK1C,eAAe,0BACd;;kCACE,2MAAC;wBACC,WAAU;wBACV,SAAS,IAAM,eAAe;;;;;;kCAEhC,2MAAC;wBAAI,WAAU;;0CACb,2MAAC;gCACC,SAAS;gCACT,WAAU;;kDAEV,2MAAC,iOAAM;wCAAC,MAAM;wCAAI,WAAU;;;;;;oCAAkB;;;;;;;0CAGhD,2MAAC;gCACC,SAAS,IAAM,aAAa,OAAO,EAAE;gCACrC,WAAU;;kDAEV,2MAAC,8NAAS;wCAAC,MAAM;wCAAI,WAAU;;;;;;oCAAqB;;;;;;;4BAGrD,uBACC;;kDACE,2MAAC;wCAAI,WAAU;;;;;;kDACf,2MAAC;wCACC,SAAS;4CAAQ,eAAe;4CAAO,eAAe;wCAAQ;wCAC9D,WAAU;;0DAEV,2MAAC,qOAAM;gDAAC,MAAM;gDAAI,WAAU;;;;;;4CAAoB;;;;;;;kDAGlD,2MAAC;wCACC,SAAS;wCACT,WAAU;;0DAEV,2MAAC,qOAAM;gDAAC,MAAM;;;;;;4CAAM;;;;;;;;;;;;;;;;;YAU/B,uBACC,2MAAC;gBAAI,WAAU;0BACZ;;;;;;0BAKL,2MAAC;gBACC,KAAK;gBACL,MAAK;gBACL,QAAO;gBACP,SAAQ;gBACR,UAAU;gBACV,WAAU;;;;;;0BAIZ,2MAAC;gBAAO,KAAK;gBAAW,WAAU;;;;;;;;;;;;AAGxC;GAlYwB;KAAA"}},
    {"offset": {"line": 1779, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/patient-image/index.ts"],"sourcesContent":["// =============================================================================\n// File: src/components/ui/patient-image/index.ts\n// Description: Patient Image Component exports\n// =============================================================================\n\nexport { default as PatientImageUpload } from './PatientImageUpload';\n"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,iDAAiD;AACjD,+CAA+C;AAC/C,gFAAgF;;AAEhF"}},
    {"offset": {"line": 1802, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/Icons.tsx"],"sourcesContent":["'use client';\n\nimport {\n  LayoutDashboard,\n  Activity,\n  Users,\n  UserPlus,\n  Calendar,\n  BedDouble,\n  Stethoscope,\n  Pill,\n  FlaskConical,\n  CreditCard,\n  BarChart3,\n  Settings,\n  Search,\n  Bell,\n  Menu,\n  X,\n  ChevronDown,\n  ChevronRight,\n  ChevronLeft,\n  Sun,\n  Moon,\n  Heart,\n  TrendingUp,\n  TrendingDown,\n  List,\n  Plus,\n  FileText,\n  Package,\n  PanelLeft,\n  AlignJustify,\n  LogOut,\n  User,\n  Lock,\n  Eye,\n  EyeOff,\n  AlertCircle,\n  Loader2,\n  Home,\n  FolderOpen,\n  ClipboardList,\n  Syringe,\n  Microscope,\n  Receipt,\n  FileBarChart,\n  Cog,\n  Shield,\n  UserCog,\n  Building,\n  type LucideIcon,\n} from 'lucide-react';\n\n// Icon mapping for dynamic usage\nexport const Icons: Record<string, LucideIcon> = {\n  dashboard: LayoutDashboard,\n  home: Home,\n  emergency: Activity,\n  users: Users,\n  userPlus: UserPlus,\n  user: User,\n  userCog: UserCog,\n  calendar: Calendar,\n  bed: BedDouble,\n  stethoscope: Stethoscope,\n  pill: Pill,\n  flask: FlaskConical,\n  microscope: Microscope,\n  syringe: Syringe,\n  creditCard: CreditCard,\n  receipt: Receipt,\n  chart: BarChart3,\n  fileBarChart: FileBarChart,\n  settings: Settings,\n  cog: Cog,\n  search: Search,\n  bell: Bell,\n  menu: Menu,\n  close: X,\n  chevronDown: ChevronDown,\n  chevronRight: ChevronRight,\n  chevronLeft: ChevronLeft,\n  sun: Sun,\n  moon: Moon,\n  heart: Heart,\n  trendingUp: TrendingUp,\n  trendingDown: TrendingDown,\n  list: List,\n  clipboardList: ClipboardList,\n  plus: Plus,\n  file: FileText,\n  folder: FolderOpen,\n  box: Package,\n  sidebar: PanelLeft,\n  horizontal: AlignJustify,\n  logout: LogOut,\n  lock: Lock,\n  eye: Eye,\n  eyeOff: EyeOff,\n  alertCircle: AlertCircle,\n  loader: Loader2,\n  shield: Shield,\n  building: Building,\n};\n\n// Get icon by name (case-insensitive)\nexport const getIcon = (name: string): LucideIcon => {\n  // Try exact match first\n  if (Icons[name]) return Icons[name];\n\n  // Try lowercase\n  const lowerName = name.toLowerCase();\n  const found = Object.keys(Icons).find((key) => key.toLowerCase() === lowerName);\n\n  return found ? Icons[found] : FileText;\n};\n\n// Re-export commonly used icons\nexport {\n  LayoutDashboard,\n  Activity,\n  Users,\n  UserPlus,\n  Calendar,\n  BedDouble,\n  Stethoscope,\n  Pill,\n  FlaskConical,\n  CreditCard,\n  BarChart3,\n  Settings,\n  Search,\n  Bell,\n  Menu,\n  X,\n  ChevronDown,\n  ChevronRight,\n  ChevronLeft,\n  Sun,\n  Moon,\n  Heart,\n  TrendingUp,\n  TrendingDown,\n  List,\n  Plus,\n  FileText,\n  Package,\n  PanelLeft,\n  AlignJustify,\n  LogOut,\n  User,\n  Lock,\n  Eye,\n  EyeOff,\n  AlertCircle,\n  Loader2,\n};\n\nexport type IconName = keyof typeof Icons;"],"names":[],"mappings":";;;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;;AAuDO,MAAM,QAAoC;IAC/C,WAAW,gQAAe;IAC1B,MAAM,4NAAI;IACV,WAAW,uOAAQ;IACnB,OAAO,8NAAK;IACZ,UAAU,2OAAQ;IAClB,MAAM,2NAAI;IACV,SAAS,wOAAO;IAChB,UAAU,uOAAQ;IAClB,KAAK,8OAAS;IACd,aAAa,gPAAW;IACxB,MAAM,2NAAI;IACV,OAAO,uPAAY;IACnB,YAAY,6OAAU;IACtB,SAAS,oOAAO;IAChB,YAAY,iPAAU;IACtB,SAAS,oOAAO;IAChB,OAAO,gPAAS;IAChB,cAAc,4QAAY;IAC1B,UAAU,uOAAQ;IAClB,KAAK,wNAAG;IACR,QAAQ,iOAAM;IACd,MAAM,2NAAI;IACV,MAAM,2NAAI;IACV,OAAO,kNAAC;IACR,aAAa,oPAAW;IACxB,cAAc,uPAAY;IAC1B,aAAa,oPAAW;IACxB,KAAK,wNAAG;IACR,MAAM,2NAAI;IACV,OAAO,8NAAK;IACZ,YAAY,iPAAU;IACtB,cAAc,uPAAY;IAC1B,MAAM,2NAAI;IACV,eAAe,0PAAa;IAC5B,MAAM,2NAAI;IACV,MAAM,2OAAQ;IACd,QAAQ,iPAAU;IAClB,KAAK,oOAAO;IACZ,SAAS,8OAAS;IAClB,YAAY,+PAAY;IACxB,QAAQ,qOAAM;IACd,MAAM,2NAAI;IACV,KAAK,wNAAG;IACR,QAAQ,qOAAM;IACd,aAAa,oPAAW;IACxB,QAAQ,6OAAO;IACf,QAAQ,iOAAM;IACd,UAAU,uOAAQ;AACpB;AAGO,MAAM,UAAU,CAAC;IACtB,wBAAwB;IACxB,IAAI,KAAK,CAAC,KAAK,EAAE,OAAO,KAAK,CAAC,KAAK;IAEnC,gBAAgB;IAChB,MAAM,YAAY,KAAK,WAAW;IAClC,MAAM,QAAQ,OAAO,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC,MAAQ,IAAI,WAAW,OAAO;IAErE,OAAO,QAAQ,KAAK,CAAC,MAAM,GAAG,2OAAQ;AACxC"}},
    {"offset": {"line": 1924, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/ToggleSwitch.tsx"],"sourcesContent":["'use client';\n\nimport { FC } from 'react';\n\ninterface ToggleSwitchProps {\n  checked: boolean;\n  onChange: (checked: boolean) => void;\n  leftLabel?: string;\n  rightLabel?: string;\n  leftIcon?: React.ReactNode;\n  rightIcon?: React.ReactNode;\n  size?: 'sm' | 'md';\n}\n\nexport const ToggleSwitch: FC<ToggleSwitchProps> = ({\n  checked,\n  onChange,\n  leftLabel,\n  rightLabel,\n  leftIcon,\n  rightIcon,\n  size = 'md',\n}) => {\n  const sizes = {\n    sm: {\n      switch: 'h-5 w-9',\n      thumb: 'h-4 w-4',\n      translate: 'translate-x-4',\n    },\n    md: {\n      switch: 'h-6 w-11',\n      thumb: 'h-5 w-5',\n      translate: 'translate-x-5',\n    },\n  };\n\n  const s = sizes[size];\n\n  return (\n    <div className=\"flex items-center gap-2\">\n      {leftIcon && <span className=\"text-slate-500 dark:text-slate-400\">{leftIcon}</span>}\n      {leftLabel && (\n        <span className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">\n          {leftLabel}\n        </span>\n      )}\n      \n      <button\n        type=\"button\"\n        role=\"switch\"\n        aria-checked={checked}\n        onClick={() => onChange(!checked)}\n        className={`\n          relative inline-flex shrink-0 cursor-pointer rounded-full\n          border-2 border-transparent transition-colors duration-200 ease-in-out\n          focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2\n          ${s.switch}\n          ${checked ? 'bg-primary-500' : 'bg-slate-300 dark:bg-slate-600'}\n        `}\n      >\n        <span\n          className={`\n            pointer-events-none inline-block transform rounded-full\n            bg-white shadow-lg ring-0 transition duration-200 ease-in-out\n            ${s.thumb}\n            ${checked ? s.translate : 'translate-x-0'}\n          `}\n        />\n      </button>\n\n      {rightLabel && (\n        <span className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">\n          {rightLabel}\n        </span>\n      )}\n      {rightIcon && <span className=\"text-slate-500 dark:text-slate-400\">{rightIcon}</span>}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;;AAcO,MAAM,eAAsC,CAAC,EAClD,OAAO,EACP,QAAQ,EACR,SAAS,EACT,UAAU,EACV,QAAQ,EACR,SAAS,EACT,OAAO,IAAI,EACZ;IACC,MAAM,QAAQ;QACZ,IAAI;YACF,QAAQ;YACR,OAAO;YACP,WAAW;QACb;QACA,IAAI;YACF,QAAQ;YACR,OAAO;YACP,WAAW;QACb;IACF;IAEA,MAAM,IAAI,KAAK,CAAC,KAAK;IAErB,qBACE,2MAAC;QAAI,WAAU;;YACZ,0BAAY,2MAAC;gBAAK,WAAU;0BAAsC;;;;;;YAClE,2BACC,2MAAC;gBAAK,WAAU;0BACb;;;;;;0BAIL,2MAAC;gBACC,MAAK;gBACL,MAAK;gBACL,gBAAc;gBACd,SAAS,IAAM,SAAS,CAAC;gBACzB,WAAW,CAAC;;;;UAIV,EAAE,EAAE,MAAM,CAAC;UACX,EAAE,UAAU,mBAAmB,iCAAiC;QAClE,CAAC;0BAED,cAAA,2MAAC;oBACC,WAAW,CAAC;;;YAGV,EAAE,EAAE,KAAK,CAAC;YACV,EAAE,UAAU,EAAE,SAAS,GAAG,gBAAgB;UAC5C,CAAC;;;;;;;;;;;YAIJ,4BACC,2MAAC;gBAAK,WAAU;0BACb;;;;;;YAGJ,2BAAa,2MAAC;gBAAK,WAAU;0BAAsC;;;;;;;;;;;;AAG1E;KAhEa"}},
    {"offset": {"line": 2026, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/Dropdown.tsx"],"sourcesContent":["'use client';\n\nimport { FC, useState, useRef, useEffect, ReactNode } from 'react';\nimport { ChevronDown } from 'lucide-react';\n\ninterface DropdownItem {\n  id: string;\n  label: string;\n  href?: string;\n  onClick?: () => void;\n}\n\ninterface DropdownProps {\n  trigger: ReactNode;\n  items: DropdownItem[];\n  align?: 'left' | 'right';\n}\n\nexport const Dropdown: FC<DropdownProps> = ({ trigger, items, align = 'left' }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen]);\n\n  // Close on escape key\n  useEffect(() => {\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isOpen]);\n\n  return (\n    <div ref={dropdownRef} className=\"relative\">\n      {/* Trigger */}\n      <div onClick={() => setIsOpen(!isOpen)} className=\"cursor-pointer\">\n        {trigger}\n      </div>\n\n      {/* Menu */}\n      <div\n        className={`\n          dropdown-menu\n          ${align === 'right' ? 'right-0 left-auto' : 'left-0'}\n          ${isOpen ? 'open' : ''}\n        `}\n      >\n        {items.map((item) => (\n          <a\n            key={item.id}\n            href={item.href || '#'}\n            className=\"dropdown-item\"\n            onClick={(e) => {\n              if (item.onClick) {\n                e.preventDefault();\n                item.onClick();\n              }\n              setIsOpen(false);\n            }}\n          >\n            {item.label}\n          </a>\n        ))}\n      </div>\n    </div>\n  );\n};\n\n// Navigation Dropdown specifically for horizontal menu\ninterface NavDropdownProps {\n  label: string;\n  icon?: ReactNode;\n  items: DropdownItem[];\n  badge?: string | number;\n  badgeColor?: 'primary' | 'success' | 'warning' | 'critical';\n}\n\nexport const NavDropdown: FC<NavDropdownProps> = ({\n  label,\n  icon,\n  items,\n  badge,\n  badgeColor = 'primary',\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const badgeColors = {\n    primary: 'bg-primary-500 text-white',\n    success: 'bg-success-500 text-white',\n    warning: 'bg-warning-500 text-slate-900',\n    critical: 'bg-critical-500 text-white',\n  };\n\n  return (\n    <div ref={dropdownRef} className=\"relative\">\n      {/* Trigger Button */}\n      <button\n        type=\"button\"\n        onClick={() => setIsOpen(!isOpen)}\n        className={`\n          nav-item-horizontal\n          ${isOpen ? 'bg-slate-100 dark:bg-slate-800' : ''}\n        `}\n      >\n        {icon && <span className=\"w-4 h-4\">{icon}</span>}\n        <span>{label}</span>\n        {badge && (\n          <span className={`px-1.5 py-0.5 text-[10px] font-semibold rounded-full ${badgeColors[badgeColor]}`}>\n            {badge}\n          </span>\n        )}\n        <ChevronDown\n          size={12}\n          className={`transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}`}\n        />\n      </button>\n\n      {/* Dropdown Menu */}\n      <div\n        className={`\n          dropdown-menu min-w-44\n          ${isOpen ? 'open' : ''}\n        `}\n      >\n        {items.map((item) => (\n          <a\n            key={item.id}\n            href={item.href || '#'}\n            className=\"dropdown-item\"\n            onClick={(e) => {\n              if (item.onClick) {\n                e.preventDefault();\n                item.onClick();\n              }\n              setIsOpen(false);\n            }}\n          >\n            {item.label}\n          </a>\n        ))}\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;AAHA;;;AAkBO,MAAM,WAA8B,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,MAAM,EAAE;;IAC5E,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,uLAAQ,EAAC;IACrC,MAAM,cAAc,IAAA,qLAAM,EAAiB;IAE3C,uCAAuC;IACvC,IAAA,wLAAS;8BAAC;YACR,MAAM;yDAAqB,CAAC;oBAC1B,IAAI,YAAY,OAAO,IAAI,CAAC,YAAY,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;wBAC9E,UAAU;oBACZ;gBACF;;YAEA,IAAI,QAAQ;gBACV,SAAS,gBAAgB,CAAC,aAAa;YACzC;YAEA;sCAAO;oBACL,SAAS,mBAAmB,CAAC,aAAa;gBAC5C;;QACF;6BAAG;QAAC;KAAO;IAEX,sBAAsB;IACtB,IAAA,wLAAS;8BAAC;YACR,MAAM;mDAAe,CAAC;oBACpB,IAAI,MAAM,GAAG,KAAK,UAAU;wBAC1B,UAAU;oBACZ;gBACF;;YAEA,IAAI,QAAQ;gBACV,SAAS,gBAAgB,CAAC,WAAW;YACvC;YAEA;sCAAO;oBACL,SAAS,mBAAmB,CAAC,WAAW;gBAC1C;;QACF;6BAAG;QAAC;KAAO;IAEX,qBACE,2MAAC;QAAI,KAAK;QAAa,WAAU;;0BAE/B,2MAAC;gBAAI,SAAS,IAAM,UAAU,CAAC;gBAAS,WAAU;0BAC/C;;;;;;0BAIH,2MAAC;gBACC,WAAW,CAAC;;UAEV,EAAE,UAAU,UAAU,sBAAsB,SAAS;UACrD,EAAE,SAAS,SAAS,GAAG;QACzB,CAAC;0BAEA,MAAM,GAAG,CAAC,CAAC,qBACV,2MAAC;wBAEC,MAAM,KAAK,IAAI,IAAI;wBACnB,WAAU;wBACV,SAAS,CAAC;4BACR,IAAI,KAAK,OAAO,EAAE;gCAChB,EAAE,cAAc;gCAChB,KAAK,OAAO;4BACd;4BACA,UAAU;wBACZ;kCAEC,KAAK,KAAK;uBAXN,KAAK,EAAE;;;;;;;;;;;;;;;;AAiBxB;GAxEa;KAAA;AAmFN,MAAM,cAAoC,CAAC,EAChD,KAAK,EACL,IAAI,EACJ,KAAK,EACL,KAAK,EACL,aAAa,SAAS,EACvB;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,uLAAQ,EAAC;IACrC,MAAM,cAAc,IAAA,qLAAM,EAAiB;IAE3C,uCAAuC;IACvC,IAAA,wLAAS;iCAAC;YACR,MAAM;4DAAqB,CAAC;oBAC1B,IAAI,YAAY,OAAO,IAAI,CAAC,YAAY,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;wBAC9E,UAAU;oBACZ;gBACF;;YAEA,SAAS,gBAAgB,CAAC,aAAa;YACvC;yCAAO,IAAM,SAAS,mBAAmB,CAAC,aAAa;;QACzD;gCAAG,EAAE;IAEL,MAAM,cAAc;QAClB,SAAS;QACT,SAAS;QACT,SAAS;QACT,UAAU;IACZ;IAEA,qBACE,2MAAC;QAAI,KAAK;QAAa,WAAU;;0BAE/B,2MAAC;gBACC,MAAK;gBACL,SAAS,IAAM,UAAU,CAAC;gBAC1B,WAAW,CAAC;;UAEV,EAAE,SAAS,mCAAmC,GAAG;QACnD,CAAC;;oBAEA,sBAAQ,2MAAC;wBAAK,WAAU;kCAAW;;;;;;kCACpC,2MAAC;kCAAM;;;;;;oBACN,uBACC,2MAAC;wBAAK,WAAW,CAAC,qDAAqD,EAAE,WAAW,CAAC,WAAW,EAAE;kCAC/F;;;;;;kCAGL,2MAAC,oPAAW;wBACV,MAAM;wBACN,WAAW,CAAC,kCAAkC,EAAE,SAAS,eAAe,IAAI;;;;;;;;;;;;0BAKhF,2MAAC;gBACC,WAAW,CAAC;;UAEV,EAAE,SAAS,SAAS,GAAG;QACzB,CAAC;0BAEA,MAAM,GAAG,CAAC,CAAC,qBACV,2MAAC;wBAEC,MAAM,KAAK,IAAI,IAAI;wBACnB,WAAU;wBACV,SAAS,CAAC;4BACR,IAAI,KAAK,OAAO,EAAE;gCAChB,EAAE,cAAc;gCAChB,KAAK,OAAO;4BACd;4BACA,UAAU;wBACZ;kCAEC,KAAK,KAAK;uBAXN,KAAK,EAAE;;;;;;;;;;;;;;;;AAiBxB;IA/Ea;MAAA"}},
    {"offset": {"line": 2257, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/Badge.tsx"],"sourcesContent":["'use client';\n\nimport { FC, ReactNode } from 'react';\n\ninterface BadgeProps {\n  children: ReactNode;\n  variant?: 'primary' | 'success' | 'warning' | 'critical' | 'default';\n  size?: 'sm' | 'md';\n  pulse?: boolean;\n}\n\nexport const Badge: FC<BadgeProps> = ({\n  children,\n  variant = 'default',\n  size = 'sm',\n  pulse = false,\n}) => {\n  const variants = {\n    primary: 'bg-primary-500 text-white',\n    success: 'bg-success-500 text-white',\n    warning: 'bg-warning-500 text-slate-900',\n    critical: 'bg-critical-500 text-white',\n    default: 'bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300',\n  };\n\n  const sizes = {\n    sm: 'px-1.5 py-0.5 text-[10px]',\n    md: 'px-2 py-0.5 text-xs',\n  };\n\n  return (\n    <span\n      className={`\n        inline-flex items-center justify-center font-semibold rounded-full\n        ${variants[variant]}\n        ${sizes[size]}\n        ${pulse ? 'animate-pulse-subtle' : ''}\n      `}\n    >\n      {children}\n    </span>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;;AAWO,MAAM,QAAwB,CAAC,EACpC,QAAQ,EACR,UAAU,SAAS,EACnB,OAAO,IAAI,EACX,QAAQ,KAAK,EACd;IACC,MAAM,WAAW;QACf,SAAS;QACT,SAAS;QACT,SAAS;QACT,UAAU;QACV,SAAS;IACX;IAEA,MAAM,QAAQ;QACZ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,2MAAC;QACC,WAAW,CAAC;;QAEV,EAAE,QAAQ,CAAC,QAAQ,CAAC;QACpB,EAAE,KAAK,CAAC,KAAK,CAAC;QACd,EAAE,QAAQ,yBAAyB,GAAG;MACxC,CAAC;kBAEA;;;;;;AAGP;KA/Ba"}},
    {"offset": {"line": 2300, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/SearchablePatientSelect.tsx"],"sourcesContent":["// src/components/ui/SearchablePatientSelect.tsx\n// Searchable patient select component with dropdown\n// Supports external updates from Smart Card reader\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { User, ChevronDown, Loader2, X, Search, AlertCircle } from 'lucide-react';\nimport { patientApi } from '@/lib/api';\nimport { PatientListItem } from '@/types/patient.types';\n\nexport interface SearchablePatientSelectProps {\n  value: string;\n  onChange: (hn: string, patient: PatientListItem | null, cardPhoto?: string | null) => void;\n  placeholder?: string;\n  disabled?: boolean;\n  initialPatient?: PatientListItem | null;\n  className?: string;\n  limit?: number;\n}\n\nconst SearchablePatientSelect: React.FC<SearchablePatientSelectProps> = ({\n  value,\n  onChange,\n  placeholder = \"พิมพ์ HN หรือชื่อเพื่อค้นหาผู้ป่วย...\",\n  disabled = false,\n  initialPatient = null,\n  className = \"\",\n  limit = 20,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [patients, setPatients] = useState<PatientListItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedPatient, setSelectedPatient] = useState<PatientListItem | null>(initialPatient);\n  const [focusedIndex, setFocusedIndex] = useState(-1);\n  const [dropdownPosition, setDropdownPosition] = useState<'bottom' | 'top'>('bottom');\n  const [error, setError] = useState<string | null>(null);\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // ============================================\n  // Sync with external changes (Smart Card, etc.)\n  // ============================================\n  useEffect(() => {\n    // When initialPatient changes from external source (e.g., Smart Card)\n    if (initialPatient && initialPatient.hn) {\n      setSelectedPatient(initialPatient);\n      setSearchTerm(`${initialPatient.hn} - ${initialPatient.fullName}`);\n      setIsOpen(false);\n      setFocusedIndex(-1);\n    }\n  }, [initialPatient]);\n\n  // Sync when value changes externally (e.g., clear from parent)\n  useEffect(() => {\n    if (!value && selectedPatient) {\n      // Value cleared from parent\n      setSelectedPatient(null);\n      setSearchTerm('');\n    } else if (value && initialPatient && initialPatient.hn === value && selectedPatient?.hn !== value) {\n      // Value set from parent with matching initialPatient\n      setSelectedPatient(initialPatient);\n      setSearchTerm(`${initialPatient.hn} - ${initialPatient.fullName}`);\n    }\n  }, [value, initialPatient]);\n\n  // Calculate dropdown position\n  const calculateDropdownPosition = () => {\n    if (!containerRef.current) return;\n\n    const rect = containerRef.current.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const dropdownHeight = 320; // max-h-80 = 320px\n    const spaceBelow = viewportHeight - rect.bottom;\n    const spaceAbove = rect.top;\n\n    if (spaceBelow < dropdownHeight && spaceAbove > dropdownHeight) {\n      setDropdownPosition('top');\n    } else {\n      setDropdownPosition('bottom');\n    }\n  };\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n        setFocusedIndex(-1);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Calculate position when dropdown opens\n  useEffect(() => {\n    if (isOpen) {\n      calculateDropdownPosition();\n      \n      const handleReposition = () => {\n        if (isOpen) {\n          calculateDropdownPosition();\n        }\n      };\n\n      window.addEventListener('resize', handleReposition);\n      window.addEventListener('scroll', handleReposition, true);\n      \n      return () => {\n        window.removeEventListener('resize', handleReposition);\n        window.removeEventListener('scroll', handleReposition, true);\n      };\n    }\n  }, [isOpen]);\n\n  // Search patients when searchTerm changes\n  useEffect(() => {\n    const performSearch = async () => {\n      // Don't search if we have a selected patient and searchTerm matches\n      if (selectedPatient && searchTerm === `${selectedPatient.hn} - ${selectedPatient.fullName}`) {\n        return;\n      }\n\n      if (searchTerm.length < 2) {\n        setPatients([]);\n        setError(null);\n        return;\n      }\n\n      setLoading(true);\n      setError(null);\n      \n      try {\n        const result = await patientApi.search(searchTerm, limit);\n        setPatients(result);\n      } catch (err) {\n        console.error('Error searching patients:', err);\n        setError('เกิดข้อผิดพลาดในการค้นหา');\n        setPatients([]);\n      }\n      \n      setLoading(false);\n    };\n\n    const debounceTimer = setTimeout(performSearch, 300);\n    return () => clearTimeout(debounceTimer);\n  }, [searchTerm, limit, selectedPatient]);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const term = e.target.value;\n    setSearchTerm(term);\n    setIsOpen(true);\n    setFocusedIndex(-1);\n    \n    // Clear selection if user modifies the input\n    if (selectedPatient && term !== `${selectedPatient.hn} - ${selectedPatient.fullName}`) {\n      setSelectedPatient(null);\n      onChange('', null);\n    }\n  };\n\n  const handlePatientSelect = (patient: PatientListItem) => {\n    setSelectedPatient(patient);\n    setSearchTerm(`${patient.hn} - ${patient.fullName}`);\n    setIsOpen(false);\n    setFocusedIndex(-1);\n    onChange(patient.hn, patient);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (!isOpen || patients.length === 0) {\n      if (e.key === 'ArrowDown' || e.key === 'Enter') {\n        setIsOpen(true);\n      }\n      return;\n    }\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setFocusedIndex(prev => (prev < patients.length - 1 ? prev + 1 : 0));\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setFocusedIndex(prev => (prev > 0 ? prev - 1 : patients.length - 1));\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (focusedIndex >= 0 && patients[focusedIndex]) {\n          handlePatientSelect(patients[focusedIndex]);\n        }\n        break;\n      case 'Escape':\n        setIsOpen(false);\n        setFocusedIndex(-1);\n        inputRef.current?.blur();\n        break;\n    }\n  };\n\n  const clearSelection = () => {\n    setSelectedPatient(null);\n    setSearchTerm('');\n    setPatients([]);\n    setIsOpen(false);\n    onChange('', null);\n    inputRef.current?.focus();\n  };\n\n  const getSexLabel = (sex: string | null) => {\n    if (sex === 'M' || sex === '1') return 'ชาย';\n    if (sex === 'F' || sex === '2') return 'หญิง';\n    return '';\n  };\n\n  const getSexColor = (sex: string | null) => {\n    if (sex === 'M' || sex === '1') return 'text-blue-600 dark:text-blue-400';\n    if (sex === 'F' || sex === '2') return 'text-pink-600 dark:text-pink-400';\n    return 'text-slate-500';\n  };\n\n  return (\n    <div ref={containerRef} className={`relative ${className}`}>\n      <div className=\"relative\">\n        <Search size={18} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" />\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={searchTerm}\n          onChange={handleInputChange}\n          onKeyDown={handleKeyDown}\n          onFocus={() => {\n            // Only open dropdown if not already selected or if typing\n            if (!selectedPatient && searchTerm.length >= 2 && patients.length > 0) {\n              setIsOpen(true);\n            }\n          }}\n          placeholder={placeholder}\n          disabled={disabled}\n          className={`w-full pl-10 pr-12 py-3 border rounded-xl transition-colors duration-200\n            bg-white dark:bg-slate-800 \n            border-slate-200 dark:border-slate-700 \n            text-slate-900 dark:text-white \n            placeholder-slate-400 dark:placeholder-slate-500\n            focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500\n            ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n            ${selectedPatient ? 'bg-primary-50 dark:bg-primary-500/10 border-primary-200 dark:border-primary-500/30' : ''}`}\n        />\n\n        {/* Icons */}\n        <div className=\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1\">\n          {loading && (\n            <Loader2 className=\"w-4 h-4 animate-spin text-slate-400\" />\n          )}\n          {selectedPatient && !loading && (\n            <button\n              type=\"button\"\n              onClick={clearSelection}\n              disabled={disabled}\n              className=\"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-50\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          )}\n          {!selectedPatient && (\n            <ChevronDown className={`w-4 h-4 transition-transform duration-200 text-slate-400 ${\n              isOpen ? 'rotate-180' : ''\n            }`} />\n          )}\n        </div>\n      </div>\n\n      {/* Selected Patient Indicator */}\n      {selectedPatient && (\n        <div className=\"absolute -top-2 left-3 px-2 py-0.5 bg-primary-500 text-white text-xs rounded-full font-medium\">\n          เลือกแล้ว\n        </div>\n      )}\n\n      {/* Dropdown */}\n      {isOpen && !selectedPatient && (\n        <div \n          ref={dropdownRef}\n          className={`absolute z-50 w-full border rounded-xl shadow-xl max-h-80 overflow-auto ${\n            dropdownPosition === 'top' ? 'bottom-full mb-1' : 'top-full mt-1'\n          } bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700`}\n        >\n          {loading && (\n            <div className=\"px-4 py-6 text-center text-sm text-slate-500 dark:text-slate-400\">\n              <Loader2 className=\"w-5 h-5 animate-spin inline mr-2\" />\n              กำลังค้นหาผู้ป่วย...\n            </div>\n          )}\n\n          {error && !loading && (\n            <div className=\"px-4 py-4 text-center text-sm text-red-500 dark:text-red-400 flex items-center justify-center gap-2\">\n              <AlertCircle className=\"w-4 h-4\" />\n              {error}\n            </div>\n          )}\n\n          {!loading && !error && patients.length === 0 && searchTerm.length >= 2 && (\n            <div className=\"px-4 py-6 text-center text-sm text-slate-500 dark:text-slate-400\">\n              <User className=\"w-8 h-8 mx-auto mb-2 text-slate-300 dark:text-slate-600\" />\n              ไม่พบผู้ป่วย &quot;{searchTerm}&quot;\n            </div>\n          )}\n\n          {!loading && !error && patients.length === 0 && searchTerm.length < 2 && (\n            <div className=\"px-4 py-6 text-center text-sm text-slate-500 dark:text-slate-400\">\n              <Search className=\"w-8 h-8 mx-auto mb-2 text-slate-300 dark:text-slate-600\" />\n              พิมพ์อย่างน้อย 2 ตัวอักษรเพื่อค้นหา\n            </div>\n          )}\n\n          {!loading && !error && patients.map((patient, index) => (\n            <button\n              key={patient.hn}\n              type=\"button\"\n              onClick={() => handlePatientSelect(patient)}\n              className={`w-full px-4 py-3 text-left transition-colors duration-150 border-b border-slate-100 dark:border-slate-700 last:border-b-0 ${\n                index === focusedIndex\n                  ? 'bg-primary-50 dark:bg-primary-500/20 text-primary-900 dark:text-primary-100'\n                  : selectedPatient?.hn === patient.hn\n                    ? 'bg-primary-100 dark:bg-primary-600/20 text-primary-900 dark:text-primary-100'\n                    : 'text-slate-900 dark:text-slate-100 hover:bg-slate-50 dark:hover:bg-slate-700/50'\n              }`}\n            >\n              <div className=\"flex items-start gap-3\">\n                <div className=\"size-10 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center shrink-0\">\n                  <User className=\"w-5 h-5 text-slate-500 dark:text-slate-400\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"font-medium\">{patient.fullName}</span>\n                    {patient.hasAllergy && (\n                      <span className=\"px-1.5 py-0.5 bg-red-100 dark:bg-red-500/20 text-red-600 dark:text-red-400 text-xs rounded\">\n                        แพ้ยา\n                      </span>\n                    )}\n                    {patient.isDead && (\n                      <span className=\"px-1.5 py-0.5 bg-slate-200 dark:bg-slate-600 text-slate-600 dark:text-slate-300 text-xs rounded\">\n                        เสียชีวิต\n                      </span>\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-3 text-sm mt-0.5\">\n                    <span className=\"font-mono text-slate-500 dark:text-slate-400\">\n                      HN: {patient.hn}\n                    </span>\n                    {patient.sex && (\n                      <span className={getSexColor(patient.sex)}>\n                        {getSexLabel(patient.sex)}\n                      </span>\n                    )}\n                    {patient.age && (\n                      <span className=\"text-slate-500 dark:text-slate-400\">\n                        {patient.age} ปี\n                      </span>\n                    )}\n                  </div>\n                  {patient.cid && (\n                    <div className=\"text-xs text-slate-400 dark:text-slate-500 mt-0.5\">\n                      CID: {patient.cid.replace(/(\\d{1})(\\d{4})(\\d{5})(\\d{2})(\\d{1})/, '$1-$2-$3-$4-$5')}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport { SearchablePatientSelect };\nexport default SearchablePatientSelect;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2847, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/index.ts"],"sourcesContent":["export * from './Icons';\nexport * from './ToggleSwitch';\nexport * from './Dropdown';\nexport * from './Badge';\nexport { default as SearchablePatientSelect } from './SearchablePatientSelect';\nexport type { SearchablePatientSelectProps } from './SearchablePatientSelect';\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2987, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n\nimport { CheckCircle, XCircle, AlertCircle, Clock } from 'lucide-react';\nimport React from 'react';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function formatNumber(num: number): string {\n  return new Intl.NumberFormat().format(num);\n}\n\nexport function formatCurrency(amount: number): string {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD'\n  }).format(amount);\n}\n\nexport function formatThaiID(value: string): string {\n  const cleanValue = value.endsWith('-') ? value.slice(0, -1) : value;\n  const numbers = cleanValue.replace(/\\D/g, '').slice(0, 13);\n  \n  let formatted = '';\n  for (let i = 0; i < numbers.length; i++) {\n    if (i === 1 || i === 5 || i === 10 || i === 12) formatted += '-';\n    formatted += numbers[i];\n  }\n  return formatted;\n}\n\nexport const formatThaiDate = (dateStr: string, showTime: boolean = false): string => {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  if (isNaN(date.getTime())) return '';\n\n  const options: Intl.DateTimeFormatOptions = {\n    timeZone: 'Asia/Bangkok',\n    year: 'numeric',\n    month: 'short',\n    day: '2-digit'\n  };\n\n  if (showTime) {\n    options.hour = '2-digit';\n    options.minute = '2-digit';\n    options.hour12 = false; // Use 24-hour format\n  }\n\n  const formatted = date.toLocaleDateString('th-TH', options);\n  return formatted.replace(/(\\d{2})\\s(\\S+)\\s(\\d{4})/, '$1 $2 $3'); // Ensure consistent format\n};\n\nexport const formatDisplayDate = (dateStr: string): string => {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  if (isNaN(date.getTime())) return '';\n\n  return date.toLocaleDateString('th-TH', {\n    timeZone: 'Asia/Bangkok',\n    day: '2-digit',\n    month: 'short',\n    year: 'numeric'\n  });\n};\n\nexport const getCurrentBangkokDate = (): string => {\n  return new Date().toLocaleDateString('en-CA', {\n    timeZone: 'Asia/Bangkok',\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit'\n  });\n};\n\nexport const isTodayInBangkok = (dateStr: string): boolean => {\n  if (!dateStr) return false;\n  return dateStr.split('T')[0] === getCurrentBangkokDate();\n};\n\nexport const isFutureDate = (dateStr: string): boolean => {\n  if (!dateStr) return false;\n  return dateStr.split('T')[0] > getCurrentBangkokDate();\n};\n\nexport const calculateWorkMinutes = (checkIn: string, checkOut: string): number => {\n  try {\n    const inTime = new Date(`2000-01-01T${checkIn}`);\n    const outTime = new Date(`2000-01-01T${checkOut}`);\n    if (outTime < inTime) outTime.setDate(outTime.getDate() + 1);\n    const diffMs = outTime.getTime() - inTime.getTime();\n    return Math.max(0, Math.floor(diffMs / (1000 * 60)));\n  } catch {\n    return 0;\n  }\n};\n\nexport const formatWorkHours = (minutes: number): string => {\n  const hours = Math.floor(minutes / 60);\n  const mins = minutes % 60;\n  return mins === 0 ? `${hours} ชม.` : `${hours} ชม. ${mins} น.`;\n};\n\nexport const getStatusDisplay = (status: string, isDarkMode: boolean) => {\n  const styles = {\n    Present: {\n      icon: React.createElement(CheckCircle, { className: \"w-4 h-4 text-green-600\" }),\n      text: 'เข้างาน',\n      color: isDarkMode ? 'bg-green-900/30 text-green-400' : 'bg-green-100 text-green-800'\n    },\n    Late: {\n      icon: React.createElement(AlertCircle, { className: \"w-4 h-4 text-orange-600\" }),\n      text: 'สาย',\n      color: isDarkMode ? 'bg-orange-900/30 text-orange-400' : 'bg-orange-100 text-orange-800'\n    },\n    Absent: {\n      icon: React.createElement(XCircle, { className: \"w-4 h-4 text-red-600\" }),\n      text: 'ขาด',\n      color: isDarkMode ? 'bg-red-900/30 text-red-400' : 'bg-red-100 text-red-800'\n    },\n    Incomplete: {\n      icon: React.createElement(Clock, { className: \"w-4 h-4 text-blue-600\" }),\n      text: 'ไม่สมบูรณ์',\n      color: isDarkMode ? 'bg-blue-900/30 text-blue-400' : 'bg-blue-100 text-blue-800'\n    }\n  };\n  return styles[status as keyof typeof styles] || {\n    icon: React.createElement(Clock, { className: \"w-4 h-4 text-gray-600\" }),\n    text: 'ไม่ทราบ',\n    color: isDarkMode ? 'bg-gray-700/50 text-gray-400' : 'bg-gray-100 text-gray-800'\n  };\n};\n\nexport const getDisplayValue = (val: string) => {\n  const displayMap: { [key: string]: string } = {\n    all: 'ทุกสถานะ',\n    Present: 'เข้างาน',\n    Late: 'สาย',\n    Absent: 'ขาด',\n    Incomplete: 'ไม่สมบูรณ์',\n    morning: 'เวรเช้า',\n    afternoon: 'เวรบ่าย',\n    night: 'เวรดึก'\n  };\n  return displayMap[val] || val;\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3168, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/Sidebar.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/Sidebar.tsx\n// Description: Modern Sidebar - Glassmorphism design with smooth animations\n//              Hidden scrollbar, portal tooltips, flyout menu for collapsed mode\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { createPortal } from 'react-dom';\nimport {\n  ChevronDown,\n  ChevronRight,\n  Search,\n  X,\n  Settings,\n  Moon,\n  Sun,\n  PanelLeftClose,\n  PanelLeft,\n  Sparkles,\n  LogOut,\n} from 'lucide-react';\nimport { useMenuContext, MenuAccessItem } from '@/components/providers/MenuProvider';\nimport { getIcon } from '@/components/ui';\nimport { cn } from '@/lib/utils';\nimport { useAuth } from '../providers/AuthProvider';\n\n// ============================================\n// Types\n// ============================================\n\ninterface SidebarProps {\n  collapsed?: boolean;\n  onToggle?: () => void;\n}\n\n// ============================================\n// Flyout Menu Component (Portal-based) - For Collapsed Mode\n// ============================================\n\ninterface FlyoutMenuProps {\n  menu: MenuAccessItem;\n  show: boolean;\n  position: { top: number; left: number };\n  onClose: () => void;\n  pathname: string;\n}\n\nconst FlyoutMenu: React.FC<FlyoutMenuProps> = ({ menu, show, position, onClose, pathname }) => {\n  const [mounted, setMounted] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // Close on click outside\n  useEffect(() => {\n    if (!show) return;\n    \n    const handleClickOutside = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\n        onClose();\n      }\n    };\n\n    // Delay to prevent immediate close\n    const timer = setTimeout(() => {\n      document.addEventListener('mousedown', handleClickOutside);\n    }, 100);\n\n    return () => {\n      clearTimeout(timer);\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [show, onClose]);\n\n  if (!mounted || !show) return null;\n\n  const menuName = menu.menu_name_th || menu.menu_name;\n  const children = menu.children || [];\n\n  const isChildActive = (child: MenuAccessItem): boolean => {\n    if (child.route_path === pathname) return true;\n    if (child.route_path && pathname.startsWith(child.route_path + '/')) return true;\n    return false;\n  };\n\n  // Adjust position to stay within viewport\n  const adjustedTop = Math.min(position.top, window.innerHeight - 350);\n\n  return createPortal(\n    <div\n      ref={menuRef}\n      className=\"fixed z-[9999] min-w-[220px] py-2 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-700 animate-in fade-in-0 zoom-in-95 slide-in-from-left-2 duration-150\"\n      style={{\n        top: Math.max(8, adjustedTop),\n        left: position.left,\n      }}\n    >\n      {/* Header */}\n      <div className=\"px-4 py-2.5 border-b border-slate-100 dark:border-slate-700\">\n        <span className=\"text-sm font-semibold text-slate-800 dark:text-white\">{menuName}</span>\n      </div>\n\n      {/* Menu Items */}\n      <div className=\"py-1 max-h-[300px] overflow-y-auto\">\n        {children.map((child, idx) => {\n          const ChildIcon = getIcon(child.icon || 'file');\n          const childName = child.menu_name_th || child.menu_name;\n          const isActive = isChildActive(child);\n\n          return (\n            <Link\n              key={child.id || child.menu_code || idx}\n              href={child.route_path || '#'}\n              onClick={onClose}\n              className={cn(\n                'flex items-center gap-3 px-4 py-2.5 mx-1.5 rounded-lg text-sm transition-all',\n                isActive\n                  ? 'bg-primary-50 dark:bg-primary-500/10 text-primary-600 dark:text-primary-400 font-medium'\n                  : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700/50 hover:text-slate-900 dark:hover:text-white'\n              )}\n            >\n              <ChildIcon size={16} className=\"shrink-0\" />\n              <span className=\"truncate flex-1\">{childName}</span>\n              {child.badge_count && child.badge_count > 0 && (\n                <span className=\"px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full\">\n                  {child.badge_count > 99 ? '99+' : child.badge_count}\n                </span>\n              )}\n            </Link>\n          );\n        })}\n\n        {children.length === 0 && (\n          <div className=\"px-4 py-4 text-center text-sm text-slate-400\">\n            ไม่มีเมนูย่อย\n          </div>\n        )}\n      </div>\n    </div>,\n    document.body\n  );\n};\n\n// ============================================\n// Tooltip Component (Portal-based)\n// ============================================\n\ninterface TooltipProps {\n  content: string;\n  show: boolean;\n  position: { top: number; left: number };\n}\n\nconst Tooltip: React.FC<TooltipProps> = ({ content, show, position }) => {\n  const [mounted, setMounted] = useState(false);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  if (!mounted || !show) return null;\n\n  return createPortal(\n    <div\n      className=\"fixed z-[9999] px-3 py-2 bg-slate-900 dark:bg-slate-700 text-white text-sm rounded-xl shadow-xl whitespace-nowrap pointer-events-none animate-in fade-in-0 zoom-in-95 duration-150\"\n      style={{\n        top: position.top,\n        left: position.left,\n      }}\n    >\n      {content}\n      <div className=\"absolute left-0 top-1/2 -translate-x-1 -translate-y-1/2 border-4 border-transparent border-r-slate-900 dark:border-r-slate-700\" />\n    </div>,\n    document.body\n  );\n};\n\n// ============================================\n// Menu Item Component\n// ============================================\n\ninterface MenuItemProps {\n  menu: MenuAccessItem;\n  level: number;\n  collapsed: boolean;\n  isActive: boolean;\n  isParentActive: boolean;\n  isExpanded: boolean;\n  hasChildren: boolean;\n  onToggle: () => void;\n  onFlyoutOpen: (menu: MenuAccessItem, position: { top: number; left: number }) => void;\n  pathname: string;\n}\n\nconst MenuItem: React.FC<MenuItemProps> = ({\n  menu,\n  level,\n  collapsed,\n  isActive,\n  isParentActive,\n  isExpanded,\n  hasChildren,\n  onToggle,\n  onFlyoutOpen,\n  pathname,\n}) => {\n  const [showTooltip, setShowTooltip] = useState(false);\n  const [tooltipPosition, setTooltipPosition] = useState({ top: 0, left: 0 });\n  const itemRef = useRef<HTMLDivElement>(null);\n\n  const Icon = getIcon(menu.icon || 'file');\n  const menuName = menu.menu_name_th || menu.menu_name;\n  const badge = menu.badge_count;\n\n  const handleMouseEnter = () => {\n    if (collapsed && itemRef.current && !hasChildren) {\n      const rect = itemRef.current.getBoundingClientRect();\n      setTooltipPosition({\n        top: rect.top + rect.height / 2 - 16,\n        left: rect.right + 12,\n      });\n      setShowTooltip(true);\n    }\n  };\n\n  const handleMouseLeave = () => {\n    setShowTooltip(false);\n  };\n\n  const handleClick = (e: React.MouseEvent) => {\n    if (collapsed && hasChildren && itemRef.current) {\n      e.preventDefault();\n      e.stopPropagation();\n      const rect = itemRef.current.getBoundingClientRect();\n      onFlyoutOpen(menu, {\n        top: rect.top,\n        left: rect.right + 8,\n      });\n    } else if (hasChildren) {\n      onToggle();\n    }\n  };\n\n  // Base classes for all menu items\n  const baseClasses = cn(\n    'group relative flex items-center gap-3 rounded-xl transition-all duration-200',\n    'focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500/50',\n    collapsed ? 'px-3 py-3 justify-center' : 'px-3 py-2.5'\n  );\n\n  // Style based on level and state\n  const getItemClasses = () => {\n    if (isActive) {\n      if (level > 0) {\n        return 'bg-primary-50/80 dark:bg-primary-500/10 text-primary-600 dark:text-primary-400 font-medium';\n      }\n      return 'bg-gradient-to-r from-primary-500 to-primary-600 text-white shadow-lg shadow-primary-500/25';\n    }\n    \n    if (isParentActive) {\n      return 'bg-primary-50/50 dark:bg-primary-500/5 text-primary-600 dark:text-primary-400';\n    }\n    \n    return 'text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 hover:text-slate-900 dark:hover:text-white';\n  };\n\n  const itemContent = (\n    <>\n      {/* Active indicator for submenu */}\n      {isActive && level > 0 && !collapsed && (\n        <span className=\"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-5 bg-primary-500 rounded-r-full\" />\n      )}\n\n      {/* Icon */}\n      <span className={cn(\n        'flex items-center justify-center transition-all duration-200 shrink-0',\n        isActive && level === 0 ? 'scale-110' : '',\n        level > 0 && 'w-5'\n      )}>\n        {level > 0 && !collapsed ? (\n          <span className={cn(\n            'w-1.5 h-1.5 rounded-full transition-colors',\n            isActive ? 'bg-primary-500' : 'bg-slate-300 dark:bg-slate-600'\n          )} />\n        ) : (\n          <Icon size={20} />\n        )}\n      </span>\n\n      {!collapsed && (\n        <>\n          <span className={cn(\n            \"flex-1 text-sm truncate transition-colors text-left\",\n            level > 0 ? 'font-normal' : 'font-medium'\n          )}>\n            {menuName}\n          </span>\n\n          {badge && badge > 0 && (\n            <span className={cn(\n              \"px-1.5 py-0.5 text-xs font-bold rounded-full min-w-[20px] text-center shrink-0\",\n              isActive && level === 0\n                ? \"bg-white/20 text-white\"\n                : \"bg-red-500 text-white\"\n            )}>\n              {badge > 99 ? '99+' : badge}\n            </span>\n          )}\n\n          {hasChildren && (\n            <ChevronDown\n              size={16}\n              className={cn(\n                'text-slate-400 transition-transform duration-300 shrink-0',\n                isExpanded && 'rotate-180',\n                isActive && level === 0 && 'text-white/70'\n              )}\n            />\n          )}\n        </>\n      )}\n\n      {/* Collapsed: badge indicator */}\n      {collapsed && badge && badge > 0 && (\n        <span className=\"absolute -top-1 -right-1 size-4 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center ring-2 ring-white dark:ring-slate-900\">\n          {badge > 9 ? '9+' : badge}\n        </span>\n      )}\n\n      {/* Collapsed: arrow indicator for menus with children */}\n      {collapsed && hasChildren && (\n        <span className=\"absolute -right-0.5 top-1/2 -translate-y-1/2\">\n          <ChevronRight size={12} className=\"text-slate-400\" />\n        </span>\n      )}\n\n      {/* Active glow effect */}\n      {isActive && level === 0 && !collapsed && (\n        <span className=\"absolute inset-0 rounded-xl bg-primary-500/20 blur-xl -z-10\" />\n      )}\n    </>\n  );\n\n  return (\n    <div\n      ref={itemRef}\n      onMouseEnter={handleMouseEnter}\n      onMouseLeave={handleMouseLeave}\n    >\n      {hasChildren ? (\n        <button\n          onClick={handleClick}\n          className={cn(baseClasses, getItemClasses(), 'w-full')}\n        >\n          {itemContent}\n        </button>\n      ) : (\n        <Link\n          href={menu.route_path || '#'}\n          className={cn(baseClasses, getItemClasses())}\n        >\n          {itemContent}\n        </Link>\n      )}\n\n      {/* Tooltip only for items without children in collapsed mode */}\n      <Tooltip\n        content={menuName}\n        show={showTooltip && collapsed && !hasChildren}\n        position={tooltipPosition}\n      />\n    </div>\n  );\n};\n\n// ============================================\n// Main Sidebar Component\n// ============================================\n\nexport function Sidebar({ collapsed = false, onToggle }: SidebarProps) {\n  const pathname = usePathname();\n  const { menus, isLoading, error } = useMenuContext();\n\n  const [expandedMenus, setExpandedMenus] = useState<Set<number | string>>(new Set());\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [mounted, setMounted] = useState(false);\n  const [searchFocused, setSearchFocused] = useState(false);\n\n  // Flyout state\n  const [flyoutMenu, setFlyoutMenu] = useState<MenuAccessItem | null>(null);\n  const [flyoutPosition, setFlyoutPosition] = useState({ top: 0, left: 0 });\n\n  const searchInputRef = useRef<HTMLInputElement>(null);\n  const { user, logout } = useAuth();\n\n  // Mount check\n  useEffect(() => {\n    setMounted(true);\n    setIsDarkMode(document.documentElement.classList.contains('dark'));\n  }, []);\n\n  // Close flyout when sidebar expands\n  useEffect(() => {\n    if (!collapsed) {\n      setFlyoutMenu(null);\n    }\n  }, [collapsed]);\n\n  const handleLogout = () => {\n    logout();\n  };\n\n  const handleFlyoutOpen = (menu: MenuAccessItem, position: { top: number; left: number }) => {\n    // Toggle flyout - if same menu clicked, close it\n    if (flyoutMenu?.id === menu.id || flyoutMenu?.menu_code === menu.menu_code) {\n      setFlyoutMenu(null);\n    } else {\n      setFlyoutMenu(menu);\n      setFlyoutPosition(position);\n    }\n  };\n\n  const handleFlyoutClose = () => {\n    setFlyoutMenu(null);\n  };\n\n  // Auto-expand active menu on mount\n  useEffect(() => {\n    const findActiveParent = (items: MenuAccessItem[], parentIds: (number | string)[] = []): (number | string)[] => {\n      for (const item of items) {\n        if (item.route_path === pathname) {\n          return parentIds;\n        }\n        if (item.children?.length) {\n          const found = findActiveParent(item.children, [...parentIds, item.id || item.menu_code]);\n          if (found.length > parentIds.length) {\n            return found;\n          }\n        }\n      }\n      return [];\n    };\n\n    const activeParents = findActiveParent(menus);\n    if (activeParents.length > 0) {\n      setExpandedMenus((prev) => new Set([...prev, ...activeParents]));\n    }\n  }, [menus, pathname]);\n\n  // Toggle menu expand\n  const toggleExpand = useCallback((menuId: number | string) => {\n    setExpandedMenus((prev) => {\n      const next = new Set(prev);\n      if (next.has(menuId)) {\n        next.delete(menuId);\n      } else {\n        next.add(menuId);\n      }\n      return next;\n    });\n  }, []);\n\n  // Check active state\n  const isActive = useCallback((menu: MenuAccessItem): boolean => {\n    if (menu.route_path === pathname) return true;\n    if (menu.route_path && pathname.startsWith(menu.route_path + '/')) return true;\n    return false;\n  }, [pathname]);\n\n  const isParentActive = useCallback((menu: MenuAccessItem): boolean => {\n    if (isActive(menu)) return true;\n    if (menu.children?.length) {\n      return menu.children.some((child) => isParentActive(child));\n    }\n    return false;\n  }, [isActive]);\n\n  // Filter menus by search\n  const filterMenus = useCallback((items: MenuAccessItem[], query: string): MenuAccessItem[] => {\n    if (!query) return items;\n\n    const lowerQuery = query.toLowerCase();\n\n    return items.reduce<MenuAccessItem[]>((acc, item) => {\n      const matchesName = (item.menu_name_th || item.menu_name || '').toLowerCase().includes(lowerQuery);\n      const filteredChildren = item.children ? filterMenus(item.children, query) : [];\n\n      if (matchesName || filteredChildren.length > 0) {\n        acc.push({\n          ...item,\n          children: filteredChildren.length > 0 ? filteredChildren : item.children,\n        });\n      }\n\n      return acc;\n    }, []);\n  }, []);\n\n  const filteredMenus = filterMenus(menus, searchQuery);\n\n  // Get menu key\n  const getMenuKey = (menu: MenuAccessItem, index: number): string => {\n    if (menu.id) return `menu-${menu.id}`;\n    if (menu.menu_code) return `menu-${menu.menu_code}`;\n    return `menu-idx-${index}`;\n  };\n\n  // Toggle dark mode\n  const toggleDarkMode = () => {\n    document.documentElement.classList.toggle('dark');\n    setIsDarkMode(!isDarkMode);\n  };\n\n  // Render menu item recursively\n  const renderMenuItem = (menu: MenuAccessItem, index: number, level: number = 0) => {\n    if (menu.can_view === false) return null;\n\n    const hasChildren = menu.children && menu.children.length > 0;\n    const isExpanded = expandedMenus.has(menu.id || menu.menu_code) || !!(searchQuery && hasChildren);\n    const active = isActive(menu);\n    const parentActive = isParentActive(menu);\n    const key = getMenuKey(menu, index);\n\n    return (\n      <div key={key} className=\"mb-1\">\n        <MenuItem\n          menu={menu}\n          level={level}\n          collapsed={collapsed}\n          isActive={active}\n          isParentActive={parentActive && !active}\n          isExpanded={isExpanded}\n          hasChildren={hasChildren || false}\n          onToggle={() => toggleExpand(menu.id || menu.menu_code)}\n          onFlyoutOpen={handleFlyoutOpen}\n          pathname={pathname}\n        />\n\n        {/* Nested Children with smooth animation - Only when not collapsed */}\n        {hasChildren && !collapsed && (\n          <div\n            className={cn(\n              'grid transition-all duration-300 ease-in-out',\n              isExpanded ? 'grid-rows-[1fr] opacity-100' : 'grid-rows-[0fr] opacity-0'\n            )}\n          >\n            <div className=\"overflow-hidden\">\n              <div className=\"mt-1 ml-3 pl-3 border-l-2 border-slate-200/50 dark:border-slate-700/50 space-y-0.5\">\n                {menu.children!.map((child, childIndex) => renderMenuItem(child, childIndex, level + 1))}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (!mounted) return null;\n\n  return (\n    <>\n      <aside\n        className={cn(\n          'fixed left-0 top-0 z-40 h-screen',\n          'flex flex-col',\n          'bg-white/80 dark:bg-slate-900/80',\n          'backdrop-blur-xl',\n          'border-r border-slate-200/50 dark:border-slate-800/50',\n          'transition-all duration-300 ease-in-out',\n          collapsed ? 'w-20' : 'w-64'\n        )}\n      >\n        {/* Logo Section */}\n        <div className={cn(\n          'h-16 flex items-center shrink-0 border-b border-slate-200/50 dark:border-slate-800/50',\n          collapsed ? 'justify-center px-2' : 'justify-between px-4'\n        )}>\n          <Link href=\"/\" className=\"flex items-center gap-3 group\">\n            <div className=\"relative\">\n              <div className=\"size-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25 group-hover:shadow-primary-500/40 transition-all group-hover:scale-105\">\n                <span className=\"text-white font-bold text-lg\">K</span>\n              </div>\n              <div className=\"absolute inset-0 rounded-xl bg-primary-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity\" />\n            </div>\n            {!collapsed && (\n              <div className=\"overflow-hidden\">\n                <h1 className=\"font-bold text-slate-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors\">\n                  GWT-MED\n                </h1>\n                <p className=\"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1\">\n                  <Sparkles size={10} className=\"text-amber-500\" />\n                  Smart Hospital\n                </p>\n              </div>\n            )}\n          </Link>\n        </div>\n\n        {/* Search Section */}\n        {!collapsed && (\n          <div className=\"p-3 shrink-0 border-b border-slate-200/50 dark:border-slate-800/50\">\n            <div className={cn(\n              \"relative transition-all duration-300\",\n              searchFocused && \"scale-[1.02]\"\n            )}>\n              <Search size={16} className={cn(\n                \"absolute left-3 top-1/2 -translate-y-1/2 transition-colors\",\n                searchFocused ? \"text-primary-500\" : \"text-slate-400\"\n              )} />\n              <input\n                ref={searchInputRef}\n                type=\"text\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                onFocus={() => setSearchFocused(true)}\n                onBlur={() => setSearchFocused(false)}\n                placeholder=\"ค้นหาเมนู...\"\n                className={cn(\n                  \"w-full pl-9 pr-8 py-2.5 rounded-xl text-sm transition-all duration-300\",\n                  \"bg-slate-100/80 dark:bg-slate-800/50\",\n                  \"border border-transparent\",\n                  \"placeholder:text-slate-400\",\n                  \"focus:outline-none focus:bg-white dark:focus:bg-slate-800\",\n                  \"focus:border-primary-500/50 focus:ring-2 focus:ring-primary-500/20\"\n                )}\n              />\n              {searchQuery && (\n                <button\n                  onClick={() => setSearchQuery('')}\n                  className=\"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-lg hover:bg-slate-200/50 dark:hover:bg-slate-700/50 transition-colors\"\n                >\n                  <X size={14} />\n                </button>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Navigation */}\n        <nav\n          className={cn(\n            'flex-1 overflow-y-auto p-3 space-y-1',\n            '[&::-webkit-scrollbar]:hidden',\n            '[-ms-overflow-style:none]',\n            '[scrollbar-width:none]'\n          )}\n        >\n          {isLoading ? (\n            <div className=\"flex flex-col items-center justify-center py-8 gap-3\">\n              <div className=\"size-8 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\n              {!collapsed && (\n                <span className=\"text-sm text-slate-500\">กำลังโหลด...</span>\n              )}\n            </div>\n          ) : error ? (\n            <div className=\"p-4 bg-red-50/80 dark:bg-red-500/10 rounded-xl border border-red-200/50 dark:border-red-500/20\">\n              {!collapsed && (\n                <p className=\"text-sm text-red-600 dark:text-red-400\">{error}</p>\n              )}\n            </div>\n          ) : filteredMenus.length === 0 ? (\n            <div className=\"text-center py-8\">\n              {!collapsed && (\n                <div className=\"space-y-2\">\n                  <div className=\"size-12 mx-auto bg-slate-100/80 dark:bg-slate-800/50 rounded-xl flex items-center justify-center\">\n                    <Search size={24} className=\"text-slate-400\" />\n                  </div>\n                  <p className=\"text-sm text-slate-500\">\n                    {searchQuery ? 'ไม่พบเมนูที่ค้นหา' : 'ไม่มีเมนูในระบบ'}\n                  </p>\n                </div>\n              )}\n            </div>\n          ) : (\n            filteredMenus.map((menu, index) => renderMenuItem(menu, index))\n          )}\n        </nav>\n\n        {/* User Section */}\n        {!collapsed && (\n          <div className=\"p-3 shrink-0 border-t border-slate-200/50 dark:border-slate-800/50\">\n            <div className=\"flex items-center gap-3 p-2.5 rounded-xl bg-slate-50/80 dark:bg-slate-800/30 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 transition-all cursor-pointer group\">\n              <div className=\"relative\">\n                <div className=\"size-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-md group-hover:shadow-lg group-hover:shadow-primary-500/25 transition-all\">\n                  <span className=\"text-white font-semibold text-sm\">\n                    {user?.name?.charAt(0) || 'U'}\n                  </span>\n                </div>\n                <span className=\"absolute -bottom-0.5 -right-0.5 size-3 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full\" />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-slate-900 dark:text-white truncate\">\n                  {user?.name || 'ผู้ดูแลระบบ'}\n                </p>\n                <p className=\"text-xs text-slate-500 truncate\">{user?.username || 'admin@hospital.go.th'}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Footer Actions */}\n        <div className={cn(\n          'shrink-0 border-t border-slate-200/50 dark:border-slate-800/50',\n          collapsed ? 'p-2' : 'p-3'\n        )}>\n          <div className={cn(\n            'flex items-center',\n            collapsed ? 'flex-col gap-2' : 'justify-between'\n          )}>\n            {/* Dark Mode Toggle */}\n            <button\n              onClick={toggleDarkMode}\n              className={cn(\n                \"p-2.5 rounded-xl transition-all active:scale-95\",\n                isDarkMode\n                  ? \"text-amber-500 hover:bg-amber-500/10\"\n                  : \"text-slate-400 hover:text-slate-600 hover:bg-slate-100/80 dark:hover:bg-slate-800/50\"\n              )}\n              title={isDarkMode ? 'Light Mode' : 'Dark Mode'}\n            >\n              {isDarkMode ? <Sun size={18} /> : <Moon size={18} />}\n            </button>\n\n            {/* Settings */}\n            {!collapsed && (\n              <Link\n                href=\"/settings\"\n                className=\"p-2.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 rounded-xl transition-all active:scale-95\"\n                title=\"ตั้งค่า\"\n              >\n                <Settings size={18} />\n              </Link>\n            )}\n\n            {/* Collapse Toggle */}\n            <button\n              onClick={onToggle}\n              className=\"p-2.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 rounded-xl transition-all active:scale-95\"\n              title={collapsed ? 'ขยาย Sidebar' : 'ย่อ Sidebar'}\n            >\n              {collapsed ? <PanelLeft size={18} /> : <PanelLeftClose size={18} />}\n            </button>\n\n            {/* Logout */}\n            {!collapsed && (\n              <button\n                onClick={handleLogout}\n                className=\"p-2.5 text-slate-400 hover:text-red-500 hover:bg-red-50/80 dark:hover:bg-red-500/10 rounded-xl transition-all active:scale-95\"\n                title=\"ออกจากระบบ\"\n              >\n                <LogOut size={18} />\n              </button>\n            )}\n          </div>\n        </div>\n      </aside>\n\n      {/* Flyout Menu Portal - For Collapsed Mode */}\n      {flyoutMenu && (\n        <FlyoutMenu\n          menu={flyoutMenu}\n          show={true}\n          position={flyoutPosition}\n          onClose={handleFlyoutClose}\n          pathname={pathname}\n        />\n      )}\n    </>\n  );\n}\n\nexport default Sidebar;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4204, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/HorizontalNav.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/HorizontalNavModern.tsx\n// Description: Modern Horizontal Navigation for HIS - Clean medical aesthetic\n// Updated: Sky blue hover effects for better visual appeal\n// =============================================================================\n\n'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { ChevronDown, Circle } from 'lucide-react';\nimport { useMenuContext, MenuAccessItem } from '@/components/providers/MenuProvider';\nimport { getIcon } from '@/components/ui';\n\nexport function HorizontalNav() {\n  const pathname = usePathname();\n  const { menus, isLoading } = useMenuContext();\n  const [openDropdown, setOpenDropdown] = useState<number | string | null>(null);\n  const [hoveredItem, setHoveredItem] = useState<string | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setOpenDropdown(null);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Close dropdown on route change\n  useEffect(() => {\n    setOpenDropdown(null);\n  }, [pathname]);\n\n  const isActive = (menu: MenuAccessItem): boolean => {\n    if (menu.route_path === pathname) return true;\n    if (menu.route_path && pathname.startsWith(menu.route_path + '/')) return true;\n    return false;\n  };\n\n  const isParentActive = (menu: MenuAccessItem): boolean => {\n    if (isActive(menu)) return true;\n    if (menu.children?.length) {\n      return menu.children.some((child) => isParentActive(child));\n    }\n    return false;\n  };\n\n  const getMenuKey = (menu: MenuAccessItem, index: number): string => {\n    return menu.id ? `nav-${menu.id}` : menu.menu_code ? `nav-${menu.menu_code}` : `nav-idx-${index}`;\n  };\n\n  const getMenuId = (menu: MenuAccessItem): number | string => menu.id || menu.menu_code;\n\n  const toggleDropdown = (menuId: number | string) => {\n    setOpenDropdown((prev) => (prev === menuId ? null : menuId));\n  };\n\n  if (isLoading) {\n    return (\n      <nav className=\"hidden lg:flex items-center gap-2\">\n        {/* Skeleton loading with sky blue tint */}\n        {[1, 2, 3, 4].map((i) => (\n          <div\n            key={i}\n            className=\"h-9 w-24 rounded-lg bg-sky-100 dark:bg-sky-900/30 animate-pulse\"\n          />\n        ))}\n      </nav>\n    );\n  }\n\n  return (\n    <nav className=\"hidden lg:flex items-center gap-1\" ref={dropdownRef}>\n      {menus.map((menu, index) => {\n        const Icon = getIcon(menu.icon || 'file');\n        const hasChildren = menu.children && menu.children.length > 0;\n        const active = isActive(menu);\n        const parentActive = isParentActive(menu);\n        const key = getMenuKey(menu, index);\n        const menuId = getMenuId(menu);\n        const isHovered = hoveredItem === key;\n        const isOpen = openDropdown === menuId;\n\n        if (menu.can_view === false) return null;\n\n        // Base styles for nav items\n        const baseStyles = `\n          relative flex items-center gap-2 px-3.5 py-2 rounded-xl text-sm font-medium\n          transition-all duration-200 ease-out\n          focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-500/50\n        `;\n\n        // Active state - sky blue gradient\n        const activeStyles = `\n          bg-gradient-to-r from-sky-500/15 to-sky-400/10\n          dark:from-sky-500/25 dark:to-sky-400/15\n          text-sky-700 dark:text-sky-300\n          shadow-sm shadow-sky-500/10\n        `;\n\n        // Hover state - sky blue colors\n        const inactiveStyles = `\n          text-slate-600 dark:text-slate-400\n          hover:bg-sky-50 dark:hover:bg-sky-900/40\n          hover:text-sky-700 dark:hover:text-sky-300\n          hover:shadow-sm hover:shadow-sky-500/10\n        `;\n\n        if (hasChildren) {\n          return (\n            <div key={key} className=\"relative\">\n              <button\n                onClick={() => toggleDropdown(menuId)}\n                onMouseEnter={() => setHoveredItem(key)}\n                onMouseLeave={() => setHoveredItem(null)}\n                className={`\n                  ${baseStyles}\n                  ${parentActive ? activeStyles : inactiveStyles}\n                  group\n                `}\n                aria-expanded={isOpen}\n                aria-haspopup=\"true\"\n              >\n                {/* Active indicator line - sky blue gradient */}\n                {parentActive && (\n                  <span className=\"absolute bottom-0 left-3 right-3 h-0.5 bg-gradient-to-r from-sky-500 to-sky-400 rounded-full\" />\n                )}\n\n                {/* Icon with hover animation */}\n                <span className={`\n                  transition-transform duration-200\n                  ${isHovered ? 'scale-110' : 'scale-100'}\n                `}>\n                  <Icon size={18} strokeWidth={parentActive ? 2.5 : 2} />\n                </span>\n\n                <span className=\"whitespace-nowrap\">\n                  {menu.menu_name_th || menu.menu_name}\n                </span>\n\n                {/* Chevron with rotation */}\n                <ChevronDown\n                  size={14}\n                  className={`\n                    transition-transform duration-200 ease-out\n                    ${isOpen ? 'rotate-180' : ''}\n                    opacity-60\n                  `}\n                />\n\n                {/* Notification badge */}\n                {menu.badge_count && menu.badge_count > 0 && (\n                  <span className=\"absolute -top-1 -right-1 min-w-5 h-5 px-1.5 flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full animate-pulse\">\n                    {menu.badge_count > 99 ? '99+' : menu.badge_count}\n                  </span>\n                )}\n              </button>\n\n              {/* Dropdown Menu with Animation */}\n              <div\n                className={`\n                  absolute top-full left-0 mt-2 min-w-56 z-50\n                  transition-all duration-200 ease-out origin-top-left\n                  ${isOpen\n                    ? 'opacity-100 scale-100 translate-y-0'\n                    : 'opacity-0 scale-95 -translate-y-2 pointer-events-none'\n                  }\n                `}\n              >\n                <div className=\"\n                  bg-white/95 dark:bg-slate-900/95 backdrop-blur-xl\n                  border border-sky-100 dark:border-sky-800/50\n                  rounded-2xl shadow-xl shadow-sky-900/10 dark:shadow-black/30\n                  py-2 overflow-hidden\n                \">\n                  {/* Dropdown header */}\n                  <div className=\"px-4 py-2 border-b border-sky-50 dark:border-sky-900/50\">\n                    <p className=\"text-xs font-medium text-sky-500 dark:text-sky-400 uppercase tracking-wider\">\n                      {menu.menu_name_th || menu.menu_name}\n                    </p>\n                  </div>\n\n                  {/* Dropdown items */}\n                  <div className=\"py-1\">\n                    {menu.children!.map((child, childIndex) => {\n                      const ChildIcon = getIcon(child.icon || 'file');\n                      const childActive = isActive(child);\n                      const childKey = getMenuKey(child, childIndex);\n\n                      if (child.can_view === false) return null;\n\n                      return (\n                        <Link\n                          key={childKey}\n                          href={child.route_path || '#'}\n                          onClick={() => setOpenDropdown(null)}\n                          className={`\n                            flex items-center gap-3 px-4 py-2.5 mx-2 rounded-xl\n                            text-sm transition-all duration-150 group/item\n                            ${childActive\n                              ? 'bg-sky-50 dark:bg-sky-500/20 text-sky-700 dark:text-sky-300'\n                              : 'text-slate-600 dark:text-slate-400 hover:bg-sky-50/80 dark:hover:bg-sky-900/50 hover:text-sky-700 dark:hover:text-sky-300'\n                            }\n                          `}\n                        >\n                          {/* Icon container with sky blue */}\n                          <span className={`\n                            flex items-center justify-center w-8 h-8 rounded-lg\n                            transition-all duration-150\n                            ${childActive\n                              ? 'bg-sky-100 dark:bg-sky-500/25 text-sky-600 dark:text-sky-400'\n                              : 'bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-500 group-hover/item:bg-sky-100 dark:group-hover/item:bg-sky-900/60 group-hover/item:text-sky-600 dark:group-hover/item:text-sky-400'\n                            }\n                          `}>\n                            <ChildIcon size={16} />\n                          </span>\n\n                          <span className=\"flex-1 font-medium\">\n                            {child.menu_name_th || child.menu_name}\n                          </span>\n\n                          {/* Status indicator */}\n                          {child.is_new && (\n                            <span className=\"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wide text-sky-700 dark:text-sky-400 bg-sky-100 dark:bg-sky-500/20 rounded-full\">\n                              New\n                            </span>\n                          )}\n\n                          {/* Arrow indicator on hover */}\n                          <span className=\"opacity-0 group-hover/item:opacity-100 transition-opacity text-sky-500\">\n                            →\n                          </span>\n                        </Link>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            </div>\n          );\n        }\n\n        // Menu item without children\n        return (\n          <Link\n            key={key}\n            href={menu.route_path || '#'}\n            onMouseEnter={() => setHoveredItem(key)}\n            onMouseLeave={() => setHoveredItem(null)}\n            className={`\n              ${baseStyles}\n              ${active ? activeStyles : inactiveStyles}\n              group\n            `}\n          >\n            {/* Active indicator line - sky blue */}\n            {active && (\n              <span className=\"absolute bottom-0 left-3 right-3 h-0.5 bg-gradient-to-r from-sky-500 to-sky-400 rounded-full\" />\n            )}\n\n            {/* Icon with hover animation */}\n            <span className={`\n              transition-transform duration-200\n              ${isHovered ? 'scale-110' : 'scale-100'}\n            `}>\n              <Icon size={18} strokeWidth={active ? 2.5 : 2} />\n            </span>\n\n            <span className=\"whitespace-nowrap\">\n              {menu.menu_name_th || menu.menu_name}\n            </span>\n\n            {/* Status dot for important modules */}\n            {menu.has_notification && (\n              <Circle\n                size={8}\n                className=\"fill-sky-500 text-sky-500 animate-pulse\"\n              />\n            )}\n          </Link>\n        );\n      })}\n    </nav>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4602, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/MobileMenu.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/MobileMenu.tsx\n// Description: Mobile Menu - Slide-out menu from LEFT with dynamic menus from API\n//              Shows on mobile and tablet (below xl: 1280px)\n// =============================================================================\n\n'use client';\n\nimport { useState } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { X, ChevronDown, ChevronRight, LogOut, Moon, Sun } from 'lucide-react';\nimport { useMenuContext, MenuAccessItem } from '@/components/providers/MenuProvider';\nimport { useAuth } from '@/components/providers/AuthProvider';\nimport { useTheme } from '@/components/providers/ThemeProvider';\nimport { getIcon } from '@/components/ui';\n\ninterface MobileMenuProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function MobileMenu({ isOpen, onClose }: MobileMenuProps) {\n  const pathname = usePathname();\n  const { menus, isLoading } = useMenuContext();\n  const { user, logout } = useAuth();\n  const { theme, toggleTheme } = useTheme();\n  const [expandedMenus, setExpandedMenus] = useState<Set<number | string>>(new Set());\n\n  const toggleExpand = (menuId: number | string) => {\n    setExpandedMenus((prev) => {\n      const next = new Set(prev);\n      if (next.has(menuId)) {\n        next.delete(menuId);\n      } else {\n        next.add(menuId);\n      }\n      return next;\n    });\n  };\n\n  const isActive = (menu: MenuAccessItem): boolean => {\n    if (menu.route_path === pathname) return true;\n    if (menu.route_path && pathname.startsWith(menu.route_path + '/')) return true;\n    return false;\n  };\n\n  const getMenuKey = (menu: MenuAccessItem, index: number): string => {\n    if (menu.id) return `mobile-${menu.id}`;\n    if (menu.menu_code) return `mobile-${menu.menu_code}`;\n    return `mobile-idx-${index}`;\n  };\n\n  const getMenuId = (menu: MenuAccessItem): number | string => {\n    return menu.id || menu.menu_code;\n  };\n\n  const handleLogout = () => {\n    logout();\n    onClose();\n  };\n\n  const renderMenuItem = (menu: MenuAccessItem, index: number) => {\n    const Icon = getIcon(menu.icon || 'file');\n    const hasChildren = menu.children && menu.children.length > 0;\n    const menuId = getMenuId(menu);\n    const isExpanded = expandedMenus.has(menuId);\n    const active = isActive(menu);\n    const key = getMenuKey(menu, index);\n\n    // Skip if menu is not viewable\n    if (menu.can_view === false) return null;\n\n    if (hasChildren) {\n      return (\n        <div key={key} className=\"mb-1\">\n          <button\n            onClick={() => toggleExpand(menuId)}\n            className={`\n              w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors\n              ${active\n                ? 'bg-primary-50 dark:bg-primary-500/10 text-primary-600 dark:text-primary-400'\n                : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800'\n              }\n            `}\n          >\n            <Icon size={20} />\n            <span className=\"flex-1 text-left font-medium\">\n              {menu.menu_name_th || menu.menu_name}\n            </span>\n            {isExpanded ? (\n              <ChevronDown size={18} className=\"text-slate-400\" />\n            ) : (\n              <ChevronRight size={18} className=\"text-slate-400\" />\n            )}\n          </button>\n\n          {/* Children */}\n          {isExpanded && (\n            <div className=\"mt-1 ml-6 pl-4 border-l-2 border-slate-200 dark:border-slate-700 space-y-1\">\n              {menu.children!.map((child, childIndex) => {\n                const ChildIcon = getIcon(child.icon || 'file');\n                const childActive = isActive(child);\n                const childKey = getMenuKey(child, childIndex);\n\n                if (child.can_view === false) return null;\n\n                return (\n                  <Link\n                    key={childKey}\n                    href={child.route_path || '#'}\n                    onClick={onClose}\n                    className={`\n                      flex items-center gap-3 px-4 py-2.5 rounded-xl transition-colors\n                      ${childActive\n                        ? 'bg-primary-500 text-white'\n                        : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800'\n                      }\n                    `}\n                  >\n                    <ChildIcon size={18} />\n                    <span className=\"font-medium\">{child.menu_name_th || child.menu_name}</span>\n                  </Link>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    // Menu item without children\n    return (\n      <Link\n        key={key}\n        href={menu.route_path || '#'}\n        onClick={onClose}\n        className={`\n          flex items-center gap-3 px-4 py-3 rounded-xl transition-colors mb-1\n          ${active\n            ? 'bg-primary-500 text-white'\n            : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800'\n          }\n        `}\n      >\n        <Icon size={20} />\n        <span className=\"font-medium\">{menu.menu_name_th || menu.menu_name}</span>\n      </Link>\n    );\n  };\n\n  return (\n    <>\n      {/* Backdrop - Shows below xl breakpoint */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 xl:hidden\"\n          onClick={onClose}\n        />\n      )}\n\n      {/* Menu Panel - LEFT SIDE - Shows below xl breakpoint */}\n      <div\n        className={`\n          fixed top-0 left-0 h-full w-80 max-w-[85vw] bg-white dark:bg-slate-900 shadow-2xl z-50 \n          transform transition-transform duration-300 ease-in-out xl:hidden\n          ${isOpen ? 'translate-x-0' : '-translate-x-full'}\n        `}\n      >\n        {/* Header with Logo */}\n        <div className=\"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-800\">\n          <Link href=\"/\" onClick={onClose} className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25\">\n              <span className=\"text-white font-bold text-lg\">M</span>\n            </div>\n            <div>\n              <h1 className=\"font-bold text-slate-900 dark:text-white\">Korat</h1>\n              <p className=\"text-xs text-slate-500 dark:text-slate-400\">HIS Platform</p>\n            </div>\n          </Link>\n          <button\n            onClick={onClose}\n            className=\"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors\"\n          >\n            <X size={24} />\n          </button>\n        </div>\n\n        {/* User Info */}\n        {user && (\n          <div className=\"p-4 border-b border-slate-200 dark:border-slate-800\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-full bg-primary-100 dark:bg-primary-500/20 flex items-center justify-center\">\n                <span className=\"text-primary-600 dark:text-primary-400 font-semibold text-lg\">\n                  {user.name?.charAt(0) || 'U'}\n                </span>\n              </div>\n              <div>\n                <p className=\"font-medium text-slate-900 dark:text-white\">{user.name}</p>\n                <p className=\"text-sm text-slate-500\">{user.role}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Navigation */}\n        <nav className=\"flex-1 overflow-y-auto p-4 [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]\" style={{ maxHeight: 'calc(100vh - 220px)' }}>\n          {isLoading ? (\n            <div className=\"flex flex-col items-center justify-center py-8\">\n              <div className=\"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\n              <span className=\"text-sm text-slate-500 mt-2\">Loading menus...</span>\n            </div>\n          ) : menus.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <p className=\"text-sm text-slate-500\">No menus available</p>\n            </div>\n          ) : (\n            <div className=\"space-y-1\">\n              {menus.map((menu, index) => renderMenuItem(menu, index))}\n            </div>\n          )}\n        </nav>\n\n        {/* Footer Actions */}\n        <div className=\"absolute bottom-0 left-0 right-0 p-4 border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={toggleTheme}\n              className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors\"\n            >\n              {theme === 'dark' ? <Sun size={18} /> : <Moon size={18} />}\n              <span className=\"text-sm font-medium\">\n                {theme === 'dark' ? 'Light' : 'Dark'}\n              </span>\n            </button>\n            <button\n              onClick={handleLogout}\n              className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-critical-600 dark:text-critical-400 hover:bg-critical-50 dark:hover:bg-critical-500/10 rounded-xl transition-colors\"\n            >\n              <LogOut size={18} />\n              <span className=\"text-sm font-medium\">Logout</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5108, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/Header.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/Header.tsx\n// Description: Header - Modern glassmorphism top navigation bar\n//              Using xl breakpoint (1280px) for desktop\n// =============================================================================\n\n'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Link from 'next/link';\nimport { \n  Menu, \n  Bell, \n  Sun, \n  Moon, \n  User, \n  Settings, \n  LogOut, \n  ChevronDown, \n  Search,\n  PanelLeft,\n  PanelTop,\n  Command,\n  Sparkles\n} from 'lucide-react';\nimport { useAuth } from '@/components/providers/AuthProvider';\nimport { useTheme } from '@/components/providers/ThemeProvider';\n\ntype LayoutMode = 'sidebar' | 'horizontal';\n\ninterface HeaderProps {\n  onMenuClick?: () => void;\n  layoutMode?: LayoutMode;\n  onLayoutModeChange?: (mode: LayoutMode) => void;\n}\n\nexport function Header({ onMenuClick, layoutMode = 'sidebar', onLayoutModeChange }: HeaderProps) {\n  const { user, logout } = useAuth();\n  const { theme, toggleTheme } = useTheme();\n  const [userMenuOpen, setUserMenuOpen] = useState(false);\n  const [searchFocused, setSearchFocused] = useState(false);\n  const userMenuRef = useRef<HTMLDivElement>(null);\n\n  // Close user menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (userMenuRef.current && !userMenuRef.current.contains(event.target as Node)) {\n        setUserMenuOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleLogout = () => {\n    logout();\n    setUserMenuOpen(false);\n  };\n\n  const toggleLayoutMode = () => {\n    const newMode = layoutMode === 'sidebar' ? 'horizontal' : 'sidebar';\n    onLayoutModeChange?.(newMode);\n  };\n\n  return (\n    <header className=\"sticky top-0 z-30 h-16 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-slate-200/50 dark:border-slate-800/50\">\n      <div className=\"h-full px-4 flex items-center justify-between gap-4\">\n        {/* Left Section */}\n        <div className=\"flex items-center gap-4\">\n          {/* Mobile Menu Button - Shows below xl (1280px) */}\n          <button\n            onClick={onMenuClick}\n            className=\"xl:hidden p-2.5 text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 rounded-xl transition-all active:scale-95\"\n          >\n            <Menu size={22} />\n          </button>\n\n          {/* Logo - Show on mobile/tablet OR when in horizontal mode on desktop */}\n          <Link \n            href=\"/\" \n            className={`flex items-center gap-3 group ${\n              layoutMode === 'horizontal' ? 'flex' : 'xl:hidden flex'\n            }`}\n          >\n            <div className=\"relative\">\n              <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25 group-hover:shadow-primary-500/40 transition-shadow\">\n                <span className=\"text-white font-bold text-lg\">K</span>\n              </div>\n              {/* Glow effect on hover */}\n              <div className=\"absolute inset-0 rounded-xl bg-primary-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity -z-10\" />\n            </div>\n            <div className=\"hidden sm:block\">\n              <h1 className=\"font-bold text-slate-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors\">Korat</h1>\n              <p className=\"text-xs text-slate-500 dark:text-slate-400\">HIS Platform</p>\n            </div>\n          </Link>\n\n          {/* Divider - Only in horizontal mode on desktop */}\n          {layoutMode === 'horizontal' && (\n            <div className=\"hidden xl:block h-8 w-px bg-gradient-to-b from-transparent via-slate-300 dark:via-slate-700 to-transparent mx-2\" />\n          )}\n\n          {/* Search Bar - Tablet and Desktop */}\n          <div className=\"hidden md:flex items-center\">\n            <div className={`relative transition-all duration-300 ${searchFocused ? 'w-80' : 'w-64'}`}>\n              <Search size={18} className={`absolute left-3 top-1/2 -translate-y-1/2 transition-colors ${searchFocused ? 'text-primary-500' : 'text-slate-400'}`} />\n              <input\n                type=\"text\"\n                placeholder=\"Search...\"\n                onFocus={() => setSearchFocused(true)}\n                onBlur={() => setSearchFocused(false)}\n                className=\"w-full pl-10 pr-20 py-2.5 bg-slate-100/80 dark:bg-slate-800/80 border border-transparent hover:border-slate-200 dark:hover:border-slate-700 focus:border-primary-500/50 focus:bg-white dark:focus:bg-slate-800 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 transition-all\"\n              />\n              {/* Keyboard shortcut hint */}\n              <div className=\"absolute right-3 top-1/2 -translate-y-1/2 hidden lg:flex items-center gap-1 text-xs text-slate-400\">\n                <kbd className=\"px-1.5 py-0.5 bg-slate-200/80 dark:bg-slate-700/80 rounded text-[10px] font-medium\">⌘</kbd>\n                <kbd className=\"px-1.5 py-0.5 bg-slate-200/80 dark:bg-slate-700/80 rounded text-[10px] font-medium\">K</kbd>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Right Section */}\n        <div className=\"flex items-center gap-1.5\">\n          {/* Layout Mode Toggle - Desktop Only (xl+) */}\n          {onLayoutModeChange && (\n            <div className=\"hidden xl:flex items-center bg-slate-100/80 dark:bg-slate-800/80 rounded-xl p-1 border border-slate-200/50 dark:border-slate-700/50\">\n              <button\n                onClick={() => onLayoutModeChange('sidebar')}\n                className={`p-2 rounded-lg transition-all ${\n                  layoutMode === 'sidebar'\n                    ? 'bg-white dark:bg-slate-700 text-primary-500 shadow-sm'\n                    : 'text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'\n                }`}\n                title=\"Sidebar Layout\"\n              >\n                <PanelLeft size={18} />\n              </button>\n              <button\n                onClick={() => onLayoutModeChange('horizontal')}\n                className={`p-2 rounded-lg transition-all ${\n                  layoutMode === 'horizontal'\n                    ? 'bg-white dark:bg-slate-700 text-primary-500 shadow-sm'\n                    : 'text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'\n                }`}\n                title=\"Horizontal Layout\"\n              >\n                <PanelTop size={18} />\n              </button>\n            </div>\n          )}\n\n          {/* Divider */}\n          <div className=\"hidden sm:block h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1\" />\n\n          {/* Theme Toggle */}\n          <button\n            onClick={toggleTheme}\n            className=\"p-2.5 text-slate-500 hover:text-amber-500 dark:hover:text-amber-400 hover:bg-amber-50 dark:hover:bg-amber-500/10 rounded-xl transition-all active:scale-95\"\n            title={theme === 'dark' ? 'Switch to Light Mode' : 'Switch to Dark Mode'}\n          >\n            {theme === 'dark' ? <Sun size={20} /> : <Moon size={20} />}\n          </button>\n\n          {/* Notifications */}\n          <button\n            className=\"relative p-2.5 text-slate-500 hover:text-primary-500 hover:bg-primary-50 dark:hover:bg-primary-500/10 rounded-xl transition-all active:scale-95\"\n            title=\"Notifications\"\n          >\n            <Bell size={20} />\n            {/* Notification badge with pulse animation */}\n            <span className=\"absolute top-1.5 right-1.5 flex h-2.5 w-2.5\">\n              <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75\"></span>\n              <span className=\"relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500\"></span>\n            </span>\n          </button>\n\n          {/* Divider */}\n          <div className=\"hidden sm:block h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1\" />\n\n          {/* User Menu */}\n          <div className=\"relative\" ref={userMenuRef}>\n            <button\n              onClick={() => setUserMenuOpen(!userMenuOpen)}\n              className={`flex items-center gap-2.5 p-1.5 pl-3 rounded-xl transition-all active:scale-[0.98] ${\n                userMenuOpen \n                  ? 'bg-primary-50 dark:bg-primary-500/10' \n                  : 'hover:bg-slate-100/80 dark:hover:bg-slate-800/80'\n              }`}\n            >\n              <div className=\"hidden sm:block text-right\">\n                <p className=\"text-sm font-medium text-slate-700 dark:text-slate-200\">{user?.name || 'User'}</p>\n                <p className=\"text-xs text-slate-500 dark:text-slate-400\">{user?.role || 'Guest'}</p>\n              </div>\n              <div className=\"relative\">\n                <div className=\"w-9 h-9 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-md\">\n                  <span className=\"text-white font-semibold text-sm\">\n                    {user?.name?.charAt(0) || 'U'}\n                  </span>\n                </div>\n                {/* Online indicator */}\n                <span className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full\" />\n              </div>\n              <ChevronDown\n                size={16}\n                className={`hidden sm:block text-slate-400 transition-transform duration-200 ${userMenuOpen ? 'rotate-180' : ''}`}\n              />\n            </button>\n\n            {/* Dropdown Menu */}\n            {userMenuOpen && (\n              <div className=\"absolute right-0 top-full mt-2 w-64 bg-white/95 dark:bg-slate-900/95 backdrop-blur-xl border border-slate-200/50 dark:border-slate-700/50 rounded-2xl shadow-xl shadow-slate-900/10 dark:shadow-slate-900/50 py-2 z-50 overflow-hidden\">\n                {/* User Info Header */}\n                <div className=\"px-4 py-3 bg-gradient-to-r from-primary-500/10 to-primary-600/5 dark:from-primary-500/20 dark:to-primary-600/10 border-b border-slate-200/50 dark:border-slate-700/50\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25 shrink-0\">\n                      <span className=\"text-white font-bold text-sm\">\n                        {user?.name?.charAt(0) || 'U'}\n                      </span>\n                    </div>\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"font-medium text-sm text-slate-900 dark:text-white truncate\">{user?.name}</p>\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400 truncate\">{user?.username}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Menu Items */}\n                <div className=\"py-2\">\n                  <Link\n                    href=\"/profile\"\n                    onClick={() => setUserMenuOpen(false)}\n                    className=\"flex items-center gap-3 px-4 py-2.5 text-sm text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 hover:text-slate-900 dark:hover:text-white transition-colors group\"\n                  >\n                    <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-primary-100 dark:group-hover:bg-primary-500/20 transition-colors\">\n                      <User size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                    </div>\n                    <span>Profile</span>\n                  </Link>\n                  <Link\n                    href=\"/settings\"\n                    onClick={() => setUserMenuOpen(false)}\n                    className=\"flex items-center gap-3 px-4 py-2.5 text-sm text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 hover:text-slate-900 dark:hover:text-white transition-colors group\"\n                  >\n                    <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-primary-100 dark:group-hover:bg-primary-500/20 transition-colors\">\n                      <Settings size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                    </div>\n                    <span>Settings</span>\n                  </Link>\n                </div>\n\n                {/* Layout Toggle - Tablet and Mobile (below xl) */}\n                {onLayoutModeChange && (\n                  <div className=\"xl:hidden border-t border-slate-200/50 dark:border-slate-700/50 py-2\">\n                    <button\n                      onClick={toggleLayoutMode}\n                      className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 hover:text-slate-900 dark:hover:text-white transition-colors group\"\n                    >\n                      <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-primary-100 dark:group-hover:bg-primary-500/20 transition-colors\">\n                        {layoutMode === 'sidebar' ? (\n                          <PanelTop size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                        ) : (\n                          <PanelLeft size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                        )}\n                      </div>\n                      <span>{layoutMode === 'sidebar' ? 'Horizontal Layout' : 'Sidebar Layout'}</span>\n                    </button>\n                  </div>\n                )}\n\n                {/* Logout */}\n                <div className=\"border-t border-slate-200/50 dark:border-slate-700/50 pt-2\">\n                  <button\n                    onClick={handleLogout}\n                    className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-500/10 transition-colors group\"\n                  >\n                    <div className=\"p-1.5 rounded-lg bg-red-50 dark:bg-red-500/10 group-hover:bg-red-100 dark:group-hover:bg-red-500/20 transition-colors\">\n                      <LogOut size={16} />\n                    </div>\n                    <span>Logout</span>\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5796, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/AdminLayout.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/AdminLayout.tsx\n// Description: Admin Layout - Main layout wrapper with sidebar/horizontal toggle\n//              Using xl breakpoint (1280px) for desktop, below uses mobile menu\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Sidebar } from './Sidebar';\nimport { Header } from './Header';\nimport { HorizontalNav } from './HorizontalNav';\nimport { MobileMenu } from './MobileMenu';\n\ntype LayoutMode = 'sidebar' | 'horizontal';\n\ninterface AdminLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function AdminLayout({ children }: AdminLayoutProps) {\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [layoutMode, setLayoutMode] = useState<LayoutMode>('sidebar');\n\n  // Load layout preference from localStorage\n  useEffect(() => {\n    const savedMode = localStorage.getItem('layoutMode') as LayoutMode;\n    if (savedMode && (savedMode === 'sidebar' || savedMode === 'horizontal')) {\n      setLayoutMode(savedMode);\n    }\n  }, []);\n\n  // Save layout preference to localStorage\n  const handleLayoutModeChange = (mode: LayoutMode) => {\n    setLayoutMode(mode);\n    localStorage.setItem('layoutMode', mode);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-cyan-50/30 dark:from-slate-950 dark:via-blue-950/20 dark:to-slate-900\">\n      {/* Background Decorations */}\n      <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl\" />\n        <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl\" />\n        <div className=\"absolute top-1/2 left-1/2 w-96 h-96 bg-indigo-500/5 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2\" />\n      </div>\n\n      {/* Sidebar - Desktop only (xl: 1280px+) in sidebar mode */}\n      {layoutMode === 'sidebar' && (\n        <div className=\"hidden xl:block\">\n          <Sidebar\n            collapsed={sidebarCollapsed}\n            onToggle={() => setSidebarCollapsed(!sidebarCollapsed)}\n          />\n        </div>\n      )}\n\n      {/* Mobile Menu - Shows on tablet and mobile (below xl) */}\n      <MobileMenu\n        isOpen={mobileMenuOpen}\n        onClose={() => setMobileMenuOpen(false)}\n      />\n\n      {/* Main Content Area */}\n      <div\n        className={`\n          relative z-10\n          transition-all duration-300 ease-in-out\n          ${layoutMode === 'sidebar' \n            ? (sidebarCollapsed ? 'xl:ml-20' : 'xl:ml-64')\n            : 'xl:ml-0'\n          }\n        `}\n      >\n        {/* Header */}\n        <Header \n          onMenuClick={() => setMobileMenuOpen(true)} \n          layoutMode={layoutMode}\n          onLayoutModeChange={handleLayoutModeChange}\n        />\n\n        {/* Horizontal Navigation - Desktop (xl+) in horizontal mode */}\n        {layoutMode === 'horizontal' && (\n          <div className=\"hidden xl:block sticky top-16 z-20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-slate-200/50 dark:border-slate-800/50\">\n            <div className=\"px-4 py-2\">\n              <HorizontalNav />\n            </div>\n          </div>\n        )}\n\n        {/* Page Content */}\n        <main className=\"p-4 xl:p-6\">\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,8CAA8C;AAC9C,iFAAiF;AACjF,gFAAgF;AAChF,gFAAgF;;;;;;AAIhF;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAcO,SAAS,YAAY,EAAE,QAAQ,EAAoB;;IACxD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,uLAAQ,EAAC;IACzD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,uLAAQ,EAAC;IACrD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uLAAQ,EAAa;IAEzD,2CAA2C;IAC3C,IAAA,wLAAS;iCAAC;YACR,MAAM,YAAY,aAAa,OAAO,CAAC;YACvC,IAAI,aAAa,CAAC,cAAc,aAAa,cAAc,YAAY,GAAG;gBACxE,cAAc;YAChB;QACF;gCAAG,EAAE;IAEL,yCAAyC;IACzC,MAAM,yBAAyB,CAAC;QAC9B,cAAc;QACd,aAAa,OAAO,CAAC,cAAc;IACrC;IAEA,qBACE,2MAAC;QAAI,WAAU;;0BAEb,2MAAC;gBAAI,WAAU;;kCACb,2MAAC;wBAAI,WAAU;;;;;;kCACf,2MAAC;wBAAI,WAAU;;;;;;kCACf,2MAAC;wBAAI,WAAU;;;;;;;;;;;;YAIhB,eAAe,2BACd,2MAAC;gBAAI,WAAU;0BACb,cAAA,2MAAC,mKAAO;oBACN,WAAW;oBACX,UAAU,IAAM,oBAAoB,CAAC;;;;;;;;;;;0BAM3C,2MAAC,yKAAU;gBACT,QAAQ;gBACR,SAAS,IAAM,kBAAkB;;;;;;0BAInC,2MAAC;gBACC,WAAW,CAAC;;;UAGV,EAAE,eAAe,YACZ,mBAAmB,aAAa,aACjC,UACH;QACH,CAAC;;kCAGD,2MAAC,iKAAM;wBACL,aAAa,IAAM,kBAAkB;wBACrC,YAAY;wBACZ,oBAAoB;;;;;;oBAIrB,eAAe,8BACd,2MAAC;wBAAI,WAAU;kCACb,cAAA,2MAAC;4BAAI,WAAU;sCACb,cAAA,2MAAC,+KAAa;;;;;;;;;;;;;;;kCAMpB,2MAAC;wBAAK,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAKX;GA9EgB;KAAA"}},
    {"offset": {"line": 5961, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/index.ts"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/index.ts\n// Description: Export all layout components\n// =============================================================================\n\nexport * from './Sidebar';\nexport * from './HorizontalNav';\nexport * from './MobileMenu';\nexport * from './AdminLayout';\nexport * from './Header';"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,uCAAuC;AACvC,4CAA4C;AAC5C,gFAAgF;;AAEhF;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 5983, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/confirm-dialog/ConfirmDialog.tsx"],"sourcesContent":["// =============================================================================\n// File: components/ui/confirm-dialog/ConfirmDialog.tsx\n// Description: Reusable confirmation dialog component\n// =============================================================================\n\n'use client';\n\nimport { useEffect, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport {\n  AlertTriangle,\n  Trash2,\n  Info,\n  CheckCircle,\n  X,\n  Loader2,\n} from 'lucide-react';\nimport { type ConfirmDialogProps, type ConfirmDialogVariant } from './types';\nimport { cn } from '@/lib/utils';\n\nconst variantConfig: Record<\n  ConfirmDialogVariant,\n  {\n    icon: typeof AlertTriangle;\n    iconBg: string;\n    iconColor: string;\n    headerBg: string;\n    buttonBg: string;\n    buttonHover: string;\n  }\n> = {\n  danger: {\n    icon: Trash2,\n    iconBg: 'bg-red-100 dark:bg-red-500/20',\n    iconColor: 'text-red-600 dark:text-red-400',\n    headerBg: 'bg-red-50 dark:bg-red-500/10',\n    buttonBg: 'bg-red-500',\n    buttonHover: 'hover:bg-red-600',\n  },\n  warning: {\n    icon: AlertTriangle,\n    iconBg: 'bg-amber-100 dark:bg-amber-500/20',\n    iconColor: 'text-amber-600 dark:text-amber-400',\n    headerBg: 'bg-amber-50 dark:bg-amber-500/10',\n    buttonBg: 'bg-amber-500',\n    buttonHover: 'hover:bg-amber-600',\n  },\n  info: {\n    icon: Info,\n    iconBg: 'bg-blue-100 dark:bg-blue-500/20',\n    iconColor: 'text-blue-600 dark:text-blue-400',\n    headerBg: 'bg-blue-50 dark:bg-blue-500/10',\n    buttonBg: 'bg-blue-500',\n    buttonHover: 'hover:bg-blue-600',\n  },\n  success: {\n    icon: CheckCircle,\n    iconBg: 'bg-green-100 dark:bg-green-500/20',\n    iconColor: 'text-green-600 dark:text-green-400',\n    headerBg: 'bg-green-50 dark:bg-green-500/10',\n    buttonBg: 'bg-green-500',\n    buttonHover: 'hover:bg-green-600',\n  },\n};\n\nexport function ConfirmDialog({\n  open,\n  onClose,\n  onConfirm,\n  title,\n  message,\n  variant = 'danger',\n  icon: CustomIcon,\n  confirmText,\n  cancelText = 'ยกเลิก',\n  loading = false,\n  disabled = false,\n  children,\n}: ConfirmDialogProps) {\n  const config = variantConfig[variant];\n  const Icon = CustomIcon || config.icon;\n\n  // Default confirm text based on variant\n  const defaultConfirmText = {\n    danger: 'ลบ',\n    warning: 'ยืนยัน',\n    info: 'ตกลง',\n    success: 'ยืนยัน',\n  };\n\n  const finalConfirmText = confirmText || defaultConfirmText[variant];\n\n  // Close on Escape key\n  useEffect(() => {\n    if (!open) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && !loading) {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [open, onClose, loading]);\n\n  // Prevent body scroll when open\n  useEffect(() => {\n    if (open) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [open]);\n\n  const handleConfirm = useCallback(async () => {\n    if (loading || disabled) return;\n    await onConfirm();\n  }, [onConfirm, loading, disabled]);\n\n  if (!open) return null;\n\n  const dialogContent = (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\n      {/* Backdrop */}\n      <div\n        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm animate-in fade-in-0 duration-200\"\n        onClick={loading ? undefined : onClose}\n      />\n\n      {/* Dialog */}\n      <div\n        role=\"alertdialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"confirm-dialog-title\"\n        aria-describedby=\"confirm-dialog-description\"\n        className={cn(\n          'relative w-full max-w-md',\n          'bg-white dark:bg-slate-800',\n          'rounded-2xl shadow-2xl overflow-hidden',\n          'animate-in fade-in-0 zoom-in-95 duration-200'\n        )}\n      >\n        {/* Header */}\n        <div className={cn('p-6', config.headerBg)}>\n          <div className=\"flex items-start gap-4\">\n            <div\n              className={cn(\n                'w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0',\n                config.iconBg\n              )}\n            >\n              <Icon className={cn('w-6 h-6', config.iconColor)} />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <h3\n                id=\"confirm-dialog-title\"\n                className=\"text-lg font-bold text-slate-900 dark:text-white\"\n              >\n                {title}\n              </h3>\n              {message && (\n                <p\n                  id=\"confirm-dialog-description\"\n                  className=\"text-sm text-slate-600 dark:text-slate-300 mt-1\"\n                >\n                  {message}\n                </p>\n              )}\n            </div>\n            {/* Close button */}\n            {!loading && (\n              <button\n                onClick={onClose}\n                className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Custom content */}\n        {children && (\n          <div className=\"px-6 py-4 border-t border-slate-200 dark:border-slate-700\">\n            {children}\n          </div>\n        )}\n\n        {/* Actions */}\n        <div className=\"p-4 flex gap-3 bg-slate-50 dark:bg-slate-900/50\">\n          <button\n            onClick={onClose}\n            disabled={loading}\n            className={cn(\n              'flex-1 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors',\n              'bg-white dark:bg-slate-700',\n              'text-slate-700 dark:text-slate-200',\n              'border border-slate-200 dark:border-slate-600',\n              'hover:bg-slate-100 dark:hover:bg-slate-600',\n              'disabled:opacity-50 disabled:cursor-not-allowed'\n            )}\n          >\n            {cancelText}\n          </button>\n          <button\n            onClick={handleConfirm}\n            disabled={loading || disabled}\n            className={cn(\n              'flex-1 px-4 py-2.5 rounded-xl text-sm font-medium text-white transition-colors',\n              'flex items-center justify-center gap-2',\n              config.buttonBg,\n              config.buttonHover,\n              'disabled:opacity-50 disabled:cursor-not-allowed'\n            )}\n          >\n            {loading ? (\n              <>\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n                กำลังดำเนินการ...\n              </>\n            ) : (\n              <>\n                <Icon className=\"w-4 h-4\" />\n                {finalConfirmText}\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n\n  // Render in portal\n  if (typeof window === 'undefined') return null;\n  return createPortal(dialogContent, document.body);\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6280, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/confirm-dialog/useConfirmDialog.ts"],"sourcesContent":["// =============================================================================\n// File: components/ui/confirm-dialog/useConfirmDialog.ts\n// Description: Custom hook for managing confirm dialog state\n// =============================================================================\n\n'use client';\n\nimport { useState, useCallback } from 'react';\nimport { type UseConfirmDialogOptions, type UseConfirmDialogReturn } from './types';\n\nexport function useConfirmDialog<T = any>(\n  options: UseConfirmDialogOptions<T> = {}\n): UseConfirmDialogReturn<T> {\n  const [isOpen, setIsOpen] = useState(false);\n  const [data, setData] = useState<T | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  const open = useCallback((itemData?: T) => {\n    setData(itemData ?? null);\n    setIsOpen(true);\n  }, []);\n\n  const close = useCallback(() => {\n    if (loading) return; // Prevent closing while loading\n    setIsOpen(false);\n    // Keep data briefly for close animation\n    setTimeout(() => setData(null), 200);\n    options.onClose?.();\n  }, [loading, options]);\n\n  const confirm = useCallback(async () => {\n    if (loading || !data) return;\n\n    try {\n      setLoading(true);\n      await options.onConfirm?.(data);\n      setIsOpen(false);\n      setTimeout(() => setData(null), 200);\n    } catch (error) {\n      console.error('Confirm action failed:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  }, [data, loading, options]);\n\n  return {\n    isOpen,\n    data,\n    loading,\n    open,\n    close,\n    confirm,\n    dialogProps: {\n      open: isOpen,\n      onClose: close,\n      onConfirm: confirm,\n      loading,\n    },\n  };\n}"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,yDAAyD;AACzD,6DAA6D;AAC7D,gFAAgF;;;;;AAIhF;;AAFA;;AAKO,SAAS,iBACd,UAAsC,CAAC,CAAC;;IAExC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,uLAAQ,EAAC;IACrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,uLAAQ,EAAW;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uLAAQ,EAAC;IAEvC,MAAM,OAAO,IAAA,0LAAW;8CAAC,CAAC;YACxB,QAAQ,YAAY;YACpB,UAAU;QACZ;6CAAG,EAAE;IAEL,MAAM,QAAQ,IAAA,0LAAW;+CAAC;YACxB,IAAI,SAAS,QAAQ,gCAAgC;YACrD,UAAU;YACV,wCAAwC;YACxC;uDAAW,IAAM,QAAQ;sDAAO;YAChC,QAAQ,OAAO;QACjB;8CAAG;QAAC;QAAS;KAAQ;IAErB,MAAM,UAAU,IAAA,0LAAW;iDAAC;YAC1B,IAAI,WAAW,CAAC,MAAM;YAEtB,IAAI;gBACF,WAAW;gBACX,MAAM,QAAQ,SAAS,GAAG;gBAC1B,UAAU;gBACV;6DAAW,IAAM,QAAQ;4DAAO;YAClC,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,0BAA0B;gBACxC,MAAM;YACR,SAAU;gBACR,WAAW;YACb;QACF;gDAAG;QAAC;QAAM;QAAS;KAAQ;IAE3B,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA,aAAa;YACX,MAAM;YACN,SAAS;YACT,WAAW;YACX;QACF;IACF;AACF;GAlDgB"}},
    {"offset": {"line": 6362, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/confirm-dialog/index.ts"],"sourcesContent":["// =============================================================================\n// File: components/ui/confirm-dialog/index.ts\n// Description: Export all ConfirmDialog components\n// =============================================================================\n\nexport { ConfirmDialog } from './ConfirmDialog';\nexport { useConfirmDialog } from './useConfirmDialog';\n\nexport type {\n  ConfirmDialogProps,\n  ConfirmDialogVariant,\n  UseConfirmDialogOptions,\n  UseConfirmDialogReturn,\n} from './types';"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,8CAA8C;AAC9C,mDAAmD;AACnD,gFAAgF;;AAEhF;AACA"}},
    {"offset": {"line": 6378, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/CustomSelect.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/ui/CustomSelect.tsx\n// Description: Modern Custom Select with Inline Search (Combobox Style)\n// =============================================================================\n\n'use client';\n\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport { ChevronDown, Check, Search, X, Loader2 } from 'lucide-react';\n\ninterface Option {\n  value: string;\n  label: string;\n  disabled?: boolean;\n  icon?: React.ReactNode;\n  description?: string;\n}\n\ninterface CustomSelectProps {\n  options: string[] | Option[];\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  theme?: 'primary' | 'gray' | 'success' | 'danger';\n  disabled?: boolean;\n  className?: string;\n  label?: string;\n  error?: string;\n  searchable?: boolean;\n  searchPlaceholder?: string;\n  maxHeight?: number;\n  size?: 'sm' | 'md' | 'lg';\n  clearable?: boolean;\n  usePortal?: boolean;\n  showBackdrop?: boolean;\n  dropdownTitle?: string;\n  loading?: boolean;\n  /** เปิดให้พิมพ์ค้นหาได้ในช่อง input โดยตรง */\n  typeToSearch?: boolean;\n}\n\n// ============================================\n// Dropdown Portal Component\n// ============================================\ninterface DropdownPortalProps {\n  children: React.ReactNode;\n  targetRef: React.RefObject<HTMLElement | null>;\n  inputRef: React.RefObject<HTMLElement | null>;\n  isOpen: boolean;\n  openUp: boolean;\n  maxHeight: number;\n  showBackdrop?: boolean;\n  onBackdropClick?: () => void;\n  floatingInput?: React.ReactNode;\n}\n\nconst DropdownPortal: React.FC<DropdownPortalProps> = ({\n  children,\n  targetRef,\n  inputRef,\n  isOpen,\n  openUp,\n  maxHeight,\n  showBackdrop = false,\n  onBackdropClick,\n  floatingInput,\n}) => {\n  const [position, setPosition] = useState({ top: 0, left: 0, width: 0 });\n  const [inputPosition, setInputPosition] = useState({ top: 0, left: 0, width: 0, height: 0 });\n\n  useEffect(() => {\n    if (!isOpen || !targetRef.current) return;\n\n    const updatePosition = () => {\n      const rect = targetRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      setPosition({\n        top: openUp ? rect.top - maxHeight - 8 : rect.bottom + 8,\n        left: rect.left,\n        width: rect.width,\n      });\n\n      // Update input position for floating input\n      if (inputRef.current && showBackdrop) {\n        const inputRect = inputRef.current.getBoundingClientRect();\n        setInputPosition({\n          top: inputRect.top,\n          left: inputRect.left,\n          width: inputRect.width,\n          height: inputRect.height,\n        });\n      }\n    };\n\n    updatePosition();\n\n    window.addEventListener('scroll', updatePosition, true);\n    window.addEventListener('resize', updatePosition);\n\n    return () => {\n      window.removeEventListener('scroll', updatePosition, true);\n      window.removeEventListener('resize', updatePosition);\n    };\n  }, [isOpen, targetRef, inputRef, openUp, maxHeight, showBackdrop]);\n\n  if (!isOpen || typeof window === 'undefined') return null;\n\n  return createPortal(\n    <>\n      {/* Backdrop */}\n      {showBackdrop && (\n        <div\n          className=\"fixed inset-0 bg-black/20 dark:bg-black/40 backdrop-blur-sm z-[9998] animate-in fade-in-0 duration-200\"\n          aria-hidden=\"true\"\n          onClick={onBackdropClick}\n        />\n      )}\n\n      {/* Floating Input (above backdrop) */}\n      {showBackdrop && floatingInput && (\n        <div\n          style={{\n            position: 'fixed',\n            top: inputPosition.top,\n            left: inputPosition.left,\n            width: inputPosition.width,\n            height: inputPosition.height,\n            zIndex: 9999,\n          }}\n        >\n          {floatingInput}\n        </div>\n      )}\n\n      {/* Dropdown */}\n      <div\n        style={{\n          position: 'fixed',\n          top: position.top,\n          left: position.left,\n          width: position.width,\n          zIndex: 9999,\n        }}\n      >\n        {children}\n      </div>\n    </>,\n    document.body\n  );\n};\n\n// ============================================\n// Main CustomSelect Component\n// ============================================\nconst CustomSelect: React.FC<CustomSelectProps> = ({\n  options,\n  value,\n  onChange,\n  placeholder = 'เลือก...',\n  theme: colorTheme = 'primary',\n  disabled = false,\n  className = '',\n  label,\n  error,\n  searchable = false,\n  searchPlaceholder = 'พิมพ์เพื่อค้นหา...',\n  maxHeight = 320,\n  size = 'md',\n  clearable = false,\n  usePortal = true,\n  showBackdrop = false,\n  dropdownTitle,\n  loading = false,\n  typeToSearch = true,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [openUp, setOpenUp] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\n  const [isTyping, setIsTyping] = useState(false);\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const inputContainerRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const floatingInputRef = useRef<HTMLInputElement>(null);\n  const optionsRef = useRef<HTMLDivElement>(null);\n\n  // Normalize options\n  const normalizedOptions: Option[] = options.map((option, index) =>\n    typeof option === 'string'\n      ? { value: option, label: option }\n      : { ...option, value: option.value || `option-${index}` }\n  );\n\n  // Filter options\n  const filteredOptions = searchQuery\n    ? normalizedOptions.filter((opt) =>\n        opt.label.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        opt.value.toLowerCase().includes(searchQuery.toLowerCase())\n      )\n    : normalizedOptions;\n\n  const currentOption = normalizedOptions.find((o) => o.value === value);\n  const displayValue = currentOption?.label || '';\n\n  // Calculate dropdown direction\n  const calculateDirection = useCallback(() => {\n    if (!containerRef.current) return false;\n    const rect = containerRef.current.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const spaceBelow = viewportHeight - rect.bottom;\n    const spaceAbove = rect.top;\n    return spaceBelow < maxHeight + 20 && spaceAbove > maxHeight + 20;\n  }, [maxHeight]);\n\n  // Handle click outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n\n      if (usePortal) {\n        const portalDropdown = document.querySelector('[data-select-dropdown]');\n        const isOutsideContainer = containerRef.current && !containerRef.current.contains(target);\n        const isOutsidePortal = !portalDropdown?.contains(target);\n\n        if (isOutsideContainer && isOutsidePortal) {\n          closeDropdown();\n        }\n      } else if (containerRef.current && !containerRef.current.contains(target)) {\n        closeDropdown();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [usePortal]);\n\n  // Keyboard navigation\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setHighlightedIndex((prev) =>\n            prev < filteredOptions.length - 1 ? prev + 1 : 0\n          );\n          break;\n        case 'ArrowUp':\n          e.preventDefault();\n          setHighlightedIndex((prev) =>\n            prev > 0 ? prev - 1 : filteredOptions.length - 1\n          );\n          break;\n        case 'Enter':\n          e.preventDefault();\n          if (highlightedIndex >= 0 && filteredOptions[highlightedIndex]) {\n            handleSelect(filteredOptions[highlightedIndex].value);\n          }\n          break;\n        case 'Escape':\n          e.preventDefault();\n          closeDropdown();\n          break;\n        case 'Tab':\n          closeDropdown();\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, highlightedIndex, filteredOptions]);\n\n  // Reset highlighted on search\n  useEffect(() => {\n    if (searchQuery) {\n      setHighlightedIndex(filteredOptions.length > 0 ? 0 : -1);\n    } else {\n      const currentIndex = filteredOptions.findIndex((o) => o.value === value);\n      setHighlightedIndex(currentIndex);\n    }\n  }, [searchQuery, filteredOptions, value]);\n\n  // Scroll highlighted into view\n  useEffect(() => {\n    if (highlightedIndex >= 0 && optionsRef.current) {\n      const option = optionsRef.current.children[highlightedIndex] as HTMLElement;\n      option?.scrollIntoView({ block: 'nearest' });\n    }\n  }, [highlightedIndex]);\n\n  // Focus input when opened\n  useEffect(() => {\n    if (isOpen && typeToSearch) {\n      // Small delay to ensure portal is rendered\n      setTimeout(() => {\n        if (showBackdrop && floatingInputRef.current) {\n          floatingInputRef.current.focus();\n        } else if (inputRef.current) {\n          inputRef.current.focus();\n        }\n      }, 50);\n    }\n  }, [isOpen, typeToSearch, showBackdrop]);\n\n  const openDropdown = () => {\n    if (disabled || loading) return;\n    setOpenUp(calculateDirection());\n    setIsOpen(true);\n    setIsTyping(false);\n    const currentIndex = normalizedOptions.findIndex((o) => o.value === value);\n    setHighlightedIndex(currentIndex);\n  };\n\n  const closeDropdown = () => {\n    setIsOpen(false);\n    setSearchQuery('');\n    setIsTyping(false);\n    setHighlightedIndex(-1);\n  };\n\n  const handleSelect = (optionValue: string) => {\n    onChange(optionValue);\n    closeDropdown();\n  };\n\n  const handleClear = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onChange('');\n    setSearchQuery('');\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const val = e.target.value;\n    setSearchQuery(val);\n    setIsTyping(val.length > 0);\n    if (!isOpen) {\n      openDropdown();\n    }\n  };\n\n  const handleInputFocus = () => {\n    if (!isOpen) {\n      openDropdown();\n    }\n  };\n\n  const handleInputClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (!isOpen) {\n      openDropdown();\n    }\n  };\n\n  // Theme styles\n  const themeStyles = {\n    primary: {\n      ring: 'ring-primary-500/30',\n      border: 'border-primary-500',\n      selected: 'bg-primary-50 dark:bg-primary-500/15 text-primary-700 dark:text-primary-300',\n      hover: 'hover:bg-primary-50/50 dark:hover:bg-primary-500/10',\n      highlighted: 'bg-primary-100/70 dark:bg-primary-500/20',\n      check: 'text-primary-500',\n      indicator: 'bg-primary-500',\n    },\n    gray: {\n      ring: 'ring-slate-400/30',\n      border: 'border-slate-400',\n      selected: 'bg-slate-100 dark:bg-slate-600/20 text-slate-700 dark:text-slate-200',\n      hover: 'hover:bg-slate-50 dark:hover:bg-slate-700/50',\n      highlighted: 'bg-slate-100 dark:bg-slate-700/70',\n      check: 'text-slate-600 dark:text-slate-400',\n      indicator: 'bg-slate-500',\n    },\n    success: {\n      ring: 'ring-emerald-500/30',\n      border: 'border-emerald-500',\n      selected: 'bg-emerald-50 dark:bg-emerald-500/15 text-emerald-700 dark:text-emerald-300',\n      hover: 'hover:bg-emerald-50/50 dark:hover:bg-emerald-500/10',\n      highlighted: 'bg-emerald-100/70 dark:bg-emerald-500/20',\n      check: 'text-emerald-500',\n      indicator: 'bg-emerald-500',\n    },\n    danger: {\n      ring: 'ring-red-500/30',\n      border: 'border-red-500',\n      selected: 'bg-red-50 dark:bg-red-500/15 text-red-700 dark:text-red-300',\n      hover: 'hover:bg-red-50/50 dark:hover:bg-red-500/10',\n      highlighted: 'bg-red-100/70 dark:bg-red-500/20',\n      check: 'text-red-500',\n      indicator: 'bg-red-500',\n    },\n  };\n\n  const colors = themeStyles[colorTheme];\n\n  // Size classes\n  const sizeClasses = {\n    sm: {\n      container: 'h-9',\n      input: 'text-sm',\n      option: 'px-3 py-2 text-sm',\n      icon: 14,\n    },\n    md: {\n      container: 'h-11',\n      input: 'text-sm',\n      option: 'px-4 py-2.5 text-sm',\n      icon: 16,\n    },\n    lg: {\n      container: 'h-12',\n      input: 'text-base',\n      option: 'px-4 py-3 text-base',\n      icon: 18,\n    },\n  };\n\n  const sizes = sizeClasses[size];\n\n  // Calculate header height for maxHeight\n  const headerHeight = dropdownTitle || label ? 52 : 0;\n  const searchHeight = searchable && !typeToSearch ? 56 : 0;\n  const footerHeight = filteredOptions.length > 5 ? 40 : 0;\n  const optionsMaxHeight = maxHeight - headerHeight - searchHeight - footerHeight;\n\n  // Dropdown content\n  const dropdownContent = (\n    <div\n      data-select-dropdown\n      className=\"\n        w-full overflow-hidden\n        bg-white dark:bg-slate-800\n        border border-slate-200 dark:border-slate-700\n        rounded-xl\n        shadow-xl shadow-slate-900/10 dark:shadow-black/40\n        ring-1 ring-black/5 dark:ring-white/5\n        animate-in fade-in-0 zoom-in-95 slide-in-from-top-2\n        duration-200\n      \"\n    >\n      {/* Header */}\n      {(dropdownTitle || label) && (\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-slate-100 dark:border-slate-700/50 bg-gradient-to-r from-slate-50 to-slate-100/50 dark:from-slate-800 dark:to-slate-800/50\">\n          <div className=\"flex items-center gap-2\">\n            <div className={`size-2 rounded-full ${colors.indicator}`} />\n            <span className=\"font-medium text-sm text-slate-700 dark:text-slate-200\">\n              {dropdownTitle || label}\n            </span>\n            {filteredOptions.length > 0 && (\n              <span className=\"text-xs text-slate-400 dark:text-slate-500 tabular-nums\">\n                ({filteredOptions.length})\n              </span>\n            )}\n          </div>\n          <button\n            type=\"button\"\n            onClick={closeDropdown}\n            className=\"p-1.5 rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-200/70 dark:hover:bg-slate-700/70 transition-colors\"\n          >\n            <X size={16} />\n          </button>\n        </div>\n      )}\n\n      {/* Separate Search (when typeToSearch is false) */}\n      {searchable && !typeToSearch && (\n        <div className=\"p-2 border-b border-slate-100 dark:border-slate-700/50\">\n          <div className=\"relative\">\n            <Search\n              size={16}\n              className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500\"\n            />\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              placeholder={searchPlaceholder}\n              className=\"\n                w-full h-9 pl-9 pr-3\n                text-sm\n                bg-slate-50 dark:bg-slate-900/50\n                border border-slate-200 dark:border-slate-700\n                rounded-lg\n                placeholder:text-slate-400 dark:placeholder:text-slate-500\n                focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500\n                transition-colors\n              \"\n              autoFocus\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Options */}\n      <div\n        ref={optionsRef}\n        className=\"overflow-y-auto overscroll-contain\"\n        style={{ maxHeight: optionsMaxHeight }}\n      >\n        {loading ? (\n          <div className=\"px-4 py-8 text-center\">\n            <Loader2 className=\"size-6 text-primary-500 animate-spin mx-auto mb-2\" />\n            <div className=\"text-slate-400 dark:text-slate-500 text-sm\">กำลังโหลด...</div>\n          </div>\n        ) : filteredOptions.length === 0 ? (\n          <div className=\"px-4 py-8 text-center\">\n            <div className=\"text-slate-400 dark:text-slate-500 text-sm\">\n              {searchQuery ? (\n                <div className=\"space-y-2\">\n                  <Search size={28} className=\"mx-auto opacity-40\" />\n                  <div>\n                    ไม่พบ \"<span className=\"font-medium text-slate-600 dark:text-slate-300\">{searchQuery}</span>\"\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={() => setSearchQuery('')}\n                    className=\"text-xs text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\"\n                  >\n                    ล้างการค้นหา\n                  </button>\n                </div>\n              ) : (\n                'ไม่มีตัวเลือก'\n              )}\n            </div>\n          </div>\n        ) : (\n          <div className=\"py-1\">\n            {filteredOptions.map((option, index) => {\n              const isSelected = value === option.value;\n              const isHighlighted = highlightedIndex === index;\n\n              return (\n                <button\n                  key={`${option.value}-${index}`}\n                  type=\"button\"\n                  disabled={option.disabled}\n                  onClick={() => handleSelect(option.value)}\n                  onMouseEnter={() => setHighlightedIndex(index)}\n                  className={`\n                    relative w-full text-left transition-all duration-100\n                    flex items-center gap-3\n                    ${sizes.option}\n                    ${option.disabled ? 'opacity-40 cursor-not-allowed' : 'cursor-pointer'}\n                    ${isSelected ? colors.selected : 'text-slate-700 dark:text-slate-200'}\n                    ${isHighlighted && !isSelected ? colors.highlighted : ''}\n                    ${!isHighlighted && !isSelected ? colors.hover : ''}\n                  `}\n                >\n                  {/* Selected indicator bar */}\n                  {isSelected && (\n                    <span className={`absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 rounded-r-full ${colors.indicator}`} />\n                  )}\n\n                  {/* Icon */}\n                  {option.icon && (\n                    <span className=\"shrink-0 text-slate-400 dark:text-slate-500\">\n                      {option.icon}\n                    </span>\n                  )}\n\n                  {/* Label & Description */}\n                  <span className=\"flex-1 min-w-0\">\n                    <span className={`block truncate ${isSelected ? 'font-medium' : ''}`}>\n                      {/* Highlight matching text */}\n                      {searchQuery ? (\n                        <HighlightText text={option.label} query={searchQuery} />\n                      ) : (\n                        option.label\n                      )}\n                    </span>\n                    {option.description && (\n                      <span className=\"block text-xs text-slate-400 dark:text-slate-500 truncate mt-0.5\">\n                        {option.description}\n                      </span>\n                    )}\n                  </span>\n\n                  {/* Check icon */}\n                  {isSelected && (\n                    <span className={`shrink-0 ${colors.check}`}>\n                      <Check size={sizes.icon} strokeWidth={2.5} />\n                    </span>\n                  )}\n                </button>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Footer hint */}\n      {filteredOptions.length > 5 && (\n        <div className=\"px-3 py-2 border-t border-slate-100 dark:border-slate-700/50 bg-slate-50/50 dark:bg-slate-900/30\">\n          <p className=\"text-xs text-slate-400 dark:text-slate-500 text-center\">\n            ↑↓ เลื่อน • Enter เลือก • Esc ปิด\n          </p>\n        </div>\n      )}\n    </div>\n  );\n\n  return (\n    <div \n      className={`\n        relative \n        ${isOpen && showBackdrop ? 'z-[9999]' : ''} \n        ${className}\n      `} \n      ref={containerRef}\n    >\n      {/* Label */}\n      {label && (\n        <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5\">\n          {label}\n        </label>\n      )}\n\n      {/* Input Container */}\n      <div\n        ref={inputContainerRef}\n        onClick={openDropdown}\n        className={`\n          group relative w-full rounded-xl\n          flex items-center gap-2 px-4\n          ${sizes.container}\n          border transition-all duration-200 cursor-pointer\n          ${isOpen && showBackdrop ? 'invisible' : ''}\n          ${disabled || loading\n            ? 'opacity-50 cursor-not-allowed bg-slate-100 dark:bg-slate-800'\n            : ''\n          }\n          ${error\n            ? 'border-red-300 dark:border-red-500/50 bg-red-50/30 dark:bg-red-500/5'\n            : isOpen\n              ? `ring-2 ${colors.ring} ${colors.border} bg-white dark:bg-slate-800 shadow-lg`\n              : 'border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:border-slate-300 dark:hover:border-slate-600 hover:shadow-sm'\n          }\n        `}\n      >\n        {/* Search Icon (when typing) */}\n        {typeToSearch && isTyping && (\n          <Search size={16} className=\"shrink-0 text-slate-400 dark:text-slate-500\" />\n        )}\n\n        {/* Input Field */}\n        {typeToSearch ? (\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={isTyping || isOpen ? searchQuery : displayValue}\n            onChange={handleInputChange}\n            onFocus={handleInputFocus}\n            onClick={handleInputClick}\n            placeholder={isOpen ? searchPlaceholder : placeholder}\n            disabled={disabled || loading}\n            className={`\n              flex-1 min-w-0 bg-transparent outline-none\n              ${sizes.input}\n              ${displayValue && !isTyping && !isOpen\n                ? 'text-slate-900 dark:text-slate-100'\n                : 'text-slate-900 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500'\n              }\n              ${disabled || loading ? 'cursor-not-allowed' : 'cursor-text'}\n            `}\n            autoComplete=\"off\"\n            spellCheck={false}\n          />\n        ) : (\n          <span\n            className={`\n              flex-1 truncate ${sizes.input}\n              ${displayValue ? 'text-slate-900 dark:text-slate-100' : 'text-slate-400 dark:text-slate-500'}\n            `}\n          >\n            {displayValue || placeholder}\n          </span>\n        )}\n\n        {/* Actions */}\n        <div className=\"flex items-center gap-1 shrink-0\">\n          {/* Loading */}\n          {loading && (\n            <Loader2 size={16} className=\"text-slate-400 animate-spin\" />\n          )}\n\n          {/* Clear button */}\n          {clearable && value && !disabled && !loading && (\n            <button\n              type=\"button\"\n              onClick={handleClear}\n              className=\"p-1 rounded-md text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors\"\n            >\n              <X size={14} />\n            </button>\n          )}\n\n          {/* Chevron */}\n          {!loading && (\n            <span\n              className={`\n                text-slate-400 dark:text-slate-500 transition-transform duration-200\n                ${isOpen ? 'rotate-180' : ''}\n              `}\n            >\n              <ChevronDown size={sizes.icon} />\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Error message */}\n      {error && (\n        <p className=\"mt-1.5 text-xs text-red-500 dark:text-red-400 flex items-center gap-1\">\n          <span className=\"size-1 rounded-full bg-red-500\" />\n          {error}\n        </p>\n      )}\n\n      {/* Dropdown */}\n      {usePortal ? (\n        <DropdownPortal\n          targetRef={containerRef}\n          inputRef={inputContainerRef}\n          isOpen={isOpen}\n          openUp={openUp}\n          maxHeight={maxHeight}\n          showBackdrop={showBackdrop}\n          onBackdropClick={closeDropdown}\n          floatingInput={\n            <div\n              className={`\n                w-full rounded-xl\n                flex items-center gap-2 px-4\n                ${sizes.container}\n                border transition-all duration-200\n                ring-2 ${colors.ring} ${colors.border} \n                bg-white dark:bg-slate-800 shadow-xl\n              `}\n            >\n              {/* Search Icon (when typing) */}\n              {typeToSearch && isTyping && (\n                <Search size={16} className=\"shrink-0 text-slate-400 dark:text-slate-500\" />\n              )}\n\n              {/* Input Field */}\n              {typeToSearch ? (\n                <input\n                  ref={floatingInputRef}\n                  type=\"text\"\n                  value={isTyping || isOpen ? searchQuery : displayValue}\n                  onChange={handleInputChange}\n                  onClick={handleInputClick}\n                  placeholder={isOpen ? searchPlaceholder : placeholder}\n                  disabled={disabled || loading}\n                  className={`\n                    flex-1 min-w-0 bg-transparent outline-none\n                    ${sizes.input}\n                    text-slate-900 dark:text-slate-100 \n                    placeholder:text-slate-400 dark:placeholder:text-slate-500\n                  `}\n                  autoComplete=\"off\"\n                  spellCheck={false}\n                />\n              ) : (\n                <span\n                  className={`\n                    flex-1 truncate ${sizes.input}\n                    ${displayValue ? 'text-slate-900 dark:text-slate-100' : 'text-slate-400 dark:text-slate-500'}\n                  `}\n                >\n                  {displayValue || placeholder}\n                </span>\n              )}\n\n              {/* Actions */}\n              <div className=\"flex items-center gap-1 shrink-0\">\n                {loading && (\n                  <Loader2 size={16} className=\"text-slate-400 animate-spin\" />\n                )}\n                {clearable && value && !disabled && !loading && (\n                  <button\n                    type=\"button\"\n                    onClick={handleClear}\n                    className=\"p-1 rounded-md text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors\"\n                  >\n                    <X size={14} />\n                  </button>\n                )}\n                {!loading && (\n                  <span className=\"text-slate-400 dark:text-slate-500 rotate-180\">\n                    <ChevronDown size={sizes.icon} />\n                  </span>\n                )}\n              </div>\n            </div>\n          }\n        >\n          {dropdownContent}\n        </DropdownPortal>\n      ) : (\n        isOpen && (\n          <div className={`absolute z-50 w-full ${openUp ? 'bottom-full mb-2' : 'top-full mt-2'}`}>\n            {dropdownContent}\n          </div>\n        )\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// Highlight Text Component\n// ============================================\nconst HighlightText: React.FC<{ text: string; query: string }> = ({ text, query }) => {\n  if (!query) return <>{text}</>;\n\n  const parts = text.split(new RegExp(`(${query})`, 'gi'));\n\n  return (\n    <>\n      {parts.map((part, i) =>\n        part.toLowerCase() === query.toLowerCase() ? (\n          <mark\n            key={i}\n            className=\"bg-amber-200/70 dark:bg-amber-500/30 text-inherit rounded px-0.5\"\n          >\n            {part}\n          </mark>\n        ) : (\n          <span key={i}>{part}</span>\n        )\n      )}\n    </>\n  );\n};\n\nexport default CustomSelect;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7393, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/date-picker/DatePicker.tsx"],"sourcesContent":["// =============================================================================\n// File: components/ui/date-picker/DatePicker.tsx\n// Description: DatePicker with Portal support to prevent overflow clipping\n// =============================================================================\n\n'use client';\n\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Calendar, ChevronLeft, ChevronRight, Clock, X } from 'lucide-react';\nimport { cn } from '@/lib/utils';\n\n// ============================================\n// Utility Functions\n// ============================================\n\nconst formatThaiDate = (dateStr: string, includeTime = false): string => {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  if (isNaN(date.getTime())) return '';\n  \n  const day = date.getDate();\n  const monthNames = [\n    'มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน',\n    'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'\n  ];\n  const month = monthNames[date.getMonth()];\n  const year = date.getFullYear() + 543;\n  \n  if (includeTime) {\n    const hours = date.getHours().toString().padStart(2, '0');\n    const minutes = date.getMinutes().toString().padStart(2, '0');\n    return `${day} ${month} ${year} ${hours}:${minutes}`;\n  }\n  \n  return `${day} ${month} ${year}`;\n};\n\nconst formatThaiDateShort = (dateStr: string): string => {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  if (isNaN(date.getTime())) return '';\n  \n  const day = date.getDate();\n  const monthNames = ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.', 'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'];\n  const month = monthNames[date.getMonth()];\n  const year = date.getFullYear() + 543;\n  \n  return `${day} ${month} ${year}`;\n};\n\nconst isFutureDate = (dateStr: string): boolean => {\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const date = new Date(dateStr);\n  date.setHours(0, 0, 0, 0);\n  return date > today;\n};\n\nconst isTodayInBangkok = (dateStr: string): boolean => {\n  const today = new Date().toISOString().split('T')[0];\n  return dateStr === today;\n};\n\n// ============================================\n// Types\n// ============================================\n\nexport interface DatePickerProps {\n  value: string;\n  onChange: (date: string) => void;\n  placeholder?: string;\n  label?: string;\n  error?: string;\n  disabled?: boolean;\n  minDate?: string;\n  maxDate?: string;\n  disablePastDates?: boolean;\n  disableFutureDates?: boolean;\n  enableTime?: boolean;\n  showAge?: boolean;\n  className?: string;\n}\n\n// ============================================\n// DatePicker Component\n// ============================================\n\nconst DatePicker: React.FC<DatePickerProps> = ({\n  value,\n  onChange,\n  placeholder = 'เลือกวันที่',\n  label,\n  error,\n  disabled = false,\n  minDate,\n  maxDate,\n  disablePastDates = false,\n  disableFutureDates = false,\n  enableTime = false,\n  showAge = false,\n  className,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [calendarViewDate, setCalendarViewDate] = useState(() => {\n    if (value) return value.split('T')[0];\n    return new Date().toISOString().split('T')[0];\n  });\n  const [selectedTime, setSelectedTime] = useState({ hours: '08', minutes: '00' });\n  const [position, setPosition] = useState({ top: 0, left: 0, direction: 'bottom' as 'top' | 'bottom' });\n  const [mounted, setMounted] = useState(false);\n  \n  const triggerRef = useRef<HTMLButtonElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Mount check for portal\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // Initialize time from value\n  useEffect(() => {\n    if (enableTime && value && value.includes('T')) {\n      const date = new Date(value);\n      if (!isNaN(date.getTime())) {\n        setSelectedTime({\n          hours: date.getHours().toString().padStart(2, '0'),\n          minutes: date.getMinutes().toString().padStart(2, '0')\n        });\n      }\n    }\n  }, [value, enableTime]);\n\n  // Update calendar view when value changes\n  useEffect(() => {\n    if (value) {\n      setCalendarViewDate(value.split('T')[0]);\n    }\n  }, [value]);\n\n  // Calculate position\n  const updatePosition = useCallback(() => {\n    if (!triggerRef.current) return;\n    \n    const rect = triggerRef.current.getBoundingClientRect();\n    const dropdownHeight = enableTime ? 520 : 420;\n    const dropdownWidth = 320;\n    const padding = 8;\n    \n    const spaceBelow = window.innerHeight - rect.bottom;\n    const spaceAbove = rect.top;\n    \n    let top: number;\n    let direction: 'top' | 'bottom';\n    \n    if (spaceBelow >= dropdownHeight + padding || spaceBelow >= spaceAbove) {\n      top = rect.bottom + padding;\n      direction = 'bottom';\n    } else {\n      top = rect.top - dropdownHeight - padding;\n      direction = 'top';\n    }\n    \n    let left = rect.left;\n    if (left + dropdownWidth > window.innerWidth - padding) {\n      left = window.innerWidth - dropdownWidth - padding;\n    }\n    if (left < padding) {\n      left = padding;\n    }\n    \n    setPosition({ top, left, direction });\n  }, [enableTime]);\n\n  // Update position on open and scroll/resize\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    updatePosition();\n    \n    const handleUpdate = () => updatePosition();\n    window.addEventListener('scroll', handleUpdate, true);\n    window.addEventListener('resize', handleUpdate);\n    \n    return () => {\n      window.removeEventListener('scroll', handleUpdate, true);\n      window.removeEventListener('resize', handleUpdate);\n    };\n  }, [isOpen, updatePosition]);\n\n  // Close on click outside\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    const handleClickOutside = (e: MouseEvent) => {\n      if (\n        dropdownRef.current && !dropdownRef.current.contains(e.target as Node) &&\n        triggerRef.current && !triggerRef.current.contains(e.target as Node)\n      ) {\n        setIsOpen(false);\n      }\n    };\n    \n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') setIsOpen(false);\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    document.addEventListener('keydown', handleEscape);\n    \n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isOpen]);\n\n  // Check if date is disabled\n  const isDateDisabled = (dateStr: string): boolean => {\n    const today = new Date().toISOString().split('T')[0];\n    \n    if (disablePastDates && dateStr < today) return true;\n    if (disableFutureDates && isFutureDate(dateStr)) return true;\n    if (minDate && dateStr < minDate) return true;\n    if (maxDate && dateStr > maxDate) return true;\n    \n    return false;\n  };\n\n  // Generate calendar\n  const generateCalendar = () => {\n    const [year, month] = calendarViewDate.split('-').map(Number);\n    const firstDay = new Date(year, month - 1, 1);\n    const lastDay = new Date(year, month, 0);\n    \n    const startDate = new Date(firstDay);\n    startDate.setDate(startDate.getDate() - firstDay.getDay());\n    \n    const endDate = new Date(lastDay);\n    endDate.setDate(endDate.getDate() + (6 - lastDay.getDay()));\n    \n    const weeks = [];\n    const current = new Date(startDate);\n    \n    while (current <= endDate) {\n      const week = [];\n      for (let i = 0; i < 7; i++) {\n        week.push(new Date(current));\n        current.setDate(current.getDate() + 1);\n      }\n      weeks.push(week);\n    }\n    \n    return { weeks, currentMonth: month - 1, currentYear: year };\n  };\n\n  // Navigate months\n  const navigateMonth = (direction: 'prev' | 'next') => {\n    const [year, month] = calendarViewDate.split('-').map(Number);\n    const date = new Date(year, month - 1, 1);\n    \n    if (direction === 'prev') {\n      date.setMonth(date.getMonth() - 1);\n    } else {\n      date.setMonth(date.getMonth() + 1);\n    }\n    \n    const newDate = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-01`;\n    setCalendarViewDate(newDate);\n  };\n\n  // Select date\n  const selectDate = (date: Date) => {\n    const year = date.getFullYear();\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const day = date.getDate().toString().padStart(2, '0');\n    const dateStr = `${year}-${month}-${day}`;\n    \n    if (isDateDisabled(dateStr)) return;\n    \n    if (enableTime) {\n      const dateTimeStr = `${dateStr}T${selectedTime.hours}:${selectedTime.minutes}:00.000Z`;\n      onChange(dateTimeStr);\n    } else {\n      onChange(dateStr);\n      setIsOpen(false);\n    }\n  };\n\n  // Handle time selection\n  const handleTimeSelect = (hours: string, minutes: string) => {\n    setSelectedTime({ hours, minutes });\n    \n    if (value) {\n      const baseDate = value.split('T')[0];\n      const dateTimeStr = `${baseDate}T${hours}:${minutes}:00.000Z`;\n      onChange(dateTimeStr);\n    }\n  };\n\n  // Calculate age\n  const calculateAge = (birthday: string): string => {\n    if (!birthday) return '';\n    const birthDate = new Date(birthday);\n    const today = new Date();\n    \n    let years = today.getFullYear() - birthDate.getFullYear();\n    let months = today.getMonth() - birthDate.getMonth();\n    \n    if (months < 0 || (months === 0 && today.getDate() < birthDate.getDate())) {\n      years--;\n      months += 12;\n    }\n    \n    if (today.getDate() < birthDate.getDate()) {\n      months--;\n    }\n    \n    if (years < 1) return `${months} เดือน`;\n    return months > 0 ? `${years} ปี ${months} เดือน` : `${years} ปี`;\n  };\n\n  const { weeks, currentMonth, currentYear } = generateCalendar();\n  \n  const monthNames = [\n    'มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน',\n    'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'\n  ];\n  \n  const dayNames = ['อา', 'จ', 'อ', 'พ', 'พฤ', 'ศ', 'ส'];\n  \n  const hourOptions = Array.from({ length: 24 }, (_, i) => i.toString().padStart(2, '0'));\n  const minuteOptions = ['00', '15', '30', '45'];\n\n  // Dropdown content\n  const dropdownContent = (\n    <div\n      ref={dropdownRef}\n      className={cn(\n        'fixed z-[9999] w-80 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700',\n        'rounded-2xl shadow-2xl overflow-hidden',\n        'animate-in fade-in-0 zoom-in-95 duration-150'\n      )}\n      style={{\n        top: position.top,\n        left: position.left,\n      }}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-900/50\">\n        <button\n          type=\"button\"\n          onClick={() => navigateMonth('prev')}\n          className=\"p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors\"\n        >\n          <ChevronLeft size={18} className=\"text-slate-600 dark:text-slate-400\" />\n        </button>\n        \n        <div className=\"text-center\">\n          <h3 className=\"font-semibold text-slate-900 dark:text-white\">\n            {monthNames[currentMonth]} {currentYear + 543}\n          </h3>\n          {value && (\n            <p className=\"text-xs text-slate-500 dark:text-slate-400 mt-0.5\">\n              {formatThaiDateShort(value)}\n              {showAge && ` (${calculateAge(value)})`}\n            </p>\n          )}\n        </div>\n        \n        <button\n          type=\"button\"\n          onClick={() => navigateMonth('next')}\n          className=\"p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors\"\n        >\n          <ChevronRight size={18} className=\"text-slate-600 dark:text-slate-400\" />\n        </button>\n      </div>\n\n      {/* Day headers */}\n      <div className=\"grid grid-cols-7 gap-1 px-4 py-2\">\n        {dayNames.map((day, index) => (\n          <div\n            key={index}\n            className={cn(\n              'text-center text-xs font-medium py-1',\n              index === 0 ? 'text-red-500' : 'text-slate-500 dark:text-slate-400'\n            )}\n          >\n            {day}\n          </div>\n        ))}\n      </div>\n\n      {/* Calendar grid */}\n      <div className=\"px-4 pb-4 space-y-1\">\n        {weeks.map((week, weekIndex) => (\n          <div key={weekIndex} className=\"grid grid-cols-7 gap-1\">\n            {week.map((date, dayIndex) => {\n              const isCurrentMonth = date.getMonth() === currentMonth;\n              const year = date.getFullYear();\n              const month = (date.getMonth() + 1).toString().padStart(2, '0');\n              const day = date.getDate().toString().padStart(2, '0');\n              const dateStr = `${year}-${month}-${day}`;\n              \n              const isSelected = dateStr === (value?.split('T')[0]);\n              const isToday = isTodayInBangkok(dateStr);\n              const isDisabled = isDateDisabled(dateStr);\n              const isSunday = dayIndex === 0;\n              \n              return (\n                <button\n                  key={dayIndex}\n                  type=\"button\"\n                  onClick={() => !isDisabled && selectDate(date)}\n                  disabled={isDisabled}\n                  className={cn(\n                    'w-9 h-9 text-sm rounded-lg transition-all duration-150 font-medium',\n                    isDisabled && 'text-slate-300 dark:text-slate-600 cursor-not-allowed',\n                    !isDisabled && isSelected && 'bg-primary-500 text-white shadow-md',\n                    !isDisabled && !isSelected && isToday && 'bg-primary-100 dark:bg-primary-500/20 text-primary-600 dark:text-primary-400 font-semibold ring-1 ring-primary-300',\n                    !isDisabled && !isSelected && !isToday && isCurrentMonth && isSunday && 'text-red-500 hover:bg-slate-100 dark:hover:bg-slate-700',\n                    !isDisabled && !isSelected && !isToday && isCurrentMonth && !isSunday && 'text-slate-900 dark:text-white hover:bg-slate-100 dark:hover:bg-slate-700',\n                    !isDisabled && !isSelected && !isToday && !isCurrentMonth && 'text-slate-400 dark:text-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800'\n                  )}\n                >\n                  {date.getDate()}\n                </button>\n              );\n            })}\n          </div>\n        ))}\n      </div>\n\n      {/* Time picker */}\n      {enableTime && (\n        <div className=\"px-4 pb-4 pt-2 border-t border-slate-200 dark:border-slate-700\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <label className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">เลือกเวลา</label>\n            <Clock size={16} className=\"text-slate-400\" />\n          </div>\n          <div className=\"flex gap-2\">\n            <select\n              value={selectedTime.hours}\n              onChange={(e) => handleTimeSelect(e.target.value, selectedTime.minutes)}\n              className=\"flex-1 px-3 py-2 bg-slate-100 dark:bg-slate-700 border-0 rounded-lg text-sm\"\n            >\n              {hourOptions.map(hour => (\n                <option key={hour} value={hour}>{hour}</option>\n              ))}\n            </select>\n            <span className=\"self-center text-slate-400\">:</span>\n            <select\n              value={selectedTime.minutes}\n              onChange={(e) => handleTimeSelect(selectedTime.hours, e.target.value)}\n              className=\"flex-1 px-3 py-2 bg-slate-100 dark:bg-slate-700 border-0 rounded-lg text-sm\"\n            >\n              {minuteOptions.map(minute => (\n                <option key={minute} value={minute}>{minute}</option>\n              ))}\n            </select>\n          </div>\n        </div>\n      )}\n\n      {/* Footer */}\n      <div className=\"flex items-center justify-between px-4 py-3 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700\">\n        <button\n          type=\"button\"\n          onClick={() => {\n            const today = new Date();\n            const todayStr = today.toISOString().split('T')[0];\n            if (!isDateDisabled(todayStr)) {\n              selectDate(today);\n            }\n          }}\n          disabled={isDateDisabled(new Date().toISOString().split('T')[0])}\n          className=\"text-sm font-medium text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 disabled:text-slate-400 disabled:cursor-not-allowed\"\n        >\n          วันนี้\n        </button>\n        \n        <div className=\"flex gap-2\">\n          {value && (\n            <button\n              type=\"button\"\n              onClick={() => {\n                onChange('');\n                setIsOpen(false);\n              }}\n              className=\"px-3 py-1.5 text-sm text-slate-500 hover:text-slate-700 dark:hover:text-slate-300\"\n            >\n              ล้าง\n            </button>\n          )}\n          <button\n            type=\"button\"\n            onClick={() => setIsOpen(false)}\n            className=\"px-3 py-1.5 text-sm bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600\"\n          >\n            ปิด\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className={cn('relative', className)}>\n      {label && (\n        <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5\">\n          {label}\n        </label>\n      )}\n      \n      {/* Trigger Button */}\n      <button\n        ref={triggerRef}\n        type=\"button\"\n        onClick={() => !disabled && setIsOpen(!isOpen)}\n        disabled={disabled}\n        className={cn(\n          'w-full px-4 py-2.5 bg-slate-50 dark:bg-slate-800 border rounded-xl text-sm text-left',\n          'focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500',\n          'transition-colors flex items-center justify-between gap-2',\n          error ? 'border-red-300 dark:border-red-500' : 'border-slate-200 dark:border-slate-700',\n          disabled && 'opacity-60 cursor-not-allowed'\n        )}\n      >\n        <span className={value ? 'text-slate-900 dark:text-white' : 'text-slate-400'}>\n          {value ? formatThaiDateShort(value) : placeholder}\n        </span>\n        <div className=\"flex items-center gap-2\">\n          {showAge && value && (\n            <span className=\"text-xs text-slate-400 bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded-full\">\n              {calculateAge(value)}\n            </span>\n          )}\n          <Calendar size={16} className=\"text-slate-400\" />\n        </div>\n      </button>\n      \n      {error && (\n        <p className=\"mt-1 text-xs text-red-500\">{error}</p>\n      )}\n\n      {/* Portal Dropdown */}\n      {mounted && isOpen && createPortal(dropdownContent, document.body)}\n    </div>\n  );\n};\n\nexport default DatePicker;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8114, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/date-picker/index.ts"],"sourcesContent":["// =============================================================================\n// File: components/ui/date-picker/index.ts\n// Description: Export DatePicker component\n// =============================================================================\n\nexport { default, default as DatePicker, type DatePickerProps } from './DatePicker';"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,2CAA2C;AAC3C,2CAA2C;AAC3C,gFAAgF;;AAEhF"}},
    {"offset": {"line": 8128, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/types/patient.types.ts"],"sourcesContent":["// =============================================================================\n// File: src/types/patient.types.ts\n// Description: Patient module type definitions\n// =============================================================================\n\n// ============================================\n// Base Patient Interface (from DB)\n// ============================================\nexport interface Patient {\n  /** Primary Key */\n  hn: string;\n  \n  /** ข้อมูลส่วนตัว */\n  pname: string | null;        // คำนำหน้า\n  fname: string | null;        // ชื่อ\n  lname: string | null;        // นามสกุล\n  midname?: string | null;     // ชื่อกลาง\n  sex: 'M' | 'F' | '1' | '2' | null;\n  birthday: string | null;     // YYYY-MM-DD\n  cid: string | null;          // เลขบัตรประชาชน 13 หลัก\n  \n  /** ข้อมูลติดต่อ */\n  mobilePhone: string | null;  // mobile_phone_number\n  hometel: string | null;\n  email: string | null;\n  \n  /** ที่อยู่ */\n  addrpart: string | null;     // บ้านเลขที่\n  moopart: string | null;      // หมู่\n  road: string | null;         // ถนน\n  tmbpart: string | null;      // ตำบล code\n  amppart: string | null;      // อำเภอ code\n  chwpart: string | null;      // จังหวัด code\n  poCode: string | null;       // รหัสไปรษณีย์\n  \n  /** ข้อมูลทางการแพทย์ */\n  bloodgrp: string | null;     // หมู่เลือด\n  bloodgroupRh: string | null; // Rh\n  drugallergy: string | null;  // แพ้ยา\n  g6pd: 'Y' | 'N' | null;      // G6PD\n  \n  /** ข้อมูลสิทธิ์ */\n  pttype: string | null;       // รหัสสิทธิ์\n  \n  /** สถานะ */\n  lastVisit: string | null;    // วันที่มาล่าสุด\n  firstday: string | null;     // วันที่ลงทะเบียน\n  death: 'Y' | 'N' | null;\n  deathday: string | null;\n  \n  /** ข้อมูลครอบครัว */\n  fathername: string | null;\n  mathername: string | null;   // mother name (typo in DB)\n  spsname: string | null;      // spouse name\n  marrystatus: string | null;\n  \n  /** ผู้ติดต่อฉุกเฉิน */\n  informname: string | null;\n  informtel: string | null;\n  informrelation: string | null;\n  \n  /** อื่นๆ */\n  nationality: string | null;\n  religion: string | null;\n  occupation: string | null;\n  passportNo: string | null;\n  \n  /** Metadata */\n  lastUpdate: string | null;\n}\n\n// ============================================\n// Patient List Item (สำหรับแสดงในรายการ)\n// ============================================\nexport interface PatientListItem {\n  hn: string;\n  fullName: string;           // computed: pname + fname + lname\n  cid: string | null;\n  sex: 'M' | 'F' | null;\n  age: number | null;         // computed from birthday\n  birthday: string | null;\n  phone: string | null;       // mobile or hometel\n  pttype: string | null;\n  pttypeName?: string;        // joined\n  bloodgrp: string | null;\n  hasAllergy: boolean;\n  lastVisit: string | null;\n  isDead: boolean;\n  photo?: string | null;\n}\n\n// ============================================\n// Patient Detail (สำหรับหน้า Profile)\n// ============================================\nexport interface PatientDetail extends Patient {\n  /** Computed fields */\n  fullName: string;\n  age: number | null;\n  ageText: string;            // \"45 ปี 3 เดือน\"\n  fullAddress: string;\n  \n  /** Joined data */\n  pttypeName?: string;\n  tmbName?: string;           // ชื่อตำบล\n  ampName?: string;           // ชื่ออำเภอ\n  chwName?: string;           // ชื่อจังหวัด\n  nationalityName?: string;\n  religionName?: string;\n  occupationName?: string;\n  \n  /** Related data */\n  allergies: string[];        // parsed from drugallergy\n  \n  /** Photo */\n  photo?: string | null;\n}\n\n// ============================================\n// Patient Form Data (สำหรับ Create/Edit)\n// ============================================\nexport interface PatientFormData {\n  // Required\n  pname: string;\n  fname: string;\n  lname: string;\n  sex: 'M' | 'F';\n  birthday: string;\n  cid: string;\n  \n  // Contact\n  mobilePhone: string;\n  hometel: string;\n  email: string;\n  \n  // Address\n  addrpart: string;\n  moopart: string;\n  road: string;\n  tmbpart: string;\n  amppart: string;\n  chwpart: string;\n  poCode: string;\n  \n  // Medical\n  bloodgrp: string;\n  bloodgroupRh: string;\n  drugallergy: string;\n  g6pd: string;\n  \n  // Rights\n  pttype: string;\n  \n  // Optional\n  nationality: string;\n  religion: string;\n  occupation: string;\n  marrystatus: string;\n  \n  // Family\n  fathername: string;\n  mathername: string;\n  spsname: string;\n  \n  // Emergency Contact\n  informname: string;\n  informtel: string;\n  informrelation: string;\n}\n\n// ============================================\n// Search & Filter\n// ============================================\nexport interface PatientSearchParams {\n  query?: string;             // ค้นหา HN, ชื่อ, CID\n  sex?: 'M' | 'F' | 'all';\n  pttype?: string;\n  chwpart?: string;\n  amppart?: string;\n  hasAllergy?: boolean;\n  isDead?: boolean;\n  ageFrom?: number;\n  ageTo?: number;\n  lastVisitFrom?: string;\n  lastVisitTo?: string;\n}\n\nexport interface PatientSortParams {\n  field: 'hn' | 'fname' | 'lastVisit' | 'birthday' | 'firstday';\n  direction: 'asc' | 'desc';\n}\n\nexport interface PatientListParams {\n  search?: PatientSearchParams;\n  sort?: PatientSortParams;\n  page: number;\n  limit: number;\n}\n\n// ============================================\n// API Response\n// ============================================\nexport interface PatientListResponse {\n  data: PatientListItem[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  };\n}\n\n// ============================================\n// Statistics\n// ============================================\nexport interface PatientStats {\n  total: number;\n  newThisMonth: number;\n  visitedToday: number;\n  withAllergy: number;\n  byGender: {\n    male: number;\n    female: number;\n  };\n  byPttype: {\n    code: string;\n    name: string;\n    count: number;\n  }[];\n}\n\n// ============================================\n// Constants\n// ============================================\nexport const PNAME_OPTIONS = [\n  { value: 'นาย', label: 'นาย' },\n  { value: 'นาง', label: 'นาง' },\n  { value: 'นางสาว', label: 'นางสาว' },\n  { value: 'ด.ช.', label: 'ด.ช.' },\n  { value: 'ด.ญ.', label: 'ด.ญ.' },\n  { value: 'Mr.', label: 'Mr.' },\n  { value: 'Mrs.', label: 'Mrs.' },\n  { value: 'Miss', label: 'Miss' },\n];\n\nexport const SEX_OPTIONS = [\n  { value: 'M', label: 'ชาย' },\n  { value: 'F', label: 'หญิง' },\n];\n\nexport const BLOOD_GROUP_OPTIONS = [\n  { value: 'A', label: 'A' },\n  { value: 'B', label: 'B' },\n  { value: 'AB', label: 'AB' },\n  { value: 'O', label: 'O' },\n];\n\nexport const BLOOD_RH_OPTIONS = [\n  { value: '+', label: 'Rh+' },\n  { value: '-', label: 'Rh-' },\n];\n\nexport const MARRY_STATUS_OPTIONS = [\n  { value: '1', label: 'โสด' },\n  { value: '2', label: 'สมรส' },\n  { value: '3', label: 'หม้าย' },\n  { value: '4', label: 'หย่า' },\n  { value: '5', label: 'แยกกันอยู่' },\n  { value: '9', label: 'ไม่ระบุ' },\n];"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,mCAAmC;AACnC,+CAA+C;AAC/C,gFAAgF;AAEhF,+CAA+C;AAC/C,mCAAmC;AACnC,+CAA+C;;;;;;;;;;;;;AAkOxC,MAAM,gBAAgB;IAC3B;QAAE,OAAO;QAAO,OAAO;IAAM;IAC7B;QAAE,OAAO;QAAO,OAAO;IAAM;IAC7B;QAAE,OAAO;QAAU,OAAO;IAAS;IACnC;QAAE,OAAO;QAAQ,OAAO;IAAO;IAC/B;QAAE,OAAO;QAAQ,OAAO;IAAO;IAC/B;QAAE,OAAO;QAAO,OAAO;IAAM;IAC7B;QAAE,OAAO;QAAQ,OAAO;IAAO;IAC/B;QAAE,OAAO;QAAQ,OAAO;IAAO;CAChC;AAEM,MAAM,cAAc;IACzB;QAAE,OAAO;QAAK,OAAO;IAAM;IAC3B;QAAE,OAAO;QAAK,OAAO;IAAO;CAC7B;AAEM,MAAM,sBAAsB;IACjC;QAAE,OAAO;QAAK,OAAO;IAAI;IACzB;QAAE,OAAO;QAAK,OAAO;IAAI;IACzB;QAAE,OAAO;QAAM,OAAO;IAAK;IAC3B;QAAE,OAAO;QAAK,OAAO;IAAI;CAC1B;AAEM,MAAM,mBAAmB;IAC9B;QAAE,OAAO;QAAK,OAAO;IAAM;IAC3B;QAAE,OAAO;QAAK,OAAO;IAAM;CAC5B;AAEM,MAAM,uBAAuB;IAClC;QAAE,OAAO;QAAK,OAAO;IAAM;IAC3B;QAAE,OAAO;QAAK,OAAO;IAAO;IAC5B;QAAE,OAAO;QAAK,OAAO;IAAQ;IAC7B;QAAE,OAAO;QAAK,OAAO;IAAO;IAC5B;QAAE,OAAO;QAAK,OAAO;IAAa;IAClC;QAAE,OAAO;QAAK,OAAO;IAAU;CAChC"}},
    {"offset": {"line": 8252, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/app/patients/%5Bhn%5D/edit/page.tsx"],"sourcesContent":["// =============================================================================\n// File: src/app/patients/[hn]/edit/page.tsx\n// Description: Patient Edit Page - Clean Minimal Design (Original Style)\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useRouter, useParams } from 'next/navigation';\nimport {\n  ArrowLeft,\n  Save,\n  X,\n  User,\n  Phone,\n  Mail,\n  MapPin,\n  Calendar,\n  CreditCard,\n  Heart,\n  Droplet,\n  AlertCircle,\n  Shield,\n  Users,\n  Camera,\n  Plus,\n  ChevronDown,\n  ChevronUp,\n  Check,\n  Loader2,\n  Info,\n  FileText,\n  RefreshCw,\n} from 'lucide-react';\nimport { usePatientDetail } from '@/hooks';\nimport { usePatientImageManager } from '@/hooks/usePatientImages';\nimport { PatientImageUpload } from '@/components/ui/patient-image';\nimport { AdminLayout } from '@/components/layout';\nimport { ConfirmDialog, useConfirmDialog } from '@/components/ui/confirm-dialog';\nimport CustomSelect from '@/components/ui/CustomSelect';\nimport DatePicker from '@/components/ui/date-picker';\nimport {\n  PatientDetail,\n  PatientFormData,\n  PNAME_OPTIONS,\n  SEX_OPTIONS,\n  BLOOD_GROUP_OPTIONS,\n  BLOOD_RH_OPTIONS,\n  MARRY_STATUS_OPTIONS,\n} from '@/types/patient.types';\n\n// ============================================\n// Mock Data\n// ============================================\nconst mockPatient: PatientDetail = {\n  hn: '0001234',\n  pname: 'นาย',\n  fname: 'สมชาย',\n  lname: 'ใจดี',\n  midname: null,\n  fullName: 'นายสมชาย ใจดี',\n  sex: 'M',\n  birthday: '1979-05-15',\n  age: 45,\n  ageText: '45 ปี 7 เดือน',\n  cid: '1234567890123',\n  mobilePhone: '0812345678',\n  hometel: '044123456',\n  email: 'somchai@email.com',\n  addrpart: '123/45',\n  moopart: '6',\n  road: 'มิตรภาพ',\n  tmbpart: '01',\n  amppart: '01',\n  chwpart: '30',\n  poCode: '30000',\n  fullAddress: '123/45 หมู่ 6 ถ.มิตรภาพ ต.ในเมือง อ.เมือง จ.นครราชสีมา 30000',\n  tmbName: 'ในเมือง',\n  ampName: 'เมืองนครราชสีมา',\n  chwName: 'นครราชสีมา',\n  bloodgrp: 'O',\n  bloodgroupRh: '+',\n  drugallergy: 'Penicillin, Aspirin',\n  allergies: ['Penicillin', 'Aspirin'],\n  g6pd: 'N',\n  pttype: 'UCS',\n  pttypeName: 'บัตรทอง 30 บาท',\n  lastVisit: '2024-12-15',\n  firstday: '2018-03-20',\n  death: 'N',\n  deathday: null,\n  fathername: 'นายสมศักดิ์ ใจดี',\n  mathername: 'นางสมหญิง ใจดี',\n  spsname: 'นางวิไล ใจดี',\n  marrystatus: '2',\n  informname: 'นางวิไล ใจดี',\n  informtel: '0898765432',\n  informrelation: 'คู่สมรส',\n  nationality: 'TH',\n  nationalityName: 'ไทย',\n  religion: '01',\n  religionName: 'พุทธ',\n  occupation: '001',\n  occupationName: 'รับราชการ',\n  passportNo: null,\n  lastUpdate: '2024-12-15 14:30:00',\n  photo: null,\n};\n\n// Options\nconst provinceOptions = [\n  { value: '30', label: 'นครราชสีมา' },\n  { value: '10', label: 'กรุงเทพมหานคร' },\n  { value: '40', label: 'ขอนแก่น' },\n];\n\nconst pttypeOptions = [\n  { value: '10', label: '10 - ชำระเงินเอง' },\n  { value: 'UCS', label: 'UCS - บัตรทอง 30 บาท' },\n  { value: 'OFC', label: 'OFC - ข้าราชการ' },\n  { value: 'SSS', label: 'SSS - ประกันสังคม' },\n  { value: 'LGO', label: 'LGO - อปท.' },\n];\n\nconst religionOptions = [\n  { value: '01', label: 'พุทธ' },\n  { value: '02', label: 'อิสลาม' },\n  { value: '03', label: 'คริสต์' },\n  { value: '04', label: 'ฮินดู' },\n  { value: '09', label: 'อื่นๆ' },\n];\n\nconst nationalityOptions = [\n  { value: 'TH', label: 'ไทย' },\n  { value: 'MM', label: 'เมียนมา' },\n  { value: 'LA', label: 'ลาว' },\n  { value: 'KH', label: 'กัมพูชา' },\n  { value: 'OT', label: 'อื่นๆ' },\n];\n\nconst relationOptions = [\n  { value: 'spouse', label: 'คู่สมรส' },\n  { value: 'parent', label: 'บิดา/มารดา' },\n  { value: 'child', label: 'บุตร' },\n  { value: 'sibling', label: 'พี่น้อง' },\n  { value: 'relative', label: 'ญาติ' },\n  { value: 'friend', label: 'เพื่อน' },\n  { value: 'other', label: 'อื่นๆ' },\n];\n\n// ============================================\n// Sub Components\n// ============================================\n\n// Form Section Component\ninterface FormSectionProps {\n  title: string;\n  icon: React.ReactNode;\n  children: React.ReactNode;\n  collapsible?: boolean;\n  defaultOpen?: boolean;\n  badge?: React.ReactNode;\n}\n\nconst FormSection: React.FC<FormSectionProps> = ({\n  title,\n  icon,\n  children,\n  collapsible = true,\n  defaultOpen = true,\n  badge,\n}) => {\n  const [isOpen, setIsOpen] = useState(defaultOpen);\n\n  return (\n    <div className=\"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden\">\n      <button\n        type=\"button\"\n        onClick={() => collapsible && setIsOpen(!isOpen)}\n        className={`w-full px-4 py-3 flex items-center justify-between bg-slate-50 dark:bg-slate-800/50 ${collapsible ? 'cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800' : 'cursor-default'} transition-colors`}\n      >\n        <div className=\"flex items-center gap-3\">\n          <span className=\"text-slate-500 dark:text-slate-400\">{icon}</span>\n          <span className=\"font-semibold text-slate-900 dark:text-white text-sm\">{title}</span>\n          {badge}\n        </div>\n        {collapsible && (\n          isOpen ? (\n            <ChevronUp size={18} className=\"text-slate-400\" />\n          ) : (\n            <ChevronDown size={18} className=\"text-slate-400\" />\n          )\n        )}\n      </button>\n      {isOpen && <div className=\"p-4\">{children}</div>}\n    </div>\n  );\n};\n\n// Form Field Component\ninterface FormFieldProps {\n  label: string;\n  required?: boolean;\n  error?: string;\n  hint?: string;\n  children: React.ReactNode;\n  className?: string;\n}\n\nconst FormField: React.FC<FormFieldProps> = ({\n  label,\n  required,\n  error,\n  hint,\n  children,\n  className = '',\n}) => (\n  <div className={`space-y-1.5 ${className}`}>\n    <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300\">\n      {label}\n      {required && <span className=\"text-red-500 ml-1\">*</span>}\n    </label>\n    {children}\n    {hint && !error && (\n      <p className=\"text-xs text-slate-400 flex items-center gap-1\">\n        <Info size={12} />\n        {hint}\n      </p>\n    )}\n    {error && (\n      <p className=\"text-xs text-red-500 flex items-center gap-1\">\n        <AlertCircle size={12} />\n        {error}\n      </p>\n    )}\n  </div>\n);\n\n// Input Component\ninterface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {\n  error?: boolean;\n}\n\nconst Input: React.FC<InputProps> = ({ error, className = '', ...props }) => (\n  <input\n    {...props}\n    className={`\n      w-full px-4 py-2.5 \n      bg-slate-50 dark:bg-slate-800 \n      border rounded-xl text-sm\n      focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500\n      transition-colors\n      ${error \n        ? 'border-red-300 dark:border-red-500 focus:border-red-500 focus:ring-red-500/20' \n        : 'border-slate-200 dark:border-slate-700'\n      }\n      ${props.disabled ? 'opacity-60 cursor-not-allowed' : ''}\n      ${className}\n    `}\n  />\n);\n\n// Allergy Input Component\nconst AllergyInput: React.FC<{\n  allergies: string[];\n  onChange: (allergies: string[]) => void;\n}> = ({ allergies, onChange }) => {\n  const [newAllergy, setNewAllergy] = useState('');\n\n  const handleAdd = () => {\n    if (newAllergy.trim() && !allergies.includes(newAllergy.trim())) {\n      onChange([...allergies, newAllergy.trim()]);\n      setNewAllergy('');\n    }\n  };\n\n  const handleRemove = (allergy: string) => {\n    onChange(allergies.filter((a) => a !== allergy));\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex gap-2\">\n        <Input\n          type=\"text\"\n          value={newAllergy}\n          onChange={(e) => setNewAllergy(e.target.value)}\n          onKeyDown={(e) => e.key === 'Enter' && (e.preventDefault(), handleAdd())}\n          placeholder=\"พิมพ์ชื่อยาที่แพ้...\"\n          className=\"flex-1\"\n        />\n        <button\n          type=\"button\"\n          onClick={handleAdd}\n          disabled={!newAllergy.trim()}\n          className=\"px-4 py-2.5 bg-red-500 text-white rounded-xl hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n        >\n          <Plus size={18} />\n        </button>\n      </div>\n      \n      {allergies.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {allergies.map((allergy) => (\n            <span\n              key={allergy}\n              className=\"inline-flex items-center gap-1 px-3 py-1.5 bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-300 rounded-lg text-sm\"\n            >\n              <AlertCircle size={14} />\n              {allergy}\n              <button\n                type=\"button\"\n                onClick={() => handleRemove(allergy)}\n                className=\"ml-1 hover:text-red-900 dark:hover:text-red-100\"\n              >\n                <X size={14} />\n              </button>\n            </span>\n          ))}\n        </div>\n      )}\n      \n      {allergies.length === 0 && (\n        <p className=\"text-sm text-slate-400 italic\">ไม่มีประวัติแพ้ยา</p>\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// Main Component\n// ============================================\nexport default function PatientEditPage() {\n  const router = useRouter();\n  const params = useParams();\n  const hn = params.hn as string;\n  const isNew = hn === 'new';\n\n  // Load patient data from API\n  const { patient, loading: patientLoading, error: patientError, refresh } = usePatientDetail(isNew ? null : hn);\n  \n  // Load patient image\n  const {\n    primaryImage,\n    loading: imageLoading,\n    upload: uploadImage,\n    uploading,\n  } = usePatientImageManager(isNew ? null : hn);\n\n  const [saving, setSaving] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isDirty, setIsDirty] = useState(false);\n  const [initialized, setInitialized] = useState(false);\n\n  // Form data\n  const [formData, setFormData] = useState<PatientFormData>({\n    pname: '',\n    fname: '',\n    lname: '',\n    sex: 'M',\n    birthday: '',\n    cid: '',\n    mobilePhone: '',\n    hometel: '',\n    email: '',\n    addrpart: '',\n    moopart: '',\n    road: '',\n    tmbpart: '',\n    amppart: '',\n    chwpart: '',\n    poCode: '',\n    bloodgrp: '',\n    bloodgroupRh: '',\n    drugallergy: '',\n    g6pd: '',\n    pttype: '',\n    nationality: 'TH',\n    religion: '',\n    occupation: '',\n    marrystatus: '',\n    fathername: '',\n    mathername: '',\n    spsname: '',\n    informname: '',\n    informtel: '',\n    informrelation: '',\n  });\n\n  const [allergies, setAllergies] = useState<string[]>([]);\n  const [photo, setPhoto] = useState<string | null>(null);\n  const [localImageChanged, setLocalImageChanged] = useState(false);\n\n  // Discard changes dialog\n  const discardDialog = useConfirmDialog({\n    onConfirm: async () => {\n      router.back();\n    },\n  });\n\n  // Load patient data from API response\n  useEffect(() => {\n    if (isNew || !patient || initialized) return;\n\n    setFormData({\n      pname: patient.pname || '',\n      fname: patient.fname || '',\n      lname: patient.lname || '',\n      sex: (patient.sex as 'M' | 'F') || 'M',\n      birthday: patient.birthday || '',\n      cid: patient.cid || '',\n      mobilePhone: patient.mobilePhone || '',\n      hometel: patient.hometel || '',\n      email: patient.email || '',\n      addrpart: patient.addrpart || '',\n      moopart: patient.moopart || '',\n      road: patient.road || '',\n      tmbpart: patient.tmbpart || '',\n      amppart: patient.amppart || '',\n      chwpart: patient.chwpart || '',\n      poCode: patient.poCode || '',\n      bloodgrp: patient.bloodgrp || '',\n      bloodgroupRh: patient.bloodgroupRh || '',\n      drugallergy: patient.drugallergy || '',\n      g6pd: patient.g6pd || '',\n      pttype: patient.pttype || '',\n      nationality: patient.nationality || 'TH',\n      religion: patient.religion || '',\n      occupation: patient.occupation || '',\n      marrystatus: patient.marrystatus || '',\n      fathername: patient.fathername || '',\n      mathername: patient.mathername || '',\n      spsname: patient.spsname || '',\n      informname: patient.informname || '',\n      informtel: patient.informtel || '',\n      informrelation: patient.informrelation || '',\n    });\n    setAllergies(patient.allergies || []);\n    setInitialized(true);\n  }, [isNew, patient, initialized]);\n\n  // Update photo when primaryImage changes (from API)\n  useEffect(() => {\n    if (!localImageChanged && primaryImage) {\n      setPhoto(primaryImage);\n    }\n  }, [primaryImage, localImageChanged]);\n\n  // Update form field\n  const updateField = useCallback((field: keyof PatientFormData, value: string) => {\n    setFormData((prev) => ({ ...prev, [field]: value }));\n    setIsDirty(true);\n    if (errors[field]) {\n      setErrors((prev) => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  }, [errors]);\n\n  // Validate form\n  const validate = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.pname) newErrors.pname = 'กรุณาเลือกคำนำหน้า';\n    if (!formData.fname) newErrors.fname = 'กรุณากรอกชื่อ';\n    if (!formData.lname) newErrors.lname = 'กรุณากรอกนามสกุล';\n    if (!formData.birthday) newErrors.birthday = 'กรุณาเลือกวันเกิด';\n    if (!formData.pttype) newErrors.pttype = 'กรุณาเลือกสิทธิการรักษา';\n\n    if (formData.cid && formData.cid.length !== 13) {\n      newErrors.cid = 'เลขบัตรประชาชนต้องมี 13 หลัก';\n    }\n\n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'รูปแบบอีเมลไม่ถูกต้อง';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Handle save\n  const handleSave = async () => {\n    if (!validate()) {\n      const firstError = document.querySelector('[data-error=\"true\"]');\n      firstError?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await new Promise((r) => setTimeout(r, 1500));\n      \n      const dataToSave = {\n        ...formData,\n        drugallergy: allergies.join(', '),\n      };\n      \n      console.log('Saving:', dataToSave);\n      router.push(isNew ? '/patients' : `/patients/${hn}`);\n    } catch (error) {\n      console.error('Save failed:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Handle cancel\n  const handleCancel = () => {\n    if (isDirty) {\n      discardDialog.open(null);\n    } else {\n      router.back();\n    }\n  };\n\n  // Handle photo change from PatientImageUpload component\n  const handlePhotoChange = (imageData: string | null, width?: number, height?: number) => {\n    setPhoto(imageData);\n    setLocalImageChanged(true);\n    setIsDirty(true);\n  };\n\n  // Handle image upload to server\n  const handleImageUpload = async (imageData: string, width: number, height: number) => {\n    if (!isNew && hn) {\n      await uploadImage(imageData, width, height);\n    }\n  };\n\n  const loading = patientLoading;\n\n  // Error state\n  if (!isNew && patientError) {\n    return (\n      <AdminLayout>\n        <div className=\"text-center py-12\">\n          <User size={48} className=\"mx-auto text-slate-300 mb-4\" />\n          <h2 className=\"text-xl font-semibold text-slate-900 dark:text-white\">\n            {patientError}\n          </h2>\n          <p className=\"text-slate-500 mt-1\">HN: {hn}</p>\n          <div className=\"flex items-center justify-center gap-2 mt-4\">\n            <button\n              onClick={() => refresh()}\n              className=\"px-4 py-2 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl flex items-center gap-2\"\n            >\n              <RefreshCw size={16} />\n              ลองใหม่\n            </button>\n            <button\n              onClick={() => router.back()}\n              className=\"px-4 py-2 bg-primary-500 text-white rounded-xl\"\n            >\n              กลับ\n            </button>\n          </div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  if (loading) {\n    return (\n      <AdminLayout>\n        <div className=\"animate-pulse space-y-6\">\n          <div className=\"h-16 bg-slate-200 dark:bg-slate-800 rounded-2xl\" />\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            <div className=\"lg:col-span-2 space-y-6\">\n              <div className=\"h-64 bg-slate-200 dark:bg-slate-800 rounded-2xl\" />\n              <div className=\"h-48 bg-slate-200 dark:bg-slate-800 rounded-2xl\" />\n            </div>\n            <div className=\"h-96 bg-slate-200 dark:bg-slate-800 rounded-2xl\" />\n          </div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      {/* Page wrapper with contrasting background */}\n      <div className=\"min-h-screen -m-6 p-6 bg-slate-100 dark:bg-slate-950\">\n        <form onSubmit={(e) => { e.preventDefault(); handleSave(); }} className=\"space-y-6 pb-24 lg:pb-6\">\n          {/* ============================================ */}\n          {/* Header */}\n          {/* ============================================ */}\n          <div className=\"sticky top-0 z-20 -mx-6 px-6 lg:mx-0 lg:px-0 lg:static\">\n            <div className=\"bg-white dark:bg-slate-900 lg:bg-primary-600 rounded-none lg:rounded-2xl border-b lg:border-0 border-slate-200 dark:border-slate-800 p-4 lg:p-6 lg:text-white shadow-sm\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={handleCancel}\n                    className=\"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 lg:hover:bg-white/10 rounded-lg transition-colors\"\n                  >\n                    <ArrowLeft size={20} className=\"text-slate-600 dark:text-slate-400 lg:text-white\" />\n                  </button>\n                  <div>\n                    <h1 className=\"text-lg lg:text-xl font-bold text-slate-900 dark:text-white lg:text-white\">\n                      {isNew ? 'ลงทะเบียนผู้ป่วยใหม่' : 'แก้ไขข้อมูลผู้ป่วย'}\n                    </h1>\n                    {!isNew && patient && (\n                      <div className=\"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400 lg:text-white/70\">\n                        <span className=\"font-mono\">HN: {hn}</span>\n                        <span className=\"hidden sm:inline\">•</span>\n                        <span className=\"hidden sm:inline\">{patient.fullName}</span>\n                        <span className=\"hidden sm:inline\">•</span>\n                        <span className=\"hidden sm:inline\">{patient.sex === 'M' ? 'ชาย' : 'หญิง'}</span>\n                        <span className=\"hidden sm:inline\">•</span>\n                        <span className=\"hidden sm:inline\">{patient.ageText}</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Desktop Save Button */}\n                <div className=\"hidden lg:flex items-center gap-2\">\n                  <button\n                    type=\"button\"\n                    onClick={handleCancel}\n                    className=\"px-4 py-2 bg-white/20 text-white rounded-xl hover:bg-white/30 transition-colors font-medium\"\n                  >\n                    ยกเลิก\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={saving}\n                    className=\"px-6 py-2 bg-white text-primary-600 rounded-xl hover:bg-white/90 transition-colors font-medium flex items-center gap-2 disabled:opacity-50\"\n                  >\n                    {saving ? (\n                      <>\n                        <Loader2 size={18} className=\"animate-spin\" />\n                        กำลังบันทึก...\n                      </>\n                    ) : (\n                      <>\n                        <Save size={18} />\n                        บันทึก\n                      </>\n                    )}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ============================================ */}\n          {/* Main Content */}\n          {/* ============================================ */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            \n            {/* Left Column - Main Form */}\n            <div className=\"lg:col-span-2 space-y-6\">\n              \n              {/* Personal Information */}\n              <FormSection\n                title=\"ข้อมูลส่วนตัว\"\n                icon={<User size={18} />}\n                collapsible={false}\n              >\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <FormField label=\"คำนำหน้า\" required error={errors.pname}>\n                    <CustomSelect\n                      options={PNAME_OPTIONS}\n                      value={formData.pname}\n                      onChange={(val) => updateField('pname', val)}\n                      placeholder=\"เลือก...\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"ชื่อ\" required error={errors.fname} className=\"lg:col-span-1\">\n                    <Input\n                      type=\"text\"\n                      value={formData.fname}\n                      onChange={(e) => updateField('fname', e.target.value)}\n                      placeholder=\"ชื่อ\"\n                      error={!!errors.fname}\n                      data-error={!!errors.fname}\n                    />\n                  </FormField>\n\n                  <FormField label=\"นามสกุล\" required error={errors.lname} className=\"lg:col-span-2\">\n                    <Input\n                      type=\"text\"\n                      value={formData.lname}\n                      onChange={(e) => updateField('lname', e.target.value)}\n                      placeholder=\"นามสกุล\"\n                      error={!!errors.lname}\n                      data-error={!!errors.lname}\n                    />\n                  </FormField>\n\n                  <FormField label=\"เพศ\" required className=\"sm:col-span-1\">\n                    <div className=\"flex gap-2\">\n                      {SEX_OPTIONS.map((opt) => (\n                        <button\n                          key={opt.value}\n                          type=\"button\"\n                          onClick={() => updateField('sex', opt.value)}\n                          className={`flex-1 py-2.5 rounded-xl text-sm font-medium transition-colors ${\n                            formData.sex === opt.value\n                              ? opt.value === 'M'\n                                ? 'bg-blue-500 text-white'\n                                : 'bg-pink-500 text-white'\n                              : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400'\n                          }`}\n                        >\n                          {opt.value === 'M' ? '♂' : '♀'} {opt.label}\n                        </button>\n                      ))}\n                    </div>\n                  </FormField>\n\n                  {/* Date Picker Field */}\n                  <FormField label=\"วันเกิด\" required error={errors.birthday}>\n                    <DatePicker\n                      value={formData.birthday}\n                      onChange={(date: string) => updateField('birthday', date)}\n                      error={errors.birthday}\n                      placeholder=\"เลือกวันเกิด\"\n                      disableFutureDates={true}\n                      disablePastDates={false}\n                      showAge={true}\n                    />\n                  </FormField>\n\n                  <FormField label=\"เลขบัตรประชาชน\" error={errors.cid} className=\"sm:col-span-2\">\n                    <Input\n                      type=\"text\"\n                      value={formData.cid}\n                      onChange={(e) => updateField('cid', e.target.value.replace(/\\D/g, '').slice(0, 13))}\n                      placeholder=\"X-XXXX-XXXXX-XX-X\"\n                      maxLength={13}\n                      error={!!errors.cid}\n                    />\n                  </FormField>\n                </div>\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4\">\n                  <FormField label=\"สัญชาติ\">\n                    <CustomSelect\n                      options={nationalityOptions}\n                      value={formData.nationality}\n                      onChange={(val) => updateField('nationality', val)}\n                    />\n                  </FormField>\n\n                  <FormField label=\"ศาสนา\">\n                    <CustomSelect\n                      options={religionOptions}\n                      value={formData.religion}\n                      onChange={(val) => updateField('religion', val)}\n                      placeholder=\"เลือก...\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"สถานภาพ\">\n                    <CustomSelect\n                      options={MARRY_STATUS_OPTIONS}\n                      value={formData.marrystatus}\n                      onChange={(val) => updateField('marrystatus', val)}\n                      placeholder=\"เลือก...\"\n                    />\n                  </FormField>\n                </div>\n              </FormSection>\n\n              {/* Contact Information */}\n              <FormSection title=\"ข้อมูลติดต่อ\" icon={<Phone size={18} />}>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <FormField label=\"โทรศัพท์มือถือ\">\n                    <Input\n                      type=\"tel\"\n                      value={formData.mobilePhone}\n                      onChange={(e) => updateField('mobilePhone', e.target.value.replace(/\\D/g, ''))}\n                      placeholder=\"08XXXXXXXX\"\n                      maxLength={10}\n                    />\n                  </FormField>\n\n                  <FormField label=\"โทรศัพท์บ้าน\">\n                    <Input\n                      type=\"tel\"\n                      value={formData.hometel}\n                      onChange={(e) => updateField('hometel', e.target.value.replace(/\\D/g, ''))}\n                      placeholder=\"0XXXXXXXX\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"อีเมล\" error={errors.email} className=\"sm:col-span-2\">\n                    <Input\n                      type=\"email\"\n                      value={formData.email}\n                      onChange={(e) => updateField('email', e.target.value)}\n                      placeholder=\"email@example.com\"\n                      error={!!errors.email}\n                    />\n                  </FormField>\n                </div>\n              </FormSection>\n\n              {/* Address */}\n              <FormSection title=\"ที่อยู่\" icon={<MapPin size={18} />}>\n                <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n                  <FormField label=\"บ้านเลขที่\">\n                    <Input\n                      type=\"text\"\n                      value={formData.addrpart}\n                      onChange={(e) => updateField('addrpart', e.target.value)}\n                      placeholder=\"123/45\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"หมู่\">\n                    <Input\n                      type=\"text\"\n                      value={formData.moopart}\n                      onChange={(e) => updateField('moopart', e.target.value)}\n                      placeholder=\"1\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"ถนน\" className=\"col-span-2\">\n                    <Input\n                      type=\"text\"\n                      value={formData.road}\n                      onChange={(e) => updateField('road', e.target.value)}\n                      placeholder=\"ชื่อถนน\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"จังหวัด\" className=\"col-span-2\">\n                    <CustomSelect\n                      options={provinceOptions}\n                      value={formData.chwpart}\n                      onChange={(val) => updateField('chwpart', val)}\n                      placeholder=\"เลือกจังหวัด...\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"รหัสไปรษณีย์\" className=\"col-span-2\">\n                    <Input\n                      type=\"text\"\n                      value={formData.poCode}\n                      onChange={(e) => updateField('poCode', e.target.value.replace(/\\D/g, '').slice(0, 5))}\n                      placeholder=\"XXXXX\"\n                      maxLength={5}\n                    />\n                  </FormField>\n                </div>\n              </FormSection>\n\n              {/* Medical Information */}\n              <FormSection\n                title=\"ข้อมูลทางการแพทย์\"\n                icon={<Heart size={18} />}\n                badge={\n                  allergies.length > 0 && (\n                    <span className=\"px-2 py-0.5 bg-red-100 dark:bg-red-500/20 text-red-600 dark:text-red-400 rounded-full text-xs font-medium\">\n                      แพ้ยา {allergies.length} รายการ\n                    </span>\n                  )\n                }\n              >\n                <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n                  <FormField label=\"หมู่เลือด\">\n                    <CustomSelect\n                      options={BLOOD_GROUP_OPTIONS}\n                      value={formData.bloodgrp}\n                      onChange={(val) => updateField('bloodgrp', val)}\n                      placeholder=\"เลือก...\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"Rh\">\n                    <CustomSelect\n                      options={BLOOD_RH_OPTIONS}\n                      value={formData.bloodgroupRh}\n                      onChange={(val) => updateField('bloodgroupRh', val)}\n                      placeholder=\"เลือก...\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"G6PD\" className=\"col-span-2\">\n                    <div className=\"flex gap-2\">\n                      {[\n                        { value: 'N', label: 'ปกติ' },\n                        { value: 'Y', label: 'พร่อง' },\n                      ].map((opt) => (\n                        <button\n                          key={opt.value}\n                          type=\"button\"\n                          onClick={() => updateField('g6pd', opt.value)}\n                          className={`flex-1 py-2.5 rounded-xl text-sm font-medium transition-colors ${\n                            formData.g6pd === opt.value\n                              ? opt.value === 'N'\n                                ? 'bg-emerald-500 text-white'\n                                : 'bg-amber-500 text-white'\n                              : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400'\n                          }`}\n                        >\n                          {opt.label}\n                        </button>\n                      ))}\n                    </div>\n                  </FormField>\n                </div>\n\n                <div className=\"mt-4\">\n                  <FormField label=\"ประวัติแพ้ยา\">\n                    <AllergyInput\n                      allergies={allergies}\n                      onChange={(newAllergies) => {\n                        setAllergies(newAllergies);\n                        setIsDirty(true);\n                      }}\n                    />\n                  </FormField>\n                </div>\n              </FormSection>\n\n              {/* Family Information */}\n              <FormSection title=\"ข้อมูลครอบครัว\" icon={<Users size={18} />} defaultOpen={false}>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <FormField label=\"ชื่อบิดา\">\n                    <Input\n                      type=\"text\"\n                      value={formData.fathername}\n                      onChange={(e) => updateField('fathername', e.target.value)}\n                      placeholder=\"ชื่อ-นามสกุล บิดา\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"ชื่อมารดา\">\n                    <Input\n                      type=\"text\"\n                      value={formData.mathername}\n                      onChange={(e) => updateField('mathername', e.target.value)}\n                      placeholder=\"ชื่อ-นามสกุล มารดา\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"ชื่อคู่สมรส\" className=\"sm:col-span-2\">\n                    <Input\n                      type=\"text\"\n                      value={formData.spsname}\n                      onChange={(e) => updateField('spsname', e.target.value)}\n                      placeholder=\"ชื่อ-นามสกุล คู่สมรส\"\n                    />\n                  </FormField>\n                </div>\n              </FormSection>\n\n              {/* Emergency Contact */}\n              <FormSection title=\"ผู้ติดต่อฉุกเฉิน\" icon={<AlertCircle size={18} />} defaultOpen={false}>\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n                  <FormField label=\"ชื่อผู้ติดต่อ\">\n                    <Input\n                      type=\"text\"\n                      value={formData.informname}\n                      onChange={(e) => updateField('informname', e.target.value)}\n                      placeholder=\"ชื่อ-นามสกุล\"\n                    />\n                  </FormField>\n\n                  <FormField label=\"เบอร์โทรศัพท์\">\n                    <Input\n                      type=\"tel\"\n                      value={formData.informtel}\n                      onChange={(e) => updateField('informtel', e.target.value.replace(/\\D/g, ''))}\n                      placeholder=\"08XXXXXXXX\"\n                      maxLength={10}\n                    />\n                  </FormField>\n\n                  <FormField label=\"ความสัมพันธ์\">\n                    <CustomSelect\n                      options={relationOptions}\n                      value={formData.informrelation}\n                      onChange={(val) => updateField('informrelation', val)}\n                      placeholder=\"เลือก...\"\n                    />\n                  </FormField>\n                </div>\n              </FormSection>\n            </div>\n\n            {/* Right Column - Photo & Rights */}\n            <div className=\"space-y-6\">\n              {/* Photo */}\n              <FormSection title=\"รูปถ่าย\" icon={<Camera size={18} />} collapsible={false}>\n                <div className=\"flex flex-col items-center gap-4\">\n                  <PatientImageUpload\n                    hn={isNew ? undefined : hn}\n                    currentImage={photo}\n                    onImageChange={handlePhotoChange}\n                    onUpload={!isNew ? handleImageUpload : undefined}\n                    size=\"lg\"\n                    editable={true}\n                  />\n                  <p className=\"text-xs text-slate-400\">\n                    คลิกที่รูปเพื่อถ่ายรูปหรือเลือกไฟล์\n                  </p>\n                  {uploading && (\n                    <p className=\"text-xs text-blue-500 flex items-center gap-1\">\n                      <Loader2 size={12} className=\"animate-spin\" />\n                      กำลังอัปโหลด...\n                    </p>\n                  )}\n                </div>\n              </FormSection>\n\n              {/* Rights */}\n              <FormSection title=\"สิทธิการรักษา\" icon={<Shield size={18} />} collapsible={false}>\n                <FormField label=\"สิทธิการรักษา\" required error={errors.pttype}>\n                  <CustomSelect\n                    options={pttypeOptions}\n                    value={formData.pttype}\n                    onChange={(val) => updateField('pttype', val)}\n                    placeholder=\"เลือกสิทธิ์...\"\n                  />\n                </FormField>\n\n                <div className=\"mt-4 p-3 bg-blue-50 dark:bg-blue-500/10 rounded-xl\">\n                  <p className=\"text-xs text-blue-600 dark:text-blue-400 flex items-center gap-2\">\n                    <Info size={14} />\n                    สามารถตรวจสอบสิทธิ์ได้ที่หน้าส่งตรวจ\n                  </p>\n                </div>\n              </FormSection>\n\n              {/* Summary - Only show when editing */}\n              {!isNew && (\n                <div className=\"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl p-4 space-y-3 shadow-sm\">\n                  <h4 className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">ข้อมูลการลงทะเบียน</h4>\n                  <div className=\"space-y-2 text-xs text-slate-500\">\n                    <p className=\"flex items-center gap-2\">\n                      <Calendar size={12} />\n                      ลงทะเบียน: {patient?.firstday || '-'}\n                    </p>\n                    <p className=\"flex items-center gap-2\">\n                      <FileText size={12} />\n                      อัปเดตล่าสุด: {patient?.lastUpdate || '-'}\n                    </p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* ============================================ */}\n          {/* Mobile Bottom Action Bar */}\n          {/* ============================================ */}\n          <div className=\"fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 p-4 lg:hidden z-40\">\n            <div className=\"flex gap-3 max-w-lg mx-auto\">\n              <button\n                type=\"button\"\n                onClick={handleCancel}\n                className=\"px-4 py-3 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl transition-colors\"\n              >\n                <X size={20} />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className=\"flex-1 py-3 bg-primary-500 text-white rounded-xl font-medium flex items-center justify-center gap-2 disabled:opacity-50\"\n              >\n                {saving ? (\n                  <>\n                    <Loader2 size={20} className=\"animate-spin\" />\n                    กำลังบันทึก...\n                  </>\n                ) : (\n                  <>\n                    <Check size={20} />\n                    บันทึก\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n\n          {/* ============================================ */}\n          {/* Discard Changes Dialog */}\n          {/* ============================================ */}\n          <ConfirmDialog\n            {...discardDialog.dialogProps}\n            variant=\"warning\"\n            title=\"ยกเลิกการแก้ไข?\"\n            message=\"คุณมีการเปลี่ยนแปลงที่ยังไม่ได้บันทึก ต้องการยกเลิกการแก้ไขหรือไม่?\"\n            confirmText=\"ยกเลิก\"\n            cancelText=\"แก้ไขต่อ\"\n          />\n        </form>\n      </div>\n    </AdminLayout>\n  );\n}"],"names":[],"mappings":"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"}}]
}