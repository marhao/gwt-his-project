{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/Icons.tsx"],"sourcesContent":["'use client';\n\nimport {\n  LayoutDashboard,\n  Activity,\n  Users,\n  UserPlus,\n  Calendar,\n  BedDouble,\n  Stethoscope,\n  Pill,\n  FlaskConical,\n  CreditCard,\n  BarChart3,\n  Settings,\n  Search,\n  Bell,\n  Menu,\n  X,\n  ChevronDown,\n  ChevronRight,\n  ChevronLeft,\n  Sun,\n  Moon,\n  Heart,\n  TrendingUp,\n  TrendingDown,\n  List,\n  Plus,\n  FileText,\n  Package,\n  PanelLeft,\n  AlignJustify,\n  LogOut,\n  User,\n  Lock,\n  Eye,\n  EyeOff,\n  AlertCircle,\n  Loader2,\n  Home,\n  FolderOpen,\n  ClipboardList,\n  Syringe,\n  Microscope,\n  Receipt,\n  FileBarChart,\n  Cog,\n  Shield,\n  UserCog,\n  Building,\n  type LucideIcon,\n} from 'lucide-react';\n\n// Icon mapping for dynamic usage\nexport const Icons: Record<string, LucideIcon> = {\n  dashboard: LayoutDashboard,\n  home: Home,\n  emergency: Activity,\n  users: Users,\n  userPlus: UserPlus,\n  user: User,\n  userCog: UserCog,\n  calendar: Calendar,\n  bed: BedDouble,\n  stethoscope: Stethoscope,\n  pill: Pill,\n  flask: FlaskConical,\n  microscope: Microscope,\n  syringe: Syringe,\n  creditCard: CreditCard,\n  receipt: Receipt,\n  chart: BarChart3,\n  fileBarChart: FileBarChart,\n  settings: Settings,\n  cog: Cog,\n  search: Search,\n  bell: Bell,\n  menu: Menu,\n  close: X,\n  chevronDown: ChevronDown,\n  chevronRight: ChevronRight,\n  chevronLeft: ChevronLeft,\n  sun: Sun,\n  moon: Moon,\n  heart: Heart,\n  trendingUp: TrendingUp,\n  trendingDown: TrendingDown,\n  list: List,\n  clipboardList: ClipboardList,\n  plus: Plus,\n  file: FileText,\n  folder: FolderOpen,\n  box: Package,\n  sidebar: PanelLeft,\n  horizontal: AlignJustify,\n  logout: LogOut,\n  lock: Lock,\n  eye: Eye,\n  eyeOff: EyeOff,\n  alertCircle: AlertCircle,\n  loader: Loader2,\n  shield: Shield,\n  building: Building,\n};\n\n// Get icon by name (case-insensitive)\nexport const getIcon = (name: string): LucideIcon => {\n  // Try exact match first\n  if (Icons[name]) return Icons[name];\n\n  // Try lowercase\n  const lowerName = name.toLowerCase();\n  const found = Object.keys(Icons).find((key) => key.toLowerCase() === lowerName);\n\n  return found ? Icons[found] : FileText;\n};\n\n// Re-export commonly used icons\nexport {\n  LayoutDashboard,\n  Activity,\n  Users,\n  UserPlus,\n  Calendar,\n  BedDouble,\n  Stethoscope,\n  Pill,\n  FlaskConical,\n  CreditCard,\n  BarChart3,\n  Settings,\n  Search,\n  Bell,\n  Menu,\n  X,\n  ChevronDown,\n  ChevronRight,\n  ChevronLeft,\n  Sun,\n  Moon,\n  Heart,\n  TrendingUp,\n  TrendingDown,\n  List,\n  Plus,\n  FileText,\n  Package,\n  PanelLeft,\n  AlignJustify,\n  LogOut,\n  User,\n  Lock,\n  Eye,\n  EyeOff,\n  AlertCircle,\n  Loader2,\n};\n\nexport type IconName = keyof typeof Icons;"],"names":[],"mappings":";;;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;;AAuDO,MAAM,QAAoC;IAC/C,WAAW,gQAAe;IAC1B,MAAM,4NAAI;IACV,WAAW,uOAAQ;IACnB,OAAO,8NAAK;IACZ,UAAU,2OAAQ;IAClB,MAAM,2NAAI;IACV,SAAS,wOAAO;IAChB,UAAU,uOAAQ;IAClB,KAAK,8OAAS;IACd,aAAa,gPAAW;IACxB,MAAM,2NAAI;IACV,OAAO,uPAAY;IACnB,YAAY,6OAAU;IACtB,SAAS,oOAAO;IAChB,YAAY,iPAAU;IACtB,SAAS,oOAAO;IAChB,OAAO,gPAAS;IAChB,cAAc,4QAAY;IAC1B,UAAU,uOAAQ;IAClB,KAAK,wNAAG;IACR,QAAQ,iOAAM;IACd,MAAM,2NAAI;IACV,MAAM,2NAAI;IACV,OAAO,kNAAC;IACR,aAAa,oPAAW;IACxB,cAAc,uPAAY;IAC1B,aAAa,oPAAW;IACxB,KAAK,wNAAG;IACR,MAAM,2NAAI;IACV,OAAO,8NAAK;IACZ,YAAY,iPAAU;IACtB,cAAc,uPAAY;IAC1B,MAAM,2NAAI;IACV,eAAe,0PAAa;IAC5B,MAAM,2NAAI;IACV,MAAM,2OAAQ;IACd,QAAQ,iPAAU;IAClB,KAAK,oOAAO;IACZ,SAAS,8OAAS;IAClB,YAAY,+PAAY;IACxB,QAAQ,qOAAM;IACd,MAAM,2NAAI;IACV,KAAK,wNAAG;IACR,QAAQ,qOAAM;IACd,aAAa,oPAAW;IACxB,QAAQ,6OAAO;IACf,QAAQ,iOAAM;IACd,UAAU,uOAAQ;AACpB;AAGO,MAAM,UAAU,CAAC;IACtB,wBAAwB;IACxB,IAAI,KAAK,CAAC,KAAK,EAAE,OAAO,KAAK,CAAC,KAAK;IAEnC,gBAAgB;IAChB,MAAM,YAAY,KAAK,WAAW;IAClC,MAAM,QAAQ,OAAO,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC,MAAQ,IAAI,WAAW,OAAO;IAErE,OAAO,QAAQ,KAAK,CAAC,MAAM,GAAG,2OAAQ;AACxC"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/ToggleSwitch.tsx"],"sourcesContent":["'use client';\n\nimport { FC } from 'react';\n\ninterface ToggleSwitchProps {\n  checked: boolean;\n  onChange: (checked: boolean) => void;\n  leftLabel?: string;\n  rightLabel?: string;\n  leftIcon?: React.ReactNode;\n  rightIcon?: React.ReactNode;\n  size?: 'sm' | 'md';\n}\n\nexport const ToggleSwitch: FC<ToggleSwitchProps> = ({\n  checked,\n  onChange,\n  leftLabel,\n  rightLabel,\n  leftIcon,\n  rightIcon,\n  size = 'md',\n}) => {\n  const sizes = {\n    sm: {\n      switch: 'h-5 w-9',\n      thumb: 'h-4 w-4',\n      translate: 'translate-x-4',\n    },\n    md: {\n      switch: 'h-6 w-11',\n      thumb: 'h-5 w-5',\n      translate: 'translate-x-5',\n    },\n  };\n\n  const s = sizes[size];\n\n  return (\n    <div className=\"flex items-center gap-2\">\n      {leftIcon && <span className=\"text-slate-500 dark:text-slate-400\">{leftIcon}</span>}\n      {leftLabel && (\n        <span className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">\n          {leftLabel}\n        </span>\n      )}\n      \n      <button\n        type=\"button\"\n        role=\"switch\"\n        aria-checked={checked}\n        onClick={() => onChange(!checked)}\n        className={`\n          relative inline-flex shrink-0 cursor-pointer rounded-full\n          border-2 border-transparent transition-colors duration-200 ease-in-out\n          focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2\n          ${s.switch}\n          ${checked ? 'bg-primary-500' : 'bg-slate-300 dark:bg-slate-600'}\n        `}\n      >\n        <span\n          className={`\n            pointer-events-none inline-block transform rounded-full\n            bg-white shadow-lg ring-0 transition duration-200 ease-in-out\n            ${s.thumb}\n            ${checked ? s.translate : 'translate-x-0'}\n          `}\n        />\n      </button>\n\n      {rightLabel && (\n        <span className=\"text-xs font-medium text-slate-500 dark:text-slate-400\">\n          {rightLabel}\n        </span>\n      )}\n      {rightIcon && <span className=\"text-slate-500 dark:text-slate-400\">{rightIcon}</span>}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;;AAcO,MAAM,eAAsC,CAAC,EAClD,OAAO,EACP,QAAQ,EACR,SAAS,EACT,UAAU,EACV,QAAQ,EACR,SAAS,EACT,OAAO,IAAI,EACZ;IACC,MAAM,QAAQ;QACZ,IAAI;YACF,QAAQ;YACR,OAAO;YACP,WAAW;QACb;QACA,IAAI;YACF,QAAQ;YACR,OAAO;YACP,WAAW;QACb;IACF;IAEA,MAAM,IAAI,KAAK,CAAC,KAAK;IAErB,qBACE,2MAAC;QAAI,WAAU;;YACZ,0BAAY,2MAAC;gBAAK,WAAU;0BAAsC;;;;;;YAClE,2BACC,2MAAC;gBAAK,WAAU;0BACb;;;;;;0BAIL,2MAAC;gBACC,MAAK;gBACL,MAAK;gBACL,gBAAc;gBACd,SAAS,IAAM,SAAS,CAAC;gBACzB,WAAW,CAAC;;;;UAIV,EAAE,EAAE,MAAM,CAAC;UACX,EAAE,UAAU,mBAAmB,iCAAiC;QAClE,CAAC;0BAED,cAAA,2MAAC;oBACC,WAAW,CAAC;;;YAGV,EAAE,EAAE,KAAK,CAAC;YACV,EAAE,UAAU,EAAE,SAAS,GAAG,gBAAgB;UAC5C,CAAC;;;;;;;;;;;YAIJ,4BACC,2MAAC;gBAAK,WAAU;0BACb;;;;;;YAGJ,2BAAa,2MAAC;gBAAK,WAAU;0BAAsC;;;;;;;;;;;;AAG1E;KAhEa"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/Dropdown.tsx"],"sourcesContent":["'use client';\n\nimport { FC, useState, useRef, useEffect, ReactNode } from 'react';\nimport { ChevronDown } from 'lucide-react';\n\ninterface DropdownItem {\n  id: string;\n  label: string;\n  href?: string;\n  onClick?: () => void;\n}\n\ninterface DropdownProps {\n  trigger: ReactNode;\n  items: DropdownItem[];\n  align?: 'left' | 'right';\n}\n\nexport const Dropdown: FC<DropdownProps> = ({ trigger, items, align = 'left' }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen]);\n\n  // Close on escape key\n  useEffect(() => {\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isOpen]);\n\n  return (\n    <div ref={dropdownRef} className=\"relative\">\n      {/* Trigger */}\n      <div onClick={() => setIsOpen(!isOpen)} className=\"cursor-pointer\">\n        {trigger}\n      </div>\n\n      {/* Menu */}\n      <div\n        className={`\n          dropdown-menu\n          ${align === 'right' ? 'right-0 left-auto' : 'left-0'}\n          ${isOpen ? 'open' : ''}\n        `}\n      >\n        {items.map((item) => (\n          <a\n            key={item.id}\n            href={item.href || '#'}\n            className=\"dropdown-item\"\n            onClick={(e) => {\n              if (item.onClick) {\n                e.preventDefault();\n                item.onClick();\n              }\n              setIsOpen(false);\n            }}\n          >\n            {item.label}\n          </a>\n        ))}\n      </div>\n    </div>\n  );\n};\n\n// Navigation Dropdown specifically for horizontal menu\ninterface NavDropdownProps {\n  label: string;\n  icon?: ReactNode;\n  items: DropdownItem[];\n  badge?: string | number;\n  badgeColor?: 'primary' | 'success' | 'warning' | 'critical';\n}\n\nexport const NavDropdown: FC<NavDropdownProps> = ({\n  label,\n  icon,\n  items,\n  badge,\n  badgeColor = 'primary',\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const badgeColors = {\n    primary: 'bg-primary-500 text-white',\n    success: 'bg-success-500 text-white',\n    warning: 'bg-warning-500 text-slate-900',\n    critical: 'bg-critical-500 text-white',\n  };\n\n  return (\n    <div ref={dropdownRef} className=\"relative\">\n      {/* Trigger Button */}\n      <button\n        type=\"button\"\n        onClick={() => setIsOpen(!isOpen)}\n        className={`\n          nav-item-horizontal\n          ${isOpen ? 'bg-slate-100 dark:bg-slate-800' : ''}\n        `}\n      >\n        {icon && <span className=\"w-4 h-4\">{icon}</span>}\n        <span>{label}</span>\n        {badge && (\n          <span className={`px-1.5 py-0.5 text-[10px] font-semibold rounded-full ${badgeColors[badgeColor]}`}>\n            {badge}\n          </span>\n        )}\n        <ChevronDown\n          size={12}\n          className={`transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}`}\n        />\n      </button>\n\n      {/* Dropdown Menu */}\n      <div\n        className={`\n          dropdown-menu min-w-44\n          ${isOpen ? 'open' : ''}\n        `}\n      >\n        {items.map((item) => (\n          <a\n            key={item.id}\n            href={item.href || '#'}\n            className=\"dropdown-item\"\n            onClick={(e) => {\n              if (item.onClick) {\n                e.preventDefault();\n                item.onClick();\n              }\n              setIsOpen(false);\n            }}\n          >\n            {item.label}\n          </a>\n        ))}\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 459, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/Badge.tsx"],"sourcesContent":["'use client';\n\nimport { FC, ReactNode } from 'react';\n\ninterface BadgeProps {\n  children: ReactNode;\n  variant?: 'primary' | 'success' | 'warning' | 'critical' | 'default';\n  size?: 'sm' | 'md';\n  pulse?: boolean;\n}\n\nexport const Badge: FC<BadgeProps> = ({\n  children,\n  variant = 'default',\n  size = 'sm',\n  pulse = false,\n}) => {\n  const variants = {\n    primary: 'bg-primary-500 text-white',\n    success: 'bg-success-500 text-white',\n    warning: 'bg-warning-500 text-slate-900',\n    critical: 'bg-critical-500 text-white',\n    default: 'bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300',\n  };\n\n  const sizes = {\n    sm: 'px-1.5 py-0.5 text-[10px]',\n    md: 'px-2 py-0.5 text-xs',\n  };\n\n  return (\n    <span\n      className={`\n        inline-flex items-center justify-center font-semibold rounded-full\n        ${variants[variant]}\n        ${sizes[size]}\n        ${pulse ? 'animate-pulse-subtle' : ''}\n      `}\n    >\n      {children}\n    </span>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;;AAWO,MAAM,QAAwB,CAAC,EACpC,QAAQ,EACR,UAAU,SAAS,EACnB,OAAO,IAAI,EACX,QAAQ,KAAK,EACd;IACC,MAAM,WAAW;QACf,SAAS;QACT,SAAS;QACT,SAAS;QACT,UAAU;QACV,SAAS;IACX;IAEA,MAAM,QAAQ;QACZ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,2MAAC;QACC,WAAW,CAAC;;QAEV,EAAE,QAAQ,CAAC,QAAQ,CAAC;QACpB,EAAE,KAAK,CAAC,KAAK,CAAC;QACd,EAAE,QAAQ,yBAAyB,GAAG;MACxC,CAAC;kBAEA;;;;;;AAGP;KA/Ba"}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/SearchablePatientSelect.tsx"],"sourcesContent":["// src/components/ui/SearchablePatientSelect.tsx\n// Searchable patient select component with dropdown\n// Supports external updates from Smart Card reader\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { User, ChevronDown, Loader2, X, Search, AlertCircle } from 'lucide-react';\nimport { patientApi } from '@/lib/api';\nimport { PatientListItem } from '@/types/patient.types';\n\nexport interface SearchablePatientSelectProps {\n  value: string;\n  onChange: (hn: string, patient: PatientListItem | null, cardPhoto?: string | null) => void;\n  placeholder?: string;\n  disabled?: boolean;\n  initialPatient?: PatientListItem | null;\n  className?: string;\n  limit?: number;\n}\n\nconst SearchablePatientSelect: React.FC<SearchablePatientSelectProps> = ({\n  value,\n  onChange,\n  placeholder = \"พิมพ์ HN หรือชื่อเพื่อค้นหาผู้ป่วย...\",\n  disabled = false,\n  initialPatient = null,\n  className = \"\",\n  limit = 20,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [patients, setPatients] = useState<PatientListItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedPatient, setSelectedPatient] = useState<PatientListItem | null>(initialPatient);\n  const [focusedIndex, setFocusedIndex] = useState(-1);\n  const [dropdownPosition, setDropdownPosition] = useState<'bottom' | 'top'>('bottom');\n  const [error, setError] = useState<string | null>(null);\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // ============================================\n  // Sync with external changes (Smart Card, etc.)\n  // ============================================\n  useEffect(() => {\n    // When initialPatient changes from external source (e.g., Smart Card)\n    if (initialPatient && initialPatient.hn) {\n      setSelectedPatient(initialPatient);\n      setSearchTerm(`${initialPatient.hn} - ${initialPatient.fullName}`);\n      setIsOpen(false);\n      setFocusedIndex(-1);\n    }\n  }, [initialPatient]);\n\n  // Sync when value changes externally (e.g., clear from parent)\n  useEffect(() => {\n    if (!value && selectedPatient) {\n      // Value cleared from parent\n      setSelectedPatient(null);\n      setSearchTerm('');\n    } else if (value && initialPatient && initialPatient.hn === value && selectedPatient?.hn !== value) {\n      // Value set from parent with matching initialPatient\n      setSelectedPatient(initialPatient);\n      setSearchTerm(`${initialPatient.hn} - ${initialPatient.fullName}`);\n    }\n  }, [value, initialPatient]);\n\n  // Calculate dropdown position\n  const calculateDropdownPosition = () => {\n    if (!containerRef.current) return;\n\n    const rect = containerRef.current.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const dropdownHeight = 320; // max-h-80 = 320px\n    const spaceBelow = viewportHeight - rect.bottom;\n    const spaceAbove = rect.top;\n\n    if (spaceBelow < dropdownHeight && spaceAbove > dropdownHeight) {\n      setDropdownPosition('top');\n    } else {\n      setDropdownPosition('bottom');\n    }\n  };\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n        setFocusedIndex(-1);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Calculate position when dropdown opens\n  useEffect(() => {\n    if (isOpen) {\n      calculateDropdownPosition();\n      \n      const handleReposition = () => {\n        if (isOpen) {\n          calculateDropdownPosition();\n        }\n      };\n\n      window.addEventListener('resize', handleReposition);\n      window.addEventListener('scroll', handleReposition, true);\n      \n      return () => {\n        window.removeEventListener('resize', handleReposition);\n        window.removeEventListener('scroll', handleReposition, true);\n      };\n    }\n  }, [isOpen]);\n\n  // Search patients when searchTerm changes\n  useEffect(() => {\n    const performSearch = async () => {\n      // Don't search if we have a selected patient and searchTerm matches\n      if (selectedPatient && searchTerm === `${selectedPatient.hn} - ${selectedPatient.fullName}`) {\n        return;\n      }\n\n      if (searchTerm.length < 2) {\n        setPatients([]);\n        setError(null);\n        return;\n      }\n\n      setLoading(true);\n      setError(null);\n      \n      try {\n        const result = await patientApi.search(searchTerm, limit);\n        setPatients(result);\n      } catch (err) {\n        console.error('Error searching patients:', err);\n        setError('เกิดข้อผิดพลาดในการค้นหา');\n        setPatients([]);\n      }\n      \n      setLoading(false);\n    };\n\n    const debounceTimer = setTimeout(performSearch, 300);\n    return () => clearTimeout(debounceTimer);\n  }, [searchTerm, limit, selectedPatient]);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const term = e.target.value;\n    setSearchTerm(term);\n    setIsOpen(true);\n    setFocusedIndex(-1);\n    \n    // Clear selection if user modifies the input\n    if (selectedPatient && term !== `${selectedPatient.hn} - ${selectedPatient.fullName}`) {\n      setSelectedPatient(null);\n      onChange('', null);\n    }\n  };\n\n  const handlePatientSelect = (patient: PatientListItem) => {\n    setSelectedPatient(patient);\n    setSearchTerm(`${patient.hn} - ${patient.fullName}`);\n    setIsOpen(false);\n    setFocusedIndex(-1);\n    onChange(patient.hn, patient);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (!isOpen || patients.length === 0) {\n      if (e.key === 'ArrowDown' || e.key === 'Enter') {\n        setIsOpen(true);\n      }\n      return;\n    }\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setFocusedIndex(prev => (prev < patients.length - 1 ? prev + 1 : 0));\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setFocusedIndex(prev => (prev > 0 ? prev - 1 : patients.length - 1));\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (focusedIndex >= 0 && patients[focusedIndex]) {\n          handlePatientSelect(patients[focusedIndex]);\n        }\n        break;\n      case 'Escape':\n        setIsOpen(false);\n        setFocusedIndex(-1);\n        inputRef.current?.blur();\n        break;\n    }\n  };\n\n  const clearSelection = () => {\n    setSelectedPatient(null);\n    setSearchTerm('');\n    setPatients([]);\n    setIsOpen(false);\n    onChange('', null);\n    inputRef.current?.focus();\n  };\n\n  const getSexLabel = (sex: string | null) => {\n    if (sex === 'M' || sex === '1') return 'ชาย';\n    if (sex === 'F' || sex === '2') return 'หญิง';\n    return '';\n  };\n\n  const getSexColor = (sex: string | null) => {\n    if (sex === 'M' || sex === '1') return 'text-blue-600 dark:text-blue-400';\n    if (sex === 'F' || sex === '2') return 'text-pink-600 dark:text-pink-400';\n    return 'text-slate-500';\n  };\n\n  return (\n    <div ref={containerRef} className={`relative ${className}`}>\n      <div className=\"relative\">\n        <Search size={18} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" />\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={searchTerm}\n          onChange={handleInputChange}\n          onKeyDown={handleKeyDown}\n          onFocus={() => {\n            // Only open dropdown if not already selected or if typing\n            if (!selectedPatient && searchTerm.length >= 2 && patients.length > 0) {\n              setIsOpen(true);\n            }\n          }}\n          placeholder={placeholder}\n          disabled={disabled}\n          className={`w-full pl-10 pr-12 py-3 border rounded-xl transition-colors duration-200\n            bg-white dark:bg-slate-800 \n            border-slate-200 dark:border-slate-700 \n            text-slate-900 dark:text-white \n            placeholder-slate-400 dark:placeholder-slate-500\n            focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500\n            ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n            ${selectedPatient ? 'bg-primary-50 dark:bg-primary-500/10 border-primary-200 dark:border-primary-500/30' : ''}`}\n        />\n\n        {/* Icons */}\n        <div className=\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1\">\n          {loading && (\n            <Loader2 className=\"w-4 h-4 animate-spin text-slate-400\" />\n          )}\n          {selectedPatient && !loading && (\n            <button\n              type=\"button\"\n              onClick={clearSelection}\n              disabled={disabled}\n              className=\"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-50\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          )}\n          {!selectedPatient && (\n            <ChevronDown className={`w-4 h-4 transition-transform duration-200 text-slate-400 ${\n              isOpen ? 'rotate-180' : ''\n            }`} />\n          )}\n        </div>\n      </div>\n\n      {/* Selected Patient Indicator */}\n      {selectedPatient && (\n        <div className=\"absolute -top-2 left-3 px-2 py-0.5 bg-primary-500 text-white text-xs rounded-full font-medium\">\n          เลือกแล้ว\n        </div>\n      )}\n\n      {/* Dropdown */}\n      {isOpen && !selectedPatient && (\n        <div \n          ref={dropdownRef}\n          className={`absolute z-50 w-full border rounded-xl shadow-xl max-h-80 overflow-auto ${\n            dropdownPosition === 'top' ? 'bottom-full mb-1' : 'top-full mt-1'\n          } bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700`}\n        >\n          {loading && (\n            <div className=\"px-4 py-6 text-center text-sm text-slate-500 dark:text-slate-400\">\n              <Loader2 className=\"w-5 h-5 animate-spin inline mr-2\" />\n              กำลังค้นหาผู้ป่วย...\n            </div>\n          )}\n\n          {error && !loading && (\n            <div className=\"px-4 py-4 text-center text-sm text-red-500 dark:text-red-400 flex items-center justify-center gap-2\">\n              <AlertCircle className=\"w-4 h-4\" />\n              {error}\n            </div>\n          )}\n\n          {!loading && !error && patients.length === 0 && searchTerm.length >= 2 && (\n            <div className=\"px-4 py-6 text-center text-sm text-slate-500 dark:text-slate-400\">\n              <User className=\"w-8 h-8 mx-auto mb-2 text-slate-300 dark:text-slate-600\" />\n              ไม่พบผู้ป่วย &quot;{searchTerm}&quot;\n            </div>\n          )}\n\n          {!loading && !error && patients.length === 0 && searchTerm.length < 2 && (\n            <div className=\"px-4 py-6 text-center text-sm text-slate-500 dark:text-slate-400\">\n              <Search className=\"w-8 h-8 mx-auto mb-2 text-slate-300 dark:text-slate-600\" />\n              พิมพ์อย่างน้อย 2 ตัวอักษรเพื่อค้นหา\n            </div>\n          )}\n\n          {!loading && !error && patients.map((patient, index) => (\n            <button\n              key={patient.hn}\n              type=\"button\"\n              onClick={() => handlePatientSelect(patient)}\n              className={`w-full px-4 py-3 text-left transition-colors duration-150 border-b border-slate-100 dark:border-slate-700 last:border-b-0 ${\n                index === focusedIndex\n                  ? 'bg-primary-50 dark:bg-primary-500/20 text-primary-900 dark:text-primary-100'\n                  : selectedPatient?.hn === patient.hn\n                    ? 'bg-primary-100 dark:bg-primary-600/20 text-primary-900 dark:text-primary-100'\n                    : 'text-slate-900 dark:text-slate-100 hover:bg-slate-50 dark:hover:bg-slate-700/50'\n              }`}\n            >\n              <div className=\"flex items-start gap-3\">\n                <div className=\"size-10 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center shrink-0\">\n                  <User className=\"w-5 h-5 text-slate-500 dark:text-slate-400\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"font-medium\">{patient.fullName}</span>\n                    {patient.hasAllergy && (\n                      <span className=\"px-1.5 py-0.5 bg-red-100 dark:bg-red-500/20 text-red-600 dark:text-red-400 text-xs rounded\">\n                        แพ้ยา\n                      </span>\n                    )}\n                    {patient.isDead && (\n                      <span className=\"px-1.5 py-0.5 bg-slate-200 dark:bg-slate-600 text-slate-600 dark:text-slate-300 text-xs rounded\">\n                        เสียชีวิต\n                      </span>\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-3 text-sm mt-0.5\">\n                    <span className=\"font-mono text-slate-500 dark:text-slate-400\">\n                      HN: {patient.hn}\n                    </span>\n                    {patient.sex && (\n                      <span className={getSexColor(patient.sex)}>\n                        {getSexLabel(patient.sex)}\n                      </span>\n                    )}\n                    {patient.age && (\n                      <span className=\"text-slate-500 dark:text-slate-400\">\n                        {patient.age} ปี\n                      </span>\n                    )}\n                  </div>\n                  {patient.cid && (\n                    <div className=\"text-xs text-slate-400 dark:text-slate-500 mt-0.5\">\n                      CID: {patient.cid.replace(/(\\d{1})(\\d{4})(\\d{5})(\\d{2})(\\d{1})/, '$1-$2-$3-$4-$5')}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport { SearchablePatientSelect };\nexport default SearchablePatientSelect;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1049, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/index.ts"],"sourcesContent":["export * from './Icons';\nexport * from './ToggleSwitch';\nexport * from './Dropdown';\nexport * from './Badge';\nexport { default as SearchablePatientSelect } from './SearchablePatientSelect';\nexport type { SearchablePatientSelectProps } from './SearchablePatientSelect';\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 1189, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n\nimport { CheckCircle, XCircle, AlertCircle, Clock } from 'lucide-react';\nimport React from 'react';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function formatNumber(num: number): string {\n  return new Intl.NumberFormat().format(num);\n}\n\nexport function formatCurrency(amount: number): string {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD'\n  }).format(amount);\n}\n\nexport function formatThaiID(value: string): string {\n  const cleanValue = value.endsWith('-') ? value.slice(0, -1) : value;\n  const numbers = cleanValue.replace(/\\D/g, '').slice(0, 13);\n  \n  let formatted = '';\n  for (let i = 0; i < numbers.length; i++) {\n    if (i === 1 || i === 5 || i === 10 || i === 12) formatted += '-';\n    formatted += numbers[i];\n  }\n  return formatted;\n}\n\nexport const formatThaiDate = (dateStr: string, showTime: boolean = false): string => {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  if (isNaN(date.getTime())) return '';\n\n  const options: Intl.DateTimeFormatOptions = {\n    timeZone: 'Asia/Bangkok',\n    year: 'numeric',\n    month: 'short',\n    day: '2-digit'\n  };\n\n  if (showTime) {\n    options.hour = '2-digit';\n    options.minute = '2-digit';\n    options.hour12 = false; // Use 24-hour format\n  }\n\n  const formatted = date.toLocaleDateString('th-TH', options);\n  return formatted.replace(/(\\d{2})\\s(\\S+)\\s(\\d{4})/, '$1 $2 $3'); // Ensure consistent format\n};\n\nexport const formatDisplayDate = (dateStr: string): string => {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  if (isNaN(date.getTime())) return '';\n\n  return date.toLocaleDateString('th-TH', {\n    timeZone: 'Asia/Bangkok',\n    day: '2-digit',\n    month: 'short',\n    year: 'numeric'\n  });\n};\n\nexport const getCurrentBangkokDate = (): string => {\n  return new Date().toLocaleDateString('en-CA', {\n    timeZone: 'Asia/Bangkok',\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit'\n  });\n};\n\nexport const isTodayInBangkok = (dateStr: string): boolean => {\n  if (!dateStr) return false;\n  return dateStr.split('T')[0] === getCurrentBangkokDate();\n};\n\nexport const isFutureDate = (dateStr: string): boolean => {\n  if (!dateStr) return false;\n  return dateStr.split('T')[0] > getCurrentBangkokDate();\n};\n\nexport const calculateWorkMinutes = (checkIn: string, checkOut: string): number => {\n  try {\n    const inTime = new Date(`2000-01-01T${checkIn}`);\n    const outTime = new Date(`2000-01-01T${checkOut}`);\n    if (outTime < inTime) outTime.setDate(outTime.getDate() + 1);\n    const diffMs = outTime.getTime() - inTime.getTime();\n    return Math.max(0, Math.floor(diffMs / (1000 * 60)));\n  } catch {\n    return 0;\n  }\n};\n\nexport const formatWorkHours = (minutes: number): string => {\n  const hours = Math.floor(minutes / 60);\n  const mins = minutes % 60;\n  return mins === 0 ? `${hours} ชม.` : `${hours} ชม. ${mins} น.`;\n};\n\nexport const getStatusDisplay = (status: string, isDarkMode: boolean) => {\n  const styles = {\n    Present: {\n      icon: React.createElement(CheckCircle, { className: \"w-4 h-4 text-green-600\" }),\n      text: 'เข้างาน',\n      color: isDarkMode ? 'bg-green-900/30 text-green-400' : 'bg-green-100 text-green-800'\n    },\n    Late: {\n      icon: React.createElement(AlertCircle, { className: \"w-4 h-4 text-orange-600\" }),\n      text: 'สาย',\n      color: isDarkMode ? 'bg-orange-900/30 text-orange-400' : 'bg-orange-100 text-orange-800'\n    },\n    Absent: {\n      icon: React.createElement(XCircle, { className: \"w-4 h-4 text-red-600\" }),\n      text: 'ขาด',\n      color: isDarkMode ? 'bg-red-900/30 text-red-400' : 'bg-red-100 text-red-800'\n    },\n    Incomplete: {\n      icon: React.createElement(Clock, { className: \"w-4 h-4 text-blue-600\" }),\n      text: 'ไม่สมบูรณ์',\n      color: isDarkMode ? 'bg-blue-900/30 text-blue-400' : 'bg-blue-100 text-blue-800'\n    }\n  };\n  return styles[status as keyof typeof styles] || {\n    icon: React.createElement(Clock, { className: \"w-4 h-4 text-gray-600\" }),\n    text: 'ไม่ทราบ',\n    color: isDarkMode ? 'bg-gray-700/50 text-gray-400' : 'bg-gray-100 text-gray-800'\n  };\n};\n\nexport const getDisplayValue = (val: string) => {\n  const displayMap: { [key: string]: string } = {\n    all: 'ทุกสถานะ',\n    Present: 'เข้างาน',\n    Late: 'สาย',\n    Absent: 'ขาด',\n    Incomplete: 'ไม่สมบูรณ์',\n    morning: 'เวรเช้า',\n    afternoon: 'เวรบ่าย',\n    night: 'เวรดึก'\n  };\n  return displayMap[val] || val;\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1370, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/Sidebar.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/Sidebar.tsx\n// Description: Modern Sidebar - Glassmorphism design with smooth animations\n//              Hidden scrollbar, portal tooltips, flyout menu for collapsed mode\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { createPortal } from 'react-dom';\nimport {\n  ChevronDown,\n  ChevronRight,\n  Search,\n  X,\n  Settings,\n  Moon,\n  Sun,\n  PanelLeftClose,\n  PanelLeft,\n  Sparkles,\n  LogOut,\n} from 'lucide-react';\nimport { useMenuContext, MenuAccessItem } from '@/components/providers/MenuProvider';\nimport { getIcon } from '@/components/ui';\nimport { cn } from '@/lib/utils';\nimport { useAuth } from '../providers/AuthProvider';\n\n// ============================================\n// Types\n// ============================================\n\ninterface SidebarProps {\n  collapsed?: boolean;\n  onToggle?: () => void;\n}\n\n// ============================================\n// Flyout Menu Component (Portal-based) - For Collapsed Mode\n// ============================================\n\ninterface FlyoutMenuProps {\n  menu: MenuAccessItem;\n  show: boolean;\n  position: { top: number; left: number };\n  onClose: () => void;\n  pathname: string;\n}\n\nconst FlyoutMenu: React.FC<FlyoutMenuProps> = ({ menu, show, position, onClose, pathname }) => {\n  const [mounted, setMounted] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // Close on click outside\n  useEffect(() => {\n    if (!show) return;\n    \n    const handleClickOutside = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\n        onClose();\n      }\n    };\n\n    // Delay to prevent immediate close\n    const timer = setTimeout(() => {\n      document.addEventListener('mousedown', handleClickOutside);\n    }, 100);\n\n    return () => {\n      clearTimeout(timer);\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [show, onClose]);\n\n  if (!mounted || !show) return null;\n\n  const menuName = menu.menu_name_th || menu.menu_name;\n  const children = menu.children || [];\n\n  const isChildActive = (child: MenuAccessItem): boolean => {\n    if (child.route_path === pathname) return true;\n    if (child.route_path && pathname.startsWith(child.route_path + '/')) return true;\n    return false;\n  };\n\n  // Adjust position to stay within viewport\n  const adjustedTop = Math.min(position.top, window.innerHeight - 350);\n\n  return createPortal(\n    <div\n      ref={menuRef}\n      className=\"fixed z-[9999] min-w-[220px] py-2 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-700 animate-in fade-in-0 zoom-in-95 slide-in-from-left-2 duration-150\"\n      style={{\n        top: Math.max(8, adjustedTop),\n        left: position.left,\n      }}\n    >\n      {/* Header */}\n      <div className=\"px-4 py-2.5 border-b border-slate-100 dark:border-slate-700\">\n        <span className=\"text-sm font-semibold text-slate-800 dark:text-white\">{menuName}</span>\n      </div>\n\n      {/* Menu Items */}\n      <div className=\"py-1 max-h-[300px] overflow-y-auto\">\n        {children.map((child, idx) => {\n          const ChildIcon = getIcon(child.icon || 'file');\n          const childName = child.menu_name_th || child.menu_name;\n          const isActive = isChildActive(child);\n\n          return (\n            <Link\n              key={child.id || child.menu_code || idx}\n              href={child.route_path || '#'}\n              onClick={onClose}\n              className={cn(\n                'flex items-center gap-3 px-4 py-2.5 mx-1.5 rounded-lg text-sm transition-all',\n                isActive\n                  ? 'bg-primary-50 dark:bg-primary-500/10 text-primary-600 dark:text-primary-400 font-medium'\n                  : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700/50 hover:text-slate-900 dark:hover:text-white'\n              )}\n            >\n              <ChildIcon size={16} className=\"shrink-0\" />\n              <span className=\"truncate flex-1\">{childName}</span>\n              {child.badge_count && child.badge_count > 0 && (\n                <span className=\"px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full\">\n                  {child.badge_count > 99 ? '99+' : child.badge_count}\n                </span>\n              )}\n            </Link>\n          );\n        })}\n\n        {children.length === 0 && (\n          <div className=\"px-4 py-4 text-center text-sm text-slate-400\">\n            ไม่มีเมนูย่อย\n          </div>\n        )}\n      </div>\n    </div>,\n    document.body\n  );\n};\n\n// ============================================\n// Tooltip Component (Portal-based)\n// ============================================\n\ninterface TooltipProps {\n  content: string;\n  show: boolean;\n  position: { top: number; left: number };\n}\n\nconst Tooltip: React.FC<TooltipProps> = ({ content, show, position }) => {\n  const [mounted, setMounted] = useState(false);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  if (!mounted || !show) return null;\n\n  return createPortal(\n    <div\n      className=\"fixed z-[9999] px-3 py-2 bg-slate-900 dark:bg-slate-700 text-white text-sm rounded-xl shadow-xl whitespace-nowrap pointer-events-none animate-in fade-in-0 zoom-in-95 duration-150\"\n      style={{\n        top: position.top,\n        left: position.left,\n      }}\n    >\n      {content}\n      <div className=\"absolute left-0 top-1/2 -translate-x-1 -translate-y-1/2 border-4 border-transparent border-r-slate-900 dark:border-r-slate-700\" />\n    </div>,\n    document.body\n  );\n};\n\n// ============================================\n// Menu Item Component\n// ============================================\n\ninterface MenuItemProps {\n  menu: MenuAccessItem;\n  level: number;\n  collapsed: boolean;\n  isActive: boolean;\n  isParentActive: boolean;\n  isExpanded: boolean;\n  hasChildren: boolean;\n  onToggle: () => void;\n  onFlyoutOpen: (menu: MenuAccessItem, position: { top: number; left: number }) => void;\n  pathname: string;\n}\n\nconst MenuItem: React.FC<MenuItemProps> = ({\n  menu,\n  level,\n  collapsed,\n  isActive,\n  isParentActive,\n  isExpanded,\n  hasChildren,\n  onToggle,\n  onFlyoutOpen,\n  pathname,\n}) => {\n  const [showTooltip, setShowTooltip] = useState(false);\n  const [tooltipPosition, setTooltipPosition] = useState({ top: 0, left: 0 });\n  const itemRef = useRef<HTMLDivElement>(null);\n\n  const Icon = getIcon(menu.icon || 'file');\n  const menuName = menu.menu_name_th || menu.menu_name;\n  const badge = menu.badge_count;\n\n  const handleMouseEnter = () => {\n    if (collapsed && itemRef.current && !hasChildren) {\n      const rect = itemRef.current.getBoundingClientRect();\n      setTooltipPosition({\n        top: rect.top + rect.height / 2 - 16,\n        left: rect.right + 12,\n      });\n      setShowTooltip(true);\n    }\n  };\n\n  const handleMouseLeave = () => {\n    setShowTooltip(false);\n  };\n\n  const handleClick = (e: React.MouseEvent) => {\n    if (collapsed && hasChildren && itemRef.current) {\n      e.preventDefault();\n      e.stopPropagation();\n      const rect = itemRef.current.getBoundingClientRect();\n      onFlyoutOpen(menu, {\n        top: rect.top,\n        left: rect.right + 8,\n      });\n    } else if (hasChildren) {\n      onToggle();\n    }\n  };\n\n  // Base classes for all menu items\n  const baseClasses = cn(\n    'group relative flex items-center gap-3 rounded-xl transition-all duration-200',\n    'focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500/50',\n    collapsed ? 'px-3 py-3 justify-center' : 'px-3 py-2.5'\n  );\n\n  // Style based on level and state\n  const getItemClasses = () => {\n    if (isActive) {\n      if (level > 0) {\n        return 'bg-primary-50/80 dark:bg-primary-500/10 text-primary-600 dark:text-primary-400 font-medium';\n      }\n      return 'bg-gradient-to-r from-primary-500 to-primary-600 text-white shadow-lg shadow-primary-500/25';\n    }\n    \n    if (isParentActive) {\n      return 'bg-primary-50/50 dark:bg-primary-500/5 text-primary-600 dark:text-primary-400';\n    }\n    \n    return 'text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 hover:text-slate-900 dark:hover:text-white';\n  };\n\n  const itemContent = (\n    <>\n      {/* Active indicator for submenu */}\n      {isActive && level > 0 && !collapsed && (\n        <span className=\"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-5 bg-primary-500 rounded-r-full\" />\n      )}\n\n      {/* Icon */}\n      <span className={cn(\n        'flex items-center justify-center transition-all duration-200 shrink-0',\n        isActive && level === 0 ? 'scale-110' : '',\n        level > 0 && 'w-5'\n      )}>\n        {level > 0 && !collapsed ? (\n          <span className={cn(\n            'w-1.5 h-1.5 rounded-full transition-colors',\n            isActive ? 'bg-primary-500' : 'bg-slate-300 dark:bg-slate-600'\n          )} />\n        ) : (\n          <Icon size={20} />\n        )}\n      </span>\n\n      {!collapsed && (\n        <>\n          <span className={cn(\n            \"flex-1 text-sm truncate transition-colors text-left\",\n            level > 0 ? 'font-normal' : 'font-medium'\n          )}>\n            {menuName}\n          </span>\n\n          {badge && badge > 0 && (\n            <span className={cn(\n              \"px-1.5 py-0.5 text-xs font-bold rounded-full min-w-[20px] text-center shrink-0\",\n              isActive && level === 0\n                ? \"bg-white/20 text-white\"\n                : \"bg-red-500 text-white\"\n            )}>\n              {badge > 99 ? '99+' : badge}\n            </span>\n          )}\n\n          {hasChildren && (\n            <ChevronDown\n              size={16}\n              className={cn(\n                'text-slate-400 transition-transform duration-300 shrink-0',\n                isExpanded && 'rotate-180',\n                isActive && level === 0 && 'text-white/70'\n              )}\n            />\n          )}\n        </>\n      )}\n\n      {/* Collapsed: badge indicator */}\n      {collapsed && badge && badge > 0 && (\n        <span className=\"absolute -top-1 -right-1 size-4 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center ring-2 ring-white dark:ring-slate-900\">\n          {badge > 9 ? '9+' : badge}\n        </span>\n      )}\n\n      {/* Collapsed: arrow indicator for menus with children */}\n      {collapsed && hasChildren && (\n        <span className=\"absolute -right-0.5 top-1/2 -translate-y-1/2\">\n          <ChevronRight size={12} className=\"text-slate-400\" />\n        </span>\n      )}\n\n      {/* Active glow effect */}\n      {isActive && level === 0 && !collapsed && (\n        <span className=\"absolute inset-0 rounded-xl bg-primary-500/20 blur-xl -z-10\" />\n      )}\n    </>\n  );\n\n  return (\n    <div\n      ref={itemRef}\n      onMouseEnter={handleMouseEnter}\n      onMouseLeave={handleMouseLeave}\n    >\n      {hasChildren ? (\n        <button\n          onClick={handleClick}\n          className={cn(baseClasses, getItemClasses(), 'w-full')}\n        >\n          {itemContent}\n        </button>\n      ) : (\n        <Link\n          href={menu.route_path || '#'}\n          className={cn(baseClasses, getItemClasses())}\n        >\n          {itemContent}\n        </Link>\n      )}\n\n      {/* Tooltip only for items without children in collapsed mode */}\n      <Tooltip\n        content={menuName}\n        show={showTooltip && collapsed && !hasChildren}\n        position={tooltipPosition}\n      />\n    </div>\n  );\n};\n\n// ============================================\n// Main Sidebar Component\n// ============================================\n\nexport function Sidebar({ collapsed = false, onToggle }: SidebarProps) {\n  const pathname = usePathname();\n  const { menus, isLoading, error } = useMenuContext();\n\n  const [expandedMenus, setExpandedMenus] = useState<Set<number | string>>(new Set());\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [mounted, setMounted] = useState(false);\n  const [searchFocused, setSearchFocused] = useState(false);\n\n  // Flyout state\n  const [flyoutMenu, setFlyoutMenu] = useState<MenuAccessItem | null>(null);\n  const [flyoutPosition, setFlyoutPosition] = useState({ top: 0, left: 0 });\n\n  const searchInputRef = useRef<HTMLInputElement>(null);\n  const { user, logout } = useAuth();\n\n  // Mount check\n  useEffect(() => {\n    setMounted(true);\n    setIsDarkMode(document.documentElement.classList.contains('dark'));\n  }, []);\n\n  // Close flyout when sidebar expands\n  useEffect(() => {\n    if (!collapsed) {\n      setFlyoutMenu(null);\n    }\n  }, [collapsed]);\n\n  const handleLogout = () => {\n    logout();\n  };\n\n  const handleFlyoutOpen = (menu: MenuAccessItem, position: { top: number; left: number }) => {\n    // Toggle flyout - if same menu clicked, close it\n    if (flyoutMenu?.id === menu.id || flyoutMenu?.menu_code === menu.menu_code) {\n      setFlyoutMenu(null);\n    } else {\n      setFlyoutMenu(menu);\n      setFlyoutPosition(position);\n    }\n  };\n\n  const handleFlyoutClose = () => {\n    setFlyoutMenu(null);\n  };\n\n  // Auto-expand active menu on mount\n  useEffect(() => {\n    const findActiveParent = (items: MenuAccessItem[], parentIds: (number | string)[] = []): (number | string)[] => {\n      for (const item of items) {\n        if (item.route_path === pathname) {\n          return parentIds;\n        }\n        if (item.children?.length) {\n          const found = findActiveParent(item.children, [...parentIds, item.id || item.menu_code]);\n          if (found.length > parentIds.length) {\n            return found;\n          }\n        }\n      }\n      return [];\n    };\n\n    const activeParents = findActiveParent(menus);\n    if (activeParents.length > 0) {\n      setExpandedMenus((prev) => new Set([...prev, ...activeParents]));\n    }\n  }, [menus, pathname]);\n\n  // Toggle menu expand\n  const toggleExpand = useCallback((menuId: number | string) => {\n    setExpandedMenus((prev) => {\n      const next = new Set(prev);\n      if (next.has(menuId)) {\n        next.delete(menuId);\n      } else {\n        next.add(menuId);\n      }\n      return next;\n    });\n  }, []);\n\n  // Check active state\n  const isActive = useCallback((menu: MenuAccessItem): boolean => {\n    if (menu.route_path === pathname) return true;\n    if (menu.route_path && pathname.startsWith(menu.route_path + '/')) return true;\n    return false;\n  }, [pathname]);\n\n  const isParentActive = useCallback((menu: MenuAccessItem): boolean => {\n    if (isActive(menu)) return true;\n    if (menu.children?.length) {\n      return menu.children.some((child) => isParentActive(child));\n    }\n    return false;\n  }, [isActive]);\n\n  // Filter menus by search\n  const filterMenus = useCallback((items: MenuAccessItem[], query: string): MenuAccessItem[] => {\n    if (!query) return items;\n\n    const lowerQuery = query.toLowerCase();\n\n    return items.reduce<MenuAccessItem[]>((acc, item) => {\n      const matchesName = (item.menu_name_th || item.menu_name || '').toLowerCase().includes(lowerQuery);\n      const filteredChildren = item.children ? filterMenus(item.children, query) : [];\n\n      if (matchesName || filteredChildren.length > 0) {\n        acc.push({\n          ...item,\n          children: filteredChildren.length > 0 ? filteredChildren : item.children,\n        });\n      }\n\n      return acc;\n    }, []);\n  }, []);\n\n  const filteredMenus = filterMenus(menus, searchQuery);\n\n  // Get menu key\n  const getMenuKey = (menu: MenuAccessItem, index: number): string => {\n    if (menu.id) return `menu-${menu.id}`;\n    if (menu.menu_code) return `menu-${menu.menu_code}`;\n    return `menu-idx-${index}`;\n  };\n\n  // Toggle dark mode\n  const toggleDarkMode = () => {\n    document.documentElement.classList.toggle('dark');\n    setIsDarkMode(!isDarkMode);\n  };\n\n  // Render menu item recursively\n  const renderMenuItem = (menu: MenuAccessItem, index: number, level: number = 0) => {\n    if (menu.can_view === false) return null;\n\n    const hasChildren = menu.children && menu.children.length > 0;\n    const isExpanded = expandedMenus.has(menu.id || menu.menu_code) || !!(searchQuery && hasChildren);\n    const active = isActive(menu);\n    const parentActive = isParentActive(menu);\n    const key = getMenuKey(menu, index);\n\n    return (\n      <div key={key} className=\"mb-1\">\n        <MenuItem\n          menu={menu}\n          level={level}\n          collapsed={collapsed}\n          isActive={active}\n          isParentActive={parentActive && !active}\n          isExpanded={isExpanded}\n          hasChildren={hasChildren || false}\n          onToggle={() => toggleExpand(menu.id || menu.menu_code)}\n          onFlyoutOpen={handleFlyoutOpen}\n          pathname={pathname}\n        />\n\n        {/* Nested Children with smooth animation - Only when not collapsed */}\n        {hasChildren && !collapsed && (\n          <div\n            className={cn(\n              'grid transition-all duration-300 ease-in-out',\n              isExpanded ? 'grid-rows-[1fr] opacity-100' : 'grid-rows-[0fr] opacity-0'\n            )}\n          >\n            <div className=\"overflow-hidden\">\n              <div className=\"mt-1 ml-3 pl-3 border-l-2 border-slate-200/50 dark:border-slate-700/50 space-y-0.5\">\n                {menu.children!.map((child, childIndex) => renderMenuItem(child, childIndex, level + 1))}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (!mounted) return null;\n\n  return (\n    <>\n      <aside\n        className={cn(\n          'fixed left-0 top-0 z-40 h-screen',\n          'flex flex-col',\n          'bg-white/80 dark:bg-slate-900/80',\n          'backdrop-blur-xl',\n          'border-r border-slate-200/50 dark:border-slate-800/50',\n          'transition-all duration-300 ease-in-out',\n          collapsed ? 'w-20' : 'w-64'\n        )}\n      >\n        {/* Logo Section */}\n        <div className={cn(\n          'h-16 flex items-center shrink-0 border-b border-slate-200/50 dark:border-slate-800/50',\n          collapsed ? 'justify-center px-2' : 'justify-between px-4'\n        )}>\n          <Link href=\"/\" className=\"flex items-center gap-3 group\">\n            <div className=\"relative\">\n              <div className=\"size-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25 group-hover:shadow-primary-500/40 transition-all group-hover:scale-105\">\n                <span className=\"text-white font-bold text-lg\">K</span>\n              </div>\n              <div className=\"absolute inset-0 rounded-xl bg-primary-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity\" />\n            </div>\n            {!collapsed && (\n              <div className=\"overflow-hidden\">\n                <h1 className=\"font-bold text-slate-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors\">\n                  GWT-MED\n                </h1>\n                <p className=\"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1\">\n                  <Sparkles size={10} className=\"text-amber-500\" />\n                  Smart Hospital\n                </p>\n              </div>\n            )}\n          </Link>\n        </div>\n\n        {/* Search Section */}\n        {!collapsed && (\n          <div className=\"p-3 shrink-0 border-b border-slate-200/50 dark:border-slate-800/50\">\n            <div className={cn(\n              \"relative transition-all duration-300\",\n              searchFocused && \"scale-[1.02]\"\n            )}>\n              <Search size={16} className={cn(\n                \"absolute left-3 top-1/2 -translate-y-1/2 transition-colors\",\n                searchFocused ? \"text-primary-500\" : \"text-slate-400\"\n              )} />\n              <input\n                ref={searchInputRef}\n                type=\"text\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                onFocus={() => setSearchFocused(true)}\n                onBlur={() => setSearchFocused(false)}\n                placeholder=\"ค้นหาเมนู...\"\n                className={cn(\n                  \"w-full pl-9 pr-8 py-2.5 rounded-xl text-sm transition-all duration-300\",\n                  \"bg-slate-100/80 dark:bg-slate-800/50\",\n                  \"border border-transparent\",\n                  \"placeholder:text-slate-400\",\n                  \"focus:outline-none focus:bg-white dark:focus:bg-slate-800\",\n                  \"focus:border-primary-500/50 focus:ring-2 focus:ring-primary-500/20\"\n                )}\n              />\n              {searchQuery && (\n                <button\n                  onClick={() => setSearchQuery('')}\n                  className=\"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-lg hover:bg-slate-200/50 dark:hover:bg-slate-700/50 transition-colors\"\n                >\n                  <X size={14} />\n                </button>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Navigation */}\n        <nav\n          className={cn(\n            'flex-1 overflow-y-auto p-3 space-y-1',\n            '[&::-webkit-scrollbar]:hidden',\n            '[-ms-overflow-style:none]',\n            '[scrollbar-width:none]'\n          )}\n        >\n          {isLoading ? (\n            <div className=\"flex flex-col items-center justify-center py-8 gap-3\">\n              <div className=\"size-8 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\n              {!collapsed && (\n                <span className=\"text-sm text-slate-500\">กำลังโหลด...</span>\n              )}\n            </div>\n          ) : error ? (\n            <div className=\"p-4 bg-red-50/80 dark:bg-red-500/10 rounded-xl border border-red-200/50 dark:border-red-500/20\">\n              {!collapsed && (\n                <p className=\"text-sm text-red-600 dark:text-red-400\">{error}</p>\n              )}\n            </div>\n          ) : filteredMenus.length === 0 ? (\n            <div className=\"text-center py-8\">\n              {!collapsed && (\n                <div className=\"space-y-2\">\n                  <div className=\"size-12 mx-auto bg-slate-100/80 dark:bg-slate-800/50 rounded-xl flex items-center justify-center\">\n                    <Search size={24} className=\"text-slate-400\" />\n                  </div>\n                  <p className=\"text-sm text-slate-500\">\n                    {searchQuery ? 'ไม่พบเมนูที่ค้นหา' : 'ไม่มีเมนูในระบบ'}\n                  </p>\n                </div>\n              )}\n            </div>\n          ) : (\n            filteredMenus.map((menu, index) => renderMenuItem(menu, index))\n          )}\n        </nav>\n\n        {/* User Section */}\n        {!collapsed && (\n          <div className=\"p-3 shrink-0 border-t border-slate-200/50 dark:border-slate-800/50\">\n            <div className=\"flex items-center gap-3 p-2.5 rounded-xl bg-slate-50/80 dark:bg-slate-800/30 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 transition-all cursor-pointer group\">\n              <div className=\"relative\">\n                <div className=\"size-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-md group-hover:shadow-lg group-hover:shadow-primary-500/25 transition-all\">\n                  <span className=\"text-white font-semibold text-sm\">\n                    {user?.name?.charAt(0) || 'U'}\n                  </span>\n                </div>\n                <span className=\"absolute -bottom-0.5 -right-0.5 size-3 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full\" />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-slate-900 dark:text-white truncate\">\n                  {user?.name || 'ผู้ดูแลระบบ'}\n                </p>\n                <p className=\"text-xs text-slate-500 truncate\">{user?.username || 'admin@hospital.go.th'}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Footer Actions */}\n        <div className={cn(\n          'shrink-0 border-t border-slate-200/50 dark:border-slate-800/50',\n          collapsed ? 'p-2' : 'p-3'\n        )}>\n          <div className={cn(\n            'flex items-center',\n            collapsed ? 'flex-col gap-2' : 'justify-between'\n          )}>\n            {/* Dark Mode Toggle */}\n            <button\n              onClick={toggleDarkMode}\n              className={cn(\n                \"p-2.5 rounded-xl transition-all active:scale-95\",\n                isDarkMode\n                  ? \"text-amber-500 hover:bg-amber-500/10\"\n                  : \"text-slate-400 hover:text-slate-600 hover:bg-slate-100/80 dark:hover:bg-slate-800/50\"\n              )}\n              title={isDarkMode ? 'Light Mode' : 'Dark Mode'}\n            >\n              {isDarkMode ? <Sun size={18} /> : <Moon size={18} />}\n            </button>\n\n            {/* Settings */}\n            {!collapsed && (\n              <Link\n                href=\"/settings\"\n                className=\"p-2.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 rounded-xl transition-all active:scale-95\"\n                title=\"ตั้งค่า\"\n              >\n                <Settings size={18} />\n              </Link>\n            )}\n\n            {/* Collapse Toggle */}\n            <button\n              onClick={onToggle}\n              className=\"p-2.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/50 rounded-xl transition-all active:scale-95\"\n              title={collapsed ? 'ขยาย Sidebar' : 'ย่อ Sidebar'}\n            >\n              {collapsed ? <PanelLeft size={18} /> : <PanelLeftClose size={18} />}\n            </button>\n\n            {/* Logout */}\n            {!collapsed && (\n              <button\n                onClick={handleLogout}\n                className=\"p-2.5 text-slate-400 hover:text-red-500 hover:bg-red-50/80 dark:hover:bg-red-500/10 rounded-xl transition-all active:scale-95\"\n                title=\"ออกจากระบบ\"\n              >\n                <LogOut size={18} />\n              </button>\n            )}\n          </div>\n        </div>\n      </aside>\n\n      {/* Flyout Menu Portal - For Collapsed Mode */}\n      {flyoutMenu && (\n        <FlyoutMenu\n          menu={flyoutMenu}\n          show={true}\n          position={flyoutPosition}\n          onClose={handleFlyoutClose}\n          pathname={pathname}\n        />\n      )}\n    </>\n  );\n}\n\nexport default Sidebar;"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,0CAA0C;AAC1C,4EAA4E;AAC5E,iFAAiF;AACjF,gFAAgF;;;;;;;;AAIhF;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;AAAA;AACA;AACA;;;AAtBA;;;;;;;;;;AA6CA,MAAM,aAAwC,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE;;IACxF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uLAAQ,EAAC;IACvC,MAAM,UAAU,IAAA,qLAAM,EAAiB;IAEvC,IAAA,wLAAS;gCAAC;YACR,WAAW;QACb;+BAAG,EAAE;IAEL,yBAAyB;IACzB,IAAA,wLAAS;gCAAC;YACR,IAAI,CAAC,MAAM;YAEX,MAAM;2DAAqB,CAAC;oBAC1B,IAAI,QAAQ,OAAO,IAAI,CAAC,QAAQ,OAAO,CAAC,QAAQ,CAAC,EAAE,MAAM,GAAW;wBAClE;oBACF;gBACF;;YAEA,mCAAmC;YACnC,MAAM,QAAQ;8CAAW;oBACvB,SAAS,gBAAgB,CAAC,aAAa;gBACzC;6CAAG;YAEH;wCAAO;oBACL,aAAa;oBACb,SAAS,mBAAmB,CAAC,aAAa;gBAC5C;;QACF;+BAAG;QAAC;QAAM;KAAQ;IAElB,IAAI,CAAC,WAAW,CAAC,MAAM,OAAO;IAE9B,MAAM,WAAW,KAAK,YAAY,IAAI,KAAK,SAAS;IACpD,MAAM,WAAW,KAAK,QAAQ,IAAI,EAAE;IAEpC,MAAM,gBAAgB,CAAC;QACrB,IAAI,MAAM,UAAU,KAAK,UAAU,OAAO;QAC1C,IAAI,MAAM,UAAU,IAAI,SAAS,UAAU,CAAC,MAAM,UAAU,GAAG,MAAM,OAAO;QAC5E,OAAO;IACT;IAEA,0CAA0C;IAC1C,MAAM,cAAc,KAAK,GAAG,CAAC,SAAS,GAAG,EAAE,OAAO,WAAW,GAAG;IAEhE,qBAAO,IAAA,kMAAY,gBACjB,2MAAC;QACC,KAAK;QACL,WAAU;QACV,OAAO;YACL,KAAK,KAAK,GAAG,CAAC,GAAG;YACjB,MAAM,SAAS,IAAI;QACrB;;0BAGA,2MAAC;gBAAI,WAAU;0BACb,cAAA,2MAAC;oBAAK,WAAU;8BAAwD;;;;;;;;;;;0BAI1E,2MAAC;gBAAI,WAAU;;oBACZ,SAAS,GAAG,CAAC,CAAC,OAAO;wBACpB,MAAM,YAAY,mKAAQ,MAAM,IAAI,IAAI;wBACxC,MAAM,YAAY,MAAM,YAAY,IAAI,MAAM,SAAS;wBACvD,MAAM,WAAW,cAAc;wBAE/B,qBACE,2MAAC,wLAAI;4BAEH,MAAM,MAAM,UAAU,IAAI;4BAC1B,SAAS;4BACT,WAAW,gJACT,gFACA,WACI,4FACA;;8CAGN,2MAAC;oCAAU,MAAM;oCAAI,WAAU;;;;;;8CAC/B,2MAAC;oCAAK,WAAU;8CAAmB;;;;;;gCAClC,MAAM,WAAW,IAAI,MAAM,WAAW,GAAG,mBACxC,2MAAC;oCAAK,WAAU;8CACb,MAAM,WAAW,GAAG,KAAK,QAAQ,MAAM,WAAW;;;;;;;2BAdlD,MAAM,EAAE,IAAI,MAAM,SAAS,IAAI;;;;;oBAmB1C;oBAEC,SAAS,MAAM,KAAK,mBACnB,2MAAC;wBAAI,WAAU;kCAA+C;;;;;;;;;;;;;;;;;kDAMpE,SAAS,IAAI;AAEjB;GAhGM;KAAA;AA4GN,MAAM,UAAkC,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE;;IAClE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uLAAQ,EAAC;IAEvC,IAAA,wLAAS;6BAAC;YACR,WAAW;QACb;4BAAG,EAAE;IAEL,IAAI,CAAC,WAAW,CAAC,MAAM,OAAO;IAE9B,qBAAO,IAAA,kMAAY,gBACjB,2MAAC;QACC,WAAU;QACV,OAAO;YACL,KAAK,SAAS,GAAG;YACjB,MAAM,SAAS,IAAI;QACrB;;YAEC;0BACD,2MAAC;gBAAI,WAAU;;;;;;;;;;;kDAEjB,SAAS,IAAI;AAEjB;IAtBM;MAAA;AAyCN,MAAM,WAAoC,CAAC,EACzC,IAAI,EACJ,KAAK,EACL,SAAS,EACT,QAAQ,EACR,cAAc,EACd,UAAU,EACV,WAAW,EACX,QAAQ,EACR,YAAY,EACZ,QAAQ,EACT;;IACC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,uLAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,uLAAQ,EAAC;QAAE,KAAK;QAAG,MAAM;IAAE;IACzE,MAAM,UAAU,IAAA,qLAAM,EAAiB;IAEvC,MAAM,OAAO,IAAA,6JAAO,EAAC,KAAK,IAAI,IAAI;IAClC,MAAM,WAAW,KAAK,YAAY,IAAI,KAAK,SAAS;IACpD,MAAM,QAAQ,KAAK,WAAW;IAE9B,MAAM,mBAAmB;QACvB,IAAI,aAAa,QAAQ,OAAO,IAAI,CAAC,aAAa;YAChD,MAAM,OAAO,QAAQ,OAAO,CAAC,qBAAqB;YAClD,mBAAmB;gBACjB,KAAK,KAAK,GAAG,GAAG,KAAK,MAAM,GAAG,IAAI;gBAClC,MAAM,KAAK,KAAK,GAAG;YACrB;YACA,eAAe;QACjB;IACF;IAEA,MAAM,mBAAmB;QACvB,eAAe;IACjB;IAEA,MAAM,cAAc,CAAC;QACnB,IAAI,aAAa,eAAe,QAAQ,OAAO,EAAE;YAC/C,EAAE,cAAc;YAChB,EAAE,eAAe;YACjB,MAAM,OAAO,QAAQ,OAAO,CAAC,qBAAqB;YAClD,aAAa,MAAM;gBACjB,KAAK,KAAK,GAAG;gBACb,MAAM,KAAK,KAAK,GAAG;YACrB;QACF,OAAO,IAAI,aAAa;YACtB;QACF;IACF;IAEA,kCAAkC;IAClC,MAAM,cAAc,IAAA,0IAAE,EACpB,iFACA,6EACA,YAAY,6BAA6B;IAG3C,iCAAiC;IACjC,MAAM,iBAAiB;QACrB,IAAI,UAAU;YACZ,IAAI,QAAQ,GAAG;gBACb,OAAO;YACT;YACA,OAAO;QACT;QAEA,IAAI,gBAAgB;YAClB,OAAO;QACT;QAEA,OAAO;IACT;IAEA,MAAM,4BACJ;;YAEG,YAAY,QAAQ,KAAK,CAAC,2BACzB,2MAAC;gBAAK,WAAU;;;;;;0BAIlB,2MAAC;gBAAK,WAAW,IAAA,0IAAE,EACjB,yEACA,YAAY,UAAU,IAAI,cAAc,IACxC,QAAQ,KAAK;0BAEZ,QAAQ,KAAK,CAAC,0BACb,2MAAC;oBAAK,WAAW,IAAA,0IAAE,EACjB,8CACA,WAAW,mBAAmB;;;;;6EAGhC,2MAAC;oBAAK,MAAM;;;;;;;;;;;YAIf,CAAC,2BACA;;kCACE,2MAAC;wBAAK,WAAW,IAAA,0IAAE,EACjB,uDACA,QAAQ,IAAI,gBAAgB;kCAE3B;;;;;;oBAGF,SAAS,QAAQ,mBAChB,2MAAC;wBAAK,WAAW,IAAA,0IAAE,EACjB,kFACA,YAAY,UAAU,IAClB,2BACA;kCAEH,QAAQ,KAAK,QAAQ;;;;;;oBAIzB,6BACC,2MAAC,oPAAW;wBACV,MAAM;wBACN,WAAW,IAAA,0IAAE,EACX,6DACA,cAAc,cACd,YAAY,UAAU,KAAK;;;;;;;;YAQpC,aAAa,SAAS,QAAQ,mBAC7B,2MAAC;gBAAK,WAAU;0BACb,QAAQ,IAAI,OAAO;;;;;;YAKvB,aAAa,6BACZ,2MAAC;gBAAK,WAAU;0BACd,cAAA,2MAAC,uPAAY;oBAAC,MAAM;oBAAI,WAAU;;;;;;;;;;;YAKrC,YAAY,UAAU,KAAK,CAAC,2BAC3B,2MAAC;gBAAK,WAAU;;;;;;;;IAKtB,qBACE,2MAAC;QACC,KAAK;QACL,cAAc;QACd,cAAc;;YAEb,4BACC,2MAAC;gBACC,SAAS;gBACT,WAAW,IAAA,0IAAE,EAAC,aAAa,kBAAkB;0BAE5C;;;;;yEAGH,2MAAC,wLAAI;gBACH,MAAM,KAAK,UAAU,IAAI;gBACzB,WAAW,IAAA,0IAAE,EAAC,aAAa;0BAE1B;;;;;;0BAKL,2MAAC;gBACC,SAAS;gBACT,MAAM,eAAe,aAAa,CAAC;gBACnC,UAAU;;;;;;;;;;;;AAIlB;IAnLM;MAAA;AAyLC,SAAS,QAAQ,EAAE,YAAY,KAAK,EAAE,QAAQ,EAAgB;;IACnE,MAAM,WAAW,IAAA,kKAAW;IAC5B,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,IAAA,kLAAc;IAElD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,uLAAQ,EAAuB,IAAI;IAC7E,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,uLAAQ,EAAC;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uLAAQ,EAAC;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uLAAQ,EAAC;IACvC,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,uLAAQ,EAAC;IAEnD,eAAe;IACf,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uLAAQ,EAAwB;IACpE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,uLAAQ,EAAC;QAAE,KAAK;QAAG,MAAM;IAAE;IAEvE,MAAM,iBAAiB,IAAA,qLAAM,EAAmB;IAChD,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,IAAA,2KAAO;IAEhC,cAAc;IACd,IAAA,wLAAS;6BAAC;YACR,WAAW;YACX,cAAc,SAAS,eAAe,CAAC,SAAS,CAAC,QAAQ,CAAC;QAC5D;4BAAG,EAAE;IAEL,oCAAoC;IACpC,IAAA,wLAAS;6BAAC;YACR,IAAI,CAAC,WAAW;gBACd,cAAc;YAChB;QACF;4BAAG;QAAC;KAAU;IAEd,MAAM,eAAe;QACnB;IACF;IAEA,MAAM,mBAAmB,CAAC,MAAsB;QAC9C,iDAAiD;QACjD,IAAI,YAAY,OAAO,KAAK,EAAE,IAAI,YAAY,cAAc,KAAK,SAAS,EAAE;YAC1E,cAAc;QAChB,OAAO;YACL,cAAc;YACd,kBAAkB;QACpB;IACF;IAEA,MAAM,oBAAoB;QACxB,cAAc;IAChB;IAEA,mCAAmC;IACnC,IAAA,wLAAS;6BAAC;YACR,MAAM;sDAAmB,CAAC,OAAyB,YAAiC,EAAE;oBACpF,KAAK,MAAM,QAAQ,MAAO;wBACxB,IAAI,KAAK,UAAU,KAAK,UAAU;4BAChC,OAAO;wBACT;wBACA,IAAI,KAAK,QAAQ,EAAE,QAAQ;4BACzB,MAAM,QAAQ,iBAAiB,KAAK,QAAQ,EAAE;mCAAI;gCAAW,KAAK,EAAE,IAAI,KAAK,SAAS;6BAAC;4BACvF,IAAI,MAAM,MAAM,GAAG,UAAU,MAAM,EAAE;gCACnC,OAAO;4BACT;wBACF;oBACF;oBACA,OAAO,EAAE;gBACX;;YAEA,MAAM,gBAAgB,iBAAiB;YACvC,IAAI,cAAc,MAAM,GAAG,GAAG;gBAC5B;yCAAiB,CAAC,OAAS,IAAI,IAAI;+BAAI;+BAAS;yBAAc;;YAChE;QACF;4BAAG;QAAC;QAAO;KAAS;IAEpB,qBAAqB;IACrB,MAAM,eAAe,IAAA,0LAAW;6CAAC,CAAC;YAChC;qDAAiB,CAAC;oBAChB,MAAM,OAAO,IAAI,IAAI;oBACrB,IAAI,KAAK,GAAG,CAAC,SAAS;wBACpB,KAAK,MAAM,CAAC;oBACd,OAAO;wBACL,KAAK,GAAG,CAAC;oBACX;oBACA,OAAO;gBACT;;QACF;4CAAG,EAAE;IAEL,qBAAqB;IACrB,MAAM,WAAW,IAAA,0LAAW;yCAAC,CAAC;YAC5B,IAAI,KAAK,UAAU,KAAK,UAAU,OAAO;YACzC,IAAI,KAAK,UAAU,IAAI,SAAS,UAAU,CAAC,KAAK,UAAU,GAAG,MAAM,OAAO;YAC1E,OAAO;QACT;wCAAG;QAAC;KAAS;IAEb,MAAM,iBAAiB,IAAA,0LAAW;+CAAC,CAAC;YAClC,IAAI,SAAS,OAAO,OAAO;YAC3B,IAAI,KAAK,QAAQ,EAAE,QAAQ;gBACzB,OAAO,KAAK,QAAQ,CAAC,IAAI;2DAAC,CAAC,QAAU,eAAe;;YACtD;YACA,OAAO;QACT;8CAAG;QAAC;KAAS;IAEb,yBAAyB;IACzB,MAAM,cAAc,IAAA,0LAAW;4CAAC,CAAC,OAAyB;YACxD,IAAI,CAAC,OAAO,OAAO;YAEnB,MAAM,aAAa,MAAM,WAAW;YAEpC,OAAO,MAAM,MAAM;oDAAmB,CAAC,KAAK;oBAC1C,MAAM,cAAc,CAAC,KAAK,YAAY,IAAI,KAAK,SAAS,IAAI,EAAE,EAAE,WAAW,GAAG,QAAQ,CAAC;oBACvF,MAAM,mBAAmB,KAAK,QAAQ,GAAG,YAAY,KAAK,QAAQ,EAAE,SAAS,EAAE;oBAE/E,IAAI,eAAe,iBAAiB,MAAM,GAAG,GAAG;wBAC9C,IAAI,IAAI,CAAC;4BACP,GAAG,IAAI;4BACP,UAAU,iBAAiB,MAAM,GAAG,IAAI,mBAAmB,KAAK,QAAQ;wBAC1E;oBACF;oBAEA,OAAO;gBACT;mDAAG,EAAE;QACP;2CAAG,EAAE;IAEL,MAAM,gBAAgB,YAAY,OAAO;IAEzC,eAAe;IACf,MAAM,aAAa,CAAC,MAAsB;QACxC,IAAI,KAAK,EAAE,EAAE,OAAO,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE;QACrC,IAAI,KAAK,SAAS,EAAE,OAAO,CAAC,KAAK,EAAE,KAAK,SAAS,EAAE;QACnD,OAAO,CAAC,SAAS,EAAE,OAAO;IAC5B;IAEA,mBAAmB;IACnB,MAAM,iBAAiB;QACrB,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;QAC1C,cAAc,CAAC;IACjB;IAEA,+BAA+B;IAC/B,MAAM,iBAAiB,CAAC,MAAsB,OAAe,QAAgB,CAAC;QAC5E,IAAI,KAAK,QAAQ,KAAK,OAAO,OAAO;QAEpC,MAAM,cAAc,KAAK,QAAQ,IAAI,KAAK,QAAQ,CAAC,MAAM,GAAG;QAC5D,MAAM,aAAa,cAAc,GAAG,CAAC,KAAK,EAAE,IAAI,KAAK,SAAS,KAAK,CAAC,CAAC,CAAC,eAAe,WAAW;QAChG,MAAM,SAAS,SAAS;QACxB,MAAM,eAAe,eAAe;QACpC,MAAM,MAAM,WAAW,MAAM;QAE7B,qBACE,2MAAC;YAAc,WAAU;;8BACvB,2MAAC;oBACC,MAAM;oBACN,OAAO;oBACP,WAAW;oBACX,UAAU;oBACV,gBAAgB,gBAAgB,CAAC;oBACjC,YAAY;oBACZ,aAAa,eAAe;oBAC5B,UAAU,IAAM,aAAa,KAAK,EAAE,IAAI,KAAK,SAAS;oBACtD,cAAc;oBACd,UAAU;;;;;;gBAIX,eAAe,CAAC,2BACf,2MAAC;oBACC,WAAW,IAAA,0IAAE,EACX,gDACA,aAAa,gCAAgC;8BAG/C,cAAA,2MAAC;wBAAI,WAAU;kCACb,cAAA,2MAAC;4BAAI,WAAU;sCACZ,KAAK,QAAQ,CAAE,GAAG,CAAC,CAAC,OAAO,aAAe,eAAe,OAAO,YAAY,QAAQ;;;;;;;;;;;;;;;;;WAxBrF;;;;;IA+Bd;IAEA,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE;;0BACE,2MAAC;gBACC,WAAW,IAAA,0IAAE,EACX,oCACA,iBACA,oCACA,oBACA,yDACA,2CACA,YAAY,SAAS;;kCAIvB,2MAAC;wBAAI,WAAW,IAAA,0IAAE,EAChB,yFACA,YAAY,wBAAwB;kCAEpC,cAAA,2MAAC,wLAAI;4BAAC,MAAK;4BAAI,WAAU;;8CACvB,2MAAC;oCAAI,WAAU;;sDACb,2MAAC;4CAAI,WAAU;sDACb,cAAA,2MAAC;gDAAK,WAAU;0DAA+B;;;;;;;;;;;sDAEjD,2MAAC;4CAAI,WAAU;;;;;;;;;;;;gCAEhB,CAAC,2BACA,2MAAC;oCAAI,WAAU;;sDACb,2MAAC;4CAAG,WAAU;sDAA4H;;;;;;sDAG1I,2MAAC;4CAAE,WAAU;;8DACX,2MAAC,uOAAQ;oDAAC,MAAM;oDAAI,WAAU;;;;;;gDAAmB;;;;;;;;;;;;;;;;;;;;;;;;oBAS1D,CAAC,2BACA,2MAAC;wBAAI,WAAU;kCACb,cAAA,2MAAC;4BAAI,WAAW,IAAA,0IAAE,EAChB,wCACA,iBAAiB;;8CAEjB,2MAAC,iOAAM;oCAAC,MAAM;oCAAI,WAAW,IAAA,0IAAE,EAC7B,8DACA,gBAAgB,qBAAqB;;;;;;8CAEvC,2MAAC;oCACC,KAAK;oCACL,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;oCAC9C,SAAS,IAAM,iBAAiB;oCAChC,QAAQ,IAAM,iBAAiB;oCAC/B,aAAY;oCACZ,WAAW,IAAA,0IAAE,EACX,0EACA,wCACA,6BACA,8BACA,6DACA;;;;;;gCAGH,6BACC,2MAAC;oCACC,SAAS,IAAM,eAAe;oCAC9B,WAAU;8CAEV,cAAA,2MAAC,kNAAC;wCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;kCAQnB,2MAAC;wBACC,WAAW,IAAA,0IAAE,EACX,wCACA,iCACA,6BACA;kCAGD,0BACC,2MAAC;4BAAI,WAAU;;8CACb,2MAAC;oCAAI,WAAU;;;;;;gCACd,CAAC,2BACA,2MAAC;oCAAK,WAAU;8CAAyB;;;;;;;;;;;mCAG3C,sBACF,2MAAC;4BAAI,WAAU;sCACZ,CAAC,2BACA,2MAAC;gCAAE,WAAU;0CAA0C;;;;;;;;;;mCAGzD,cAAc,MAAM,KAAK,kBAC3B,2MAAC;4BAAI,WAAU;sCACZ,CAAC,2BACA,2MAAC;gCAAI,WAAU;;kDACb,2MAAC;wCAAI,WAAU;kDACb,cAAA,2MAAC,iOAAM;4CAAC,MAAM;4CAAI,WAAU;;;;;;;;;;;kDAE9B,2MAAC;wCAAE,WAAU;kDACV,cAAc,sBAAsB;;;;;;;;;;;;;;;;mCAM7C,cAAc,GAAG,CAAC,CAAC,MAAM,QAAU,eAAe,MAAM;;;;;;oBAK3D,CAAC,2BACA,2MAAC;wBAAI,WAAU;kCACb,cAAA,2MAAC;4BAAI,WAAU;;8CACb,2MAAC;oCAAI,WAAU;;sDACb,2MAAC;4CAAI,WAAU;sDACb,cAAA,2MAAC;gDAAK,WAAU;0DACb,MAAM,MAAM,OAAO,MAAM;;;;;;;;;;;sDAG9B,2MAAC;4CAAK,WAAU;;;;;;;;;;;;8CAElB,2MAAC;oCAAI,WAAU;;sDACb,2MAAC;4CAAE,WAAU;sDACV,MAAM,QAAQ;;;;;;sDAEjB,2MAAC;4CAAE,WAAU;sDAAmC,MAAM,YAAY;;;;;;;;;;;;;;;;;;;;;;;kCAO1E,2MAAC;wBAAI,WAAW,IAAA,0IAAE,EAChB,kEACA,YAAY,QAAQ;kCAEpB,cAAA,2MAAC;4BAAI,WAAW,IAAA,0IAAE,EAChB,qBACA,YAAY,mBAAmB;;8CAG/B,2MAAC;oCACC,SAAS;oCACT,WAAW,IAAA,0IAAE,EACX,mDACA,aACI,yCACA;oCAEN,OAAO,aAAa,eAAe;8CAElC,2BAAa,2MAAC,wNAAG;wCAAC,MAAM;;;;;6DAAS,2MAAC,2NAAI;wCAAC,MAAM;;;;;;;;;;;gCAI/C,CAAC,2BACA,2MAAC,wLAAI;oCACH,MAAK;oCACL,WAAU;oCACV,OAAM;8CAEN,cAAA,2MAAC,uOAAQ;wCAAC,MAAM;;;;;;;;;;;8CAKpB,2MAAC;oCACC,SAAS;oCACT,WAAU;oCACV,OAAO,YAAY,iBAAiB;8CAEnC,0BAAY,2MAAC,8OAAS;wCAAC,MAAM;;;;;6DAAS,2MAAC,iQAAc;wCAAC,MAAM;;;;;;;;;;;gCAI9D,CAAC,2BACA,2MAAC;oCACC,SAAS;oCACT,WAAU;oCACV,OAAM;8CAEN,cAAA,2MAAC,qOAAM;wCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAQvB,4BACC,2MAAC;gBACC,MAAM;gBACN,MAAM;gBACN,UAAU;gBACV,SAAS;gBACT,UAAU;;;;;;;;AAKpB;IAvYgB;;QACG,kKAAW;QACQ,kLAAc;QAazB,2KAAO;;;MAflB;uCAyYD"}},
    {"offset": {"line": 2406, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/HorizontalNav.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/HorizontalNavModern.tsx\n// Description: Modern Horizontal Navigation for HIS - Clean medical aesthetic\n// Updated: Sky blue hover effects for better visual appeal\n// =============================================================================\n\n'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { ChevronDown, Circle } from 'lucide-react';\nimport { useMenuContext, MenuAccessItem } from '@/components/providers/MenuProvider';\nimport { getIcon } from '@/components/ui';\n\nexport function HorizontalNav() {\n  const pathname = usePathname();\n  const { menus, isLoading } = useMenuContext();\n  const [openDropdown, setOpenDropdown] = useState<number | string | null>(null);\n  const [hoveredItem, setHoveredItem] = useState<string | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setOpenDropdown(null);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Close dropdown on route change\n  useEffect(() => {\n    setOpenDropdown(null);\n  }, [pathname]);\n\n  const isActive = (menu: MenuAccessItem): boolean => {\n    if (menu.route_path === pathname) return true;\n    if (menu.route_path && pathname.startsWith(menu.route_path + '/')) return true;\n    return false;\n  };\n\n  const isParentActive = (menu: MenuAccessItem): boolean => {\n    if (isActive(menu)) return true;\n    if (menu.children?.length) {\n      return menu.children.some((child) => isParentActive(child));\n    }\n    return false;\n  };\n\n  const getMenuKey = (menu: MenuAccessItem, index: number): string => {\n    return menu.id ? `nav-${menu.id}` : menu.menu_code ? `nav-${menu.menu_code}` : `nav-idx-${index}`;\n  };\n\n  const getMenuId = (menu: MenuAccessItem): number | string => menu.id || menu.menu_code;\n\n  const toggleDropdown = (menuId: number | string) => {\n    setOpenDropdown((prev) => (prev === menuId ? null : menuId));\n  };\n\n  if (isLoading) {\n    return (\n      <nav className=\"hidden lg:flex items-center gap-2\">\n        {/* Skeleton loading with sky blue tint */}\n        {[1, 2, 3, 4].map((i) => (\n          <div\n            key={i}\n            className=\"h-9 w-24 rounded-lg bg-sky-100 dark:bg-sky-900/30 animate-pulse\"\n          />\n        ))}\n      </nav>\n    );\n  }\n\n  return (\n    <nav className=\"hidden lg:flex items-center gap-1\" ref={dropdownRef}>\n      {menus.map((menu, index) => {\n        const Icon = getIcon(menu.icon || 'file');\n        const hasChildren = menu.children && menu.children.length > 0;\n        const active = isActive(menu);\n        const parentActive = isParentActive(menu);\n        const key = getMenuKey(menu, index);\n        const menuId = getMenuId(menu);\n        const isHovered = hoveredItem === key;\n        const isOpen = openDropdown === menuId;\n\n        if (menu.can_view === false) return null;\n\n        // Base styles for nav items\n        const baseStyles = `\n          relative flex items-center gap-2 px-3.5 py-2 rounded-xl text-sm font-medium\n          transition-all duration-200 ease-out\n          focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-500/50\n        `;\n\n        // Active state - sky blue gradient\n        const activeStyles = `\n          bg-gradient-to-r from-sky-500/15 to-sky-400/10\n          dark:from-sky-500/25 dark:to-sky-400/15\n          text-sky-700 dark:text-sky-300\n          shadow-sm shadow-sky-500/10\n        `;\n\n        // Hover state - sky blue colors\n        const inactiveStyles = `\n          text-slate-600 dark:text-slate-400\n          hover:bg-sky-50 dark:hover:bg-sky-900/40\n          hover:text-sky-700 dark:hover:text-sky-300\n          hover:shadow-sm hover:shadow-sky-500/10\n        `;\n\n        if (hasChildren) {\n          return (\n            <div key={key} className=\"relative\">\n              <button\n                onClick={() => toggleDropdown(menuId)}\n                onMouseEnter={() => setHoveredItem(key)}\n                onMouseLeave={() => setHoveredItem(null)}\n                className={`\n                  ${baseStyles}\n                  ${parentActive ? activeStyles : inactiveStyles}\n                  group\n                `}\n                aria-expanded={isOpen}\n                aria-haspopup=\"true\"\n              >\n                {/* Active indicator line - sky blue gradient */}\n                {parentActive && (\n                  <span className=\"absolute bottom-0 left-3 right-3 h-0.5 bg-gradient-to-r from-sky-500 to-sky-400 rounded-full\" />\n                )}\n\n                {/* Icon with hover animation */}\n                <span className={`\n                  transition-transform duration-200\n                  ${isHovered ? 'scale-110' : 'scale-100'}\n                `}>\n                  <Icon size={18} strokeWidth={parentActive ? 2.5 : 2} />\n                </span>\n\n                <span className=\"whitespace-nowrap\">\n                  {menu.menu_name_th || menu.menu_name}\n                </span>\n\n                {/* Chevron with rotation */}\n                <ChevronDown\n                  size={14}\n                  className={`\n                    transition-transform duration-200 ease-out\n                    ${isOpen ? 'rotate-180' : ''}\n                    opacity-60\n                  `}\n                />\n\n                {/* Notification badge */}\n                {menu.badge_count && menu.badge_count > 0 && (\n                  <span className=\"absolute -top-1 -right-1 min-w-5 h-5 px-1.5 flex items-center justify-center text-xs font-bold text-white bg-red-500 rounded-full animate-pulse\">\n                    {menu.badge_count > 99 ? '99+' : menu.badge_count}\n                  </span>\n                )}\n              </button>\n\n              {/* Dropdown Menu with Animation */}\n              <div\n                className={`\n                  absolute top-full left-0 mt-2 min-w-56 z-50\n                  transition-all duration-200 ease-out origin-top-left\n                  ${isOpen\n                    ? 'opacity-100 scale-100 translate-y-0'\n                    : 'opacity-0 scale-95 -translate-y-2 pointer-events-none'\n                  }\n                `}\n              >\n                <div className=\"\n                  bg-white/95 dark:bg-slate-900/95 backdrop-blur-xl\n                  border border-sky-100 dark:border-sky-800/50\n                  rounded-2xl shadow-xl shadow-sky-900/10 dark:shadow-black/30\n                  py-2 overflow-hidden\n                \">\n                  {/* Dropdown header */}\n                  <div className=\"px-4 py-2 border-b border-sky-50 dark:border-sky-900/50\">\n                    <p className=\"text-xs font-medium text-sky-500 dark:text-sky-400 uppercase tracking-wider\">\n                      {menu.menu_name_th || menu.menu_name}\n                    </p>\n                  </div>\n\n                  {/* Dropdown items */}\n                  <div className=\"py-1\">\n                    {menu.children!.map((child, childIndex) => {\n                      const ChildIcon = getIcon(child.icon || 'file');\n                      const childActive = isActive(child);\n                      const childKey = getMenuKey(child, childIndex);\n\n                      if (child.can_view === false) return null;\n\n                      return (\n                        <Link\n                          key={childKey}\n                          href={child.route_path || '#'}\n                          onClick={() => setOpenDropdown(null)}\n                          className={`\n                            flex items-center gap-3 px-4 py-2.5 mx-2 rounded-xl\n                            text-sm transition-all duration-150 group/item\n                            ${childActive\n                              ? 'bg-sky-50 dark:bg-sky-500/20 text-sky-700 dark:text-sky-300'\n                              : 'text-slate-600 dark:text-slate-400 hover:bg-sky-50/80 dark:hover:bg-sky-900/50 hover:text-sky-700 dark:hover:text-sky-300'\n                            }\n                          `}\n                        >\n                          {/* Icon container with sky blue */}\n                          <span className={`\n                            flex items-center justify-center w-8 h-8 rounded-lg\n                            transition-all duration-150\n                            ${childActive\n                              ? 'bg-sky-100 dark:bg-sky-500/25 text-sky-600 dark:text-sky-400'\n                              : 'bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-500 group-hover/item:bg-sky-100 dark:group-hover/item:bg-sky-900/60 group-hover/item:text-sky-600 dark:group-hover/item:text-sky-400'\n                            }\n                          `}>\n                            <ChildIcon size={16} />\n                          </span>\n\n                          <span className=\"flex-1 font-medium\">\n                            {child.menu_name_th || child.menu_name}\n                          </span>\n\n                          {/* Status indicator */}\n                          {child.is_new && (\n                            <span className=\"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wide text-sky-700 dark:text-sky-400 bg-sky-100 dark:bg-sky-500/20 rounded-full\">\n                              New\n                            </span>\n                          )}\n\n                          {/* Arrow indicator on hover */}\n                          <span className=\"opacity-0 group-hover/item:opacity-100 transition-opacity text-sky-500\">\n                            →\n                          </span>\n                        </Link>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            </div>\n          );\n        }\n\n        // Menu item without children\n        return (\n          <Link\n            key={key}\n            href={menu.route_path || '#'}\n            onMouseEnter={() => setHoveredItem(key)}\n            onMouseLeave={() => setHoveredItem(null)}\n            className={`\n              ${baseStyles}\n              ${active ? activeStyles : inactiveStyles}\n              group\n            `}\n          >\n            {/* Active indicator line - sky blue */}\n            {active && (\n              <span className=\"absolute bottom-0 left-3 right-3 h-0.5 bg-gradient-to-r from-sky-500 to-sky-400 rounded-full\" />\n            )}\n\n            {/* Icon with hover animation */}\n            <span className={`\n              transition-transform duration-200\n              ${isHovered ? 'scale-110' : 'scale-100'}\n            `}>\n              <Icon size={18} strokeWidth={active ? 2.5 : 2} />\n            </span>\n\n            <span className=\"whitespace-nowrap\">\n              {menu.menu_name_th || menu.menu_name}\n            </span>\n\n            {/* Status dot for important modules */}\n            {menu.has_notification && (\n              <Circle\n                size={8}\n                className=\"fill-sky-500 text-sky-500 animate-pulse\"\n              />\n            )}\n          </Link>\n        );\n      })}\n    </nav>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2804, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/MobileMenu.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/MobileMenu.tsx\n// Description: Mobile Menu - Slide-out menu from LEFT with dynamic menus from API\n//              Shows on mobile and tablet (below xl: 1280px)\n// =============================================================================\n\n'use client';\n\nimport { useState } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { X, ChevronDown, ChevronRight, LogOut, Moon, Sun } from 'lucide-react';\nimport { useMenuContext, MenuAccessItem } from '@/components/providers/MenuProvider';\nimport { useAuth } from '@/components/providers/AuthProvider';\nimport { useTheme } from '@/components/providers/ThemeProvider';\nimport { getIcon } from '@/components/ui';\n\ninterface MobileMenuProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function MobileMenu({ isOpen, onClose }: MobileMenuProps) {\n  const pathname = usePathname();\n  const { menus, isLoading } = useMenuContext();\n  const { user, logout } = useAuth();\n  const { theme, toggleTheme } = useTheme();\n  const [expandedMenus, setExpandedMenus] = useState<Set<number | string>>(new Set());\n\n  const toggleExpand = (menuId: number | string) => {\n    setExpandedMenus((prev) => {\n      const next = new Set(prev);\n      if (next.has(menuId)) {\n        next.delete(menuId);\n      } else {\n        next.add(menuId);\n      }\n      return next;\n    });\n  };\n\n  const isActive = (menu: MenuAccessItem): boolean => {\n    if (menu.route_path === pathname) return true;\n    if (menu.route_path && pathname.startsWith(menu.route_path + '/')) return true;\n    return false;\n  };\n\n  const getMenuKey = (menu: MenuAccessItem, index: number): string => {\n    if (menu.id) return `mobile-${menu.id}`;\n    if (menu.menu_code) return `mobile-${menu.menu_code}`;\n    return `mobile-idx-${index}`;\n  };\n\n  const getMenuId = (menu: MenuAccessItem): number | string => {\n    return menu.id || menu.menu_code;\n  };\n\n  const handleLogout = () => {\n    logout();\n    onClose();\n  };\n\n  const renderMenuItem = (menu: MenuAccessItem, index: number) => {\n    const Icon = getIcon(menu.icon || 'file');\n    const hasChildren = menu.children && menu.children.length > 0;\n    const menuId = getMenuId(menu);\n    const isExpanded = expandedMenus.has(menuId);\n    const active = isActive(menu);\n    const key = getMenuKey(menu, index);\n\n    // Skip if menu is not viewable\n    if (menu.can_view === false) return null;\n\n    if (hasChildren) {\n      return (\n        <div key={key} className=\"mb-1\">\n          <button\n            onClick={() => toggleExpand(menuId)}\n            className={`\n              w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors\n              ${active\n                ? 'bg-primary-50 dark:bg-primary-500/10 text-primary-600 dark:text-primary-400'\n                : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800'\n              }\n            `}\n          >\n            <Icon size={20} />\n            <span className=\"flex-1 text-left font-medium\">\n              {menu.menu_name_th || menu.menu_name}\n            </span>\n            {isExpanded ? (\n              <ChevronDown size={18} className=\"text-slate-400\" />\n            ) : (\n              <ChevronRight size={18} className=\"text-slate-400\" />\n            )}\n          </button>\n\n          {/* Children */}\n          {isExpanded && (\n            <div className=\"mt-1 ml-6 pl-4 border-l-2 border-slate-200 dark:border-slate-700 space-y-1\">\n              {menu.children!.map((child, childIndex) => {\n                const ChildIcon = getIcon(child.icon || 'file');\n                const childActive = isActive(child);\n                const childKey = getMenuKey(child, childIndex);\n\n                if (child.can_view === false) return null;\n\n                return (\n                  <Link\n                    key={childKey}\n                    href={child.route_path || '#'}\n                    onClick={onClose}\n                    className={`\n                      flex items-center gap-3 px-4 py-2.5 rounded-xl transition-colors\n                      ${childActive\n                        ? 'bg-primary-500 text-white'\n                        : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800'\n                      }\n                    `}\n                  >\n                    <ChildIcon size={18} />\n                    <span className=\"font-medium\">{child.menu_name_th || child.menu_name}</span>\n                  </Link>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    // Menu item without children\n    return (\n      <Link\n        key={key}\n        href={menu.route_path || '#'}\n        onClick={onClose}\n        className={`\n          flex items-center gap-3 px-4 py-3 rounded-xl transition-colors mb-1\n          ${active\n            ? 'bg-primary-500 text-white'\n            : 'text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800'\n          }\n        `}\n      >\n        <Icon size={20} />\n        <span className=\"font-medium\">{menu.menu_name_th || menu.menu_name}</span>\n      </Link>\n    );\n  };\n\n  return (\n    <>\n      {/* Backdrop - Shows below xl breakpoint */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 xl:hidden\"\n          onClick={onClose}\n        />\n      )}\n\n      {/* Menu Panel - LEFT SIDE - Shows below xl breakpoint */}\n      <div\n        className={`\n          fixed top-0 left-0 h-full w-80 max-w-[85vw] bg-white dark:bg-slate-900 shadow-2xl z-50 \n          transform transition-transform duration-300 ease-in-out xl:hidden\n          ${isOpen ? 'translate-x-0' : '-translate-x-full'}\n        `}\n      >\n        {/* Header with Logo */}\n        <div className=\"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-800\">\n          <Link href=\"/\" onClick={onClose} className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25\">\n              <span className=\"text-white font-bold text-lg\">M</span>\n            </div>\n            <div>\n              <h1 className=\"font-bold text-slate-900 dark:text-white\">Korat</h1>\n              <p className=\"text-xs text-slate-500 dark:text-slate-400\">HIS Platform</p>\n            </div>\n          </Link>\n          <button\n            onClick={onClose}\n            className=\"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors\"\n          >\n            <X size={24} />\n          </button>\n        </div>\n\n        {/* User Info */}\n        {user && (\n          <div className=\"p-4 border-b border-slate-200 dark:border-slate-800\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-full bg-primary-100 dark:bg-primary-500/20 flex items-center justify-center\">\n                <span className=\"text-primary-600 dark:text-primary-400 font-semibold text-lg\">\n                  {user.name?.charAt(0) || 'U'}\n                </span>\n              </div>\n              <div>\n                <p className=\"font-medium text-slate-900 dark:text-white\">{user.name}</p>\n                <p className=\"text-sm text-slate-500\">{user.role}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Navigation */}\n        <nav className=\"flex-1 overflow-y-auto p-4 [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]\" style={{ maxHeight: 'calc(100vh - 220px)' }}>\n          {isLoading ? (\n            <div className=\"flex flex-col items-center justify-center py-8\">\n              <div className=\"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\n              <span className=\"text-sm text-slate-500 mt-2\">Loading menus...</span>\n            </div>\n          ) : menus.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <p className=\"text-sm text-slate-500\">No menus available</p>\n            </div>\n          ) : (\n            <div className=\"space-y-1\">\n              {menus.map((menu, index) => renderMenuItem(menu, index))}\n            </div>\n          )}\n        </nav>\n\n        {/* Footer Actions */}\n        <div className=\"absolute bottom-0 left-0 right-0 p-4 border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={toggleTheme}\n              className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors\"\n            >\n              {theme === 'dark' ? <Sun size={18} /> : <Moon size={18} />}\n              <span className=\"text-sm font-medium\">\n                {theme === 'dark' ? 'Light' : 'Dark'}\n              </span>\n            </button>\n            <button\n              onClick={handleLogout}\n              className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-critical-600 dark:text-critical-400 hover:bg-critical-50 dark:hover:bg-critical-500/10 rounded-xl transition-colors\"\n            >\n              <LogOut size={18} />\n              <span className=\"text-sm font-medium\">Logout</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3310, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/Header.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/Header.tsx\n// Description: Header - Modern glassmorphism top navigation bar\n//              Using xl breakpoint (1280px) for desktop\n// =============================================================================\n\n'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Link from 'next/link';\nimport { \n  Menu, \n  Bell, \n  Sun, \n  Moon, \n  User, \n  Settings, \n  LogOut, \n  ChevronDown, \n  Search,\n  PanelLeft,\n  PanelTop,\n  Command,\n  Sparkles\n} from 'lucide-react';\nimport { useAuth } from '@/components/providers/AuthProvider';\nimport { useTheme } from '@/components/providers/ThemeProvider';\n\ntype LayoutMode = 'sidebar' | 'horizontal';\n\ninterface HeaderProps {\n  onMenuClick?: () => void;\n  layoutMode?: LayoutMode;\n  onLayoutModeChange?: (mode: LayoutMode) => void;\n}\n\nexport function Header({ onMenuClick, layoutMode = 'sidebar', onLayoutModeChange }: HeaderProps) {\n  const { user, logout } = useAuth();\n  const { theme, toggleTheme } = useTheme();\n  const [userMenuOpen, setUserMenuOpen] = useState(false);\n  const [searchFocused, setSearchFocused] = useState(false);\n  const userMenuRef = useRef<HTMLDivElement>(null);\n\n  // Close user menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (userMenuRef.current && !userMenuRef.current.contains(event.target as Node)) {\n        setUserMenuOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleLogout = () => {\n    logout();\n    setUserMenuOpen(false);\n  };\n\n  const toggleLayoutMode = () => {\n    const newMode = layoutMode === 'sidebar' ? 'horizontal' : 'sidebar';\n    onLayoutModeChange?.(newMode);\n  };\n\n  return (\n    <header className=\"sticky top-0 z-30 h-16 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-slate-200/50 dark:border-slate-800/50\">\n      <div className=\"h-full px-4 flex items-center justify-between gap-4\">\n        {/* Left Section */}\n        <div className=\"flex items-center gap-4\">\n          {/* Mobile Menu Button - Shows below xl (1280px) */}\n          <button\n            onClick={onMenuClick}\n            className=\"xl:hidden p-2.5 text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 rounded-xl transition-all active:scale-95\"\n          >\n            <Menu size={22} />\n          </button>\n\n          {/* Logo - Show on mobile/tablet OR when in horizontal mode on desktop */}\n          <Link \n            href=\"/\" \n            className={`flex items-center gap-3 group ${\n              layoutMode === 'horizontal' ? 'flex' : 'xl:hidden flex'\n            }`}\n          >\n            <div className=\"relative\">\n              <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25 group-hover:shadow-primary-500/40 transition-shadow\">\n                <span className=\"text-white font-bold text-lg\">K</span>\n              </div>\n              {/* Glow effect on hover */}\n              <div className=\"absolute inset-0 rounded-xl bg-primary-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity -z-10\" />\n            </div>\n            <div className=\"hidden sm:block\">\n              <h1 className=\"font-bold text-slate-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors\">Korat</h1>\n              <p className=\"text-xs text-slate-500 dark:text-slate-400\">HIS Platform</p>\n            </div>\n          </Link>\n\n          {/* Divider - Only in horizontal mode on desktop */}\n          {layoutMode === 'horizontal' && (\n            <div className=\"hidden xl:block h-8 w-px bg-gradient-to-b from-transparent via-slate-300 dark:via-slate-700 to-transparent mx-2\" />\n          )}\n\n          {/* Search Bar - Tablet and Desktop */}\n          <div className=\"hidden md:flex items-center\">\n            <div className={`relative transition-all duration-300 ${searchFocused ? 'w-80' : 'w-64'}`}>\n              <Search size={18} className={`absolute left-3 top-1/2 -translate-y-1/2 transition-colors ${searchFocused ? 'text-primary-500' : 'text-slate-400'}`} />\n              <input\n                type=\"text\"\n                placeholder=\"Search...\"\n                onFocus={() => setSearchFocused(true)}\n                onBlur={() => setSearchFocused(false)}\n                className=\"w-full pl-10 pr-20 py-2.5 bg-slate-100/80 dark:bg-slate-800/80 border border-transparent hover:border-slate-200 dark:hover:border-slate-700 focus:border-primary-500/50 focus:bg-white dark:focus:bg-slate-800 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 transition-all\"\n              />\n              {/* Keyboard shortcut hint */}\n              <div className=\"absolute right-3 top-1/2 -translate-y-1/2 hidden lg:flex items-center gap-1 text-xs text-slate-400\">\n                <kbd className=\"px-1.5 py-0.5 bg-slate-200/80 dark:bg-slate-700/80 rounded text-[10px] font-medium\">⌘</kbd>\n                <kbd className=\"px-1.5 py-0.5 bg-slate-200/80 dark:bg-slate-700/80 rounded text-[10px] font-medium\">K</kbd>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Right Section */}\n        <div className=\"flex items-center gap-1.5\">\n          {/* Layout Mode Toggle - Desktop Only (xl+) */}\n          {onLayoutModeChange && (\n            <div className=\"hidden xl:flex items-center bg-slate-100/80 dark:bg-slate-800/80 rounded-xl p-1 border border-slate-200/50 dark:border-slate-700/50\">\n              <button\n                onClick={() => onLayoutModeChange('sidebar')}\n                className={`p-2 rounded-lg transition-all ${\n                  layoutMode === 'sidebar'\n                    ? 'bg-white dark:bg-slate-700 text-primary-500 shadow-sm'\n                    : 'text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'\n                }`}\n                title=\"Sidebar Layout\"\n              >\n                <PanelLeft size={18} />\n              </button>\n              <button\n                onClick={() => onLayoutModeChange('horizontal')}\n                className={`p-2 rounded-lg transition-all ${\n                  layoutMode === 'horizontal'\n                    ? 'bg-white dark:bg-slate-700 text-primary-500 shadow-sm'\n                    : 'text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'\n                }`}\n                title=\"Horizontal Layout\"\n              >\n                <PanelTop size={18} />\n              </button>\n            </div>\n          )}\n\n          {/* Divider */}\n          <div className=\"hidden sm:block h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1\" />\n\n          {/* Theme Toggle */}\n          <button\n            onClick={toggleTheme}\n            className=\"p-2.5 text-slate-500 hover:text-amber-500 dark:hover:text-amber-400 hover:bg-amber-50 dark:hover:bg-amber-500/10 rounded-xl transition-all active:scale-95\"\n            title={theme === 'dark' ? 'Switch to Light Mode' : 'Switch to Dark Mode'}\n          >\n            {theme === 'dark' ? <Sun size={20} /> : <Moon size={20} />}\n          </button>\n\n          {/* Notifications */}\n          <button\n            className=\"relative p-2.5 text-slate-500 hover:text-primary-500 hover:bg-primary-50 dark:hover:bg-primary-500/10 rounded-xl transition-all active:scale-95\"\n            title=\"Notifications\"\n          >\n            <Bell size={20} />\n            {/* Notification badge with pulse animation */}\n            <span className=\"absolute top-1.5 right-1.5 flex h-2.5 w-2.5\">\n              <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75\"></span>\n              <span className=\"relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500\"></span>\n            </span>\n          </button>\n\n          {/* Divider */}\n          <div className=\"hidden sm:block h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1\" />\n\n          {/* User Menu */}\n          <div className=\"relative\" ref={userMenuRef}>\n            <button\n              onClick={() => setUserMenuOpen(!userMenuOpen)}\n              className={`flex items-center gap-2.5 p-1.5 pl-3 rounded-xl transition-all active:scale-[0.98] ${\n                userMenuOpen \n                  ? 'bg-primary-50 dark:bg-primary-500/10' \n                  : 'hover:bg-slate-100/80 dark:hover:bg-slate-800/80'\n              }`}\n            >\n              <div className=\"hidden sm:block text-right\">\n                <p className=\"text-sm font-medium text-slate-700 dark:text-slate-200\">{user?.name || 'User'}</p>\n                <p className=\"text-xs text-slate-500 dark:text-slate-400\">{user?.role || 'Guest'}</p>\n              </div>\n              <div className=\"relative\">\n                <div className=\"w-9 h-9 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-md\">\n                  <span className=\"text-white font-semibold text-sm\">\n                    {user?.name?.charAt(0) || 'U'}\n                  </span>\n                </div>\n                {/* Online indicator */}\n                <span className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-500 border-2 border-white dark:border-slate-900 rounded-full\" />\n              </div>\n              <ChevronDown\n                size={16}\n                className={`hidden sm:block text-slate-400 transition-transform duration-200 ${userMenuOpen ? 'rotate-180' : ''}`}\n              />\n            </button>\n\n            {/* Dropdown Menu */}\n            {userMenuOpen && (\n              <div className=\"absolute right-0 top-full mt-2 w-64 bg-white/95 dark:bg-slate-900/95 backdrop-blur-xl border border-slate-200/50 dark:border-slate-700/50 rounded-2xl shadow-xl shadow-slate-900/10 dark:shadow-slate-900/50 py-2 z-50 overflow-hidden\">\n                {/* User Info Header */}\n                <div className=\"px-4 py-3 bg-gradient-to-r from-primary-500/10 to-primary-600/5 dark:from-primary-500/20 dark:to-primary-600/10 border-b border-slate-200/50 dark:border-slate-700/50\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/25 shrink-0\">\n                      <span className=\"text-white font-bold text-sm\">\n                        {user?.name?.charAt(0) || 'U'}\n                      </span>\n                    </div>\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"font-medium text-sm text-slate-900 dark:text-white truncate\">{user?.name}</p>\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400 truncate\">{user?.username}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Menu Items */}\n                <div className=\"py-2\">\n                  <Link\n                    href=\"/profile\"\n                    onClick={() => setUserMenuOpen(false)}\n                    className=\"flex items-center gap-3 px-4 py-2.5 text-sm text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 hover:text-slate-900 dark:hover:text-white transition-colors group\"\n                  >\n                    <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-primary-100 dark:group-hover:bg-primary-500/20 transition-colors\">\n                      <User size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                    </div>\n                    <span>Profile</span>\n                  </Link>\n                  <Link\n                    href=\"/settings\"\n                    onClick={() => setUserMenuOpen(false)}\n                    className=\"flex items-center gap-3 px-4 py-2.5 text-sm text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 hover:text-slate-900 dark:hover:text-white transition-colors group\"\n                  >\n                    <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-primary-100 dark:group-hover:bg-primary-500/20 transition-colors\">\n                      <Settings size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                    </div>\n                    <span>Settings</span>\n                  </Link>\n                </div>\n\n                {/* Layout Toggle - Tablet and Mobile (below xl) */}\n                {onLayoutModeChange && (\n                  <div className=\"xl:hidden border-t border-slate-200/50 dark:border-slate-700/50 py-2\">\n                    <button\n                      onClick={toggleLayoutMode}\n                      className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-slate-600 dark:text-slate-400 hover:bg-slate-100/80 dark:hover:bg-slate-800/80 hover:text-slate-900 dark:hover:text-white transition-colors group\"\n                    >\n                      <div className=\"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-primary-100 dark:group-hover:bg-primary-500/20 transition-colors\">\n                        {layoutMode === 'sidebar' ? (\n                          <PanelTop size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                        ) : (\n                          <PanelLeft size={16} className=\"group-hover:text-primary-500 transition-colors\" />\n                        )}\n                      </div>\n                      <span>{layoutMode === 'sidebar' ? 'Horizontal Layout' : 'Sidebar Layout'}</span>\n                    </button>\n                  </div>\n                )}\n\n                {/* Logout */}\n                <div className=\"border-t border-slate-200/50 dark:border-slate-700/50 pt-2\">\n                  <button\n                    onClick={handleLogout}\n                    className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-500/10 transition-colors group\"\n                  >\n                    <div className=\"p-1.5 rounded-lg bg-red-50 dark:bg-red-500/10 group-hover:bg-red-100 dark:group-hover:bg-red-500/20 transition-colors\">\n                      <LogOut size={16} />\n                    </div>\n                    <span>Logout</span>\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3998, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/AdminLayout.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/AdminLayout.tsx\n// Description: Admin Layout - Main layout wrapper with sidebar/horizontal toggle\n//              Using xl breakpoint (1280px) for desktop, below uses mobile menu\n// =============================================================================\n\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Sidebar } from './Sidebar';\nimport { Header } from './Header';\nimport { HorizontalNav } from './HorizontalNav';\nimport { MobileMenu } from './MobileMenu';\n\ntype LayoutMode = 'sidebar' | 'horizontal';\n\ninterface AdminLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function AdminLayout({ children }: AdminLayoutProps) {\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [layoutMode, setLayoutMode] = useState<LayoutMode>('sidebar');\n\n  // Load layout preference from localStorage\n  useEffect(() => {\n    const savedMode = localStorage.getItem('layoutMode') as LayoutMode;\n    if (savedMode && (savedMode === 'sidebar' || savedMode === 'horizontal')) {\n      setLayoutMode(savedMode);\n    }\n  }, []);\n\n  // Save layout preference to localStorage\n  const handleLayoutModeChange = (mode: LayoutMode) => {\n    setLayoutMode(mode);\n    localStorage.setItem('layoutMode', mode);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-cyan-50/30 dark:from-slate-950 dark:via-blue-950/20 dark:to-slate-900\">\n      {/* Background Decorations */}\n      <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl\" />\n        <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl\" />\n        <div className=\"absolute top-1/2 left-1/2 w-96 h-96 bg-indigo-500/5 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2\" />\n      </div>\n\n      {/* Sidebar - Desktop only (xl: 1280px+) in sidebar mode */}\n      {layoutMode === 'sidebar' && (\n        <div className=\"hidden xl:block\">\n          <Sidebar\n            collapsed={sidebarCollapsed}\n            onToggle={() => setSidebarCollapsed(!sidebarCollapsed)}\n          />\n        </div>\n      )}\n\n      {/* Mobile Menu - Shows on tablet and mobile (below xl) */}\n      <MobileMenu\n        isOpen={mobileMenuOpen}\n        onClose={() => setMobileMenuOpen(false)}\n      />\n\n      {/* Main Content Area */}\n      <div\n        className={`\n          relative z-10\n          transition-all duration-300 ease-in-out\n          ${layoutMode === 'sidebar' \n            ? (sidebarCollapsed ? 'xl:ml-20' : 'xl:ml-64')\n            : 'xl:ml-0'\n          }\n        `}\n      >\n        {/* Header */}\n        <Header \n          onMenuClick={() => setMobileMenuOpen(true)} \n          layoutMode={layoutMode}\n          onLayoutModeChange={handleLayoutModeChange}\n        />\n\n        {/* Horizontal Navigation - Desktop (xl+) in horizontal mode */}\n        {layoutMode === 'horizontal' && (\n          <div className=\"hidden xl:block sticky top-16 z-20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-slate-200/50 dark:border-slate-800/50\">\n            <div className=\"px-4 py-2\">\n              <HorizontalNav />\n            </div>\n          </div>\n        )}\n\n        {/* Page Content */}\n        <main className=\"p-4 xl:p-6\">\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,8CAA8C;AAC9C,iFAAiF;AACjF,gFAAgF;AAChF,gFAAgF;;;;;;AAIhF;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAcO,SAAS,YAAY,EAAE,QAAQ,EAAoB;;IACxD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,uLAAQ,EAAC;IACzD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,uLAAQ,EAAC;IACrD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uLAAQ,EAAa;IAEzD,2CAA2C;IAC3C,IAAA,wLAAS;iCAAC;YACR,MAAM,YAAY,aAAa,OAAO,CAAC;YACvC,IAAI,aAAa,CAAC,cAAc,aAAa,cAAc,YAAY,GAAG;gBACxE,cAAc;YAChB;QACF;gCAAG,EAAE;IAEL,yCAAyC;IACzC,MAAM,yBAAyB,CAAC;QAC9B,cAAc;QACd,aAAa,OAAO,CAAC,cAAc;IACrC;IAEA,qBACE,2MAAC;QAAI,WAAU;;0BAEb,2MAAC;gBAAI,WAAU;;kCACb,2MAAC;wBAAI,WAAU;;;;;;kCACf,2MAAC;wBAAI,WAAU;;;;;;kCACf,2MAAC;wBAAI,WAAU;;;;;;;;;;;;YAIhB,eAAe,2BACd,2MAAC;gBAAI,WAAU;0BACb,cAAA,2MAAC,mKAAO;oBACN,WAAW;oBACX,UAAU,IAAM,oBAAoB,CAAC;;;;;;;;;;;0BAM3C,2MAAC,yKAAU;gBACT,QAAQ;gBACR,SAAS,IAAM,kBAAkB;;;;;;0BAInC,2MAAC;gBACC,WAAW,CAAC;;;UAGV,EAAE,eAAe,YACZ,mBAAmB,aAAa,aACjC,UACH;QACH,CAAC;;kCAGD,2MAAC,iKAAM;wBACL,aAAa,IAAM,kBAAkB;wBACrC,YAAY;wBACZ,oBAAoB;;;;;;oBAIrB,eAAe,8BACd,2MAAC;wBAAI,WAAU;kCACb,cAAA,2MAAC;4BAAI,WAAU;sCACb,cAAA,2MAAC,+KAAa;;;;;;;;;;;;;;;kCAMpB,2MAAC;wBAAK,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAKX;GA9EgB;KAAA"}},
    {"offset": {"line": 4163, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/layout/index.ts"],"sourcesContent":["// =============================================================================\n// File: src/components/layout/index.ts\n// Description: Export all layout components\n// =============================================================================\n\nexport * from './Sidebar';\nexport * from './HorizontalNav';\nexport * from './MobileMenu';\nexport * from './AdminLayout';\nexport * from './Header';"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,uCAAuC;AACvC,4CAA4C;AAC5C,gFAAgF;;AAEhF;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 4185, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/CustomSelect.tsx"],"sourcesContent":["// =============================================================================\n// File: src/components/ui/CustomSelect.tsx\n// Description: Modern Custom Select with Inline Search (Combobox Style)\n// =============================================================================\n\n'use client';\n\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport { ChevronDown, Check, Search, X, Loader2 } from 'lucide-react';\n\ninterface Option {\n  value: string;\n  label: string;\n  disabled?: boolean;\n  icon?: React.ReactNode;\n  description?: string;\n}\n\ninterface CustomSelectProps {\n  options: string[] | Option[];\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  theme?: 'primary' | 'gray' | 'success' | 'danger';\n  disabled?: boolean;\n  className?: string;\n  label?: string;\n  error?: string;\n  searchable?: boolean;\n  searchPlaceholder?: string;\n  maxHeight?: number;\n  size?: 'sm' | 'md' | 'lg';\n  clearable?: boolean;\n  usePortal?: boolean;\n  showBackdrop?: boolean;\n  dropdownTitle?: string;\n  loading?: boolean;\n  /** เปิดให้พิมพ์ค้นหาได้ในช่อง input โดยตรง */\n  typeToSearch?: boolean;\n}\n\n// ============================================\n// Dropdown Portal Component\n// ============================================\ninterface DropdownPortalProps {\n  children: React.ReactNode;\n  targetRef: React.RefObject<HTMLElement | null>;\n  inputRef: React.RefObject<HTMLElement | null>;\n  isOpen: boolean;\n  openUp: boolean;\n  maxHeight: number;\n  showBackdrop?: boolean;\n  onBackdropClick?: () => void;\n  floatingInput?: React.ReactNode;\n}\n\nconst DropdownPortal: React.FC<DropdownPortalProps> = ({\n  children,\n  targetRef,\n  inputRef,\n  isOpen,\n  openUp,\n  maxHeight,\n  showBackdrop = false,\n  onBackdropClick,\n  floatingInput,\n}) => {\n  const [position, setPosition] = useState({ top: 0, left: 0, width: 0 });\n  const [inputPosition, setInputPosition] = useState({ top: 0, left: 0, width: 0, height: 0 });\n\n  useEffect(() => {\n    if (!isOpen || !targetRef.current) return;\n\n    const updatePosition = () => {\n      const rect = targetRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      setPosition({\n        top: openUp ? rect.top - maxHeight - 8 : rect.bottom + 8,\n        left: rect.left,\n        width: rect.width,\n      });\n\n      // Update input position for floating input\n      if (inputRef.current && showBackdrop) {\n        const inputRect = inputRef.current.getBoundingClientRect();\n        setInputPosition({\n          top: inputRect.top,\n          left: inputRect.left,\n          width: inputRect.width,\n          height: inputRect.height,\n        });\n      }\n    };\n\n    updatePosition();\n\n    window.addEventListener('scroll', updatePosition, true);\n    window.addEventListener('resize', updatePosition);\n\n    return () => {\n      window.removeEventListener('scroll', updatePosition, true);\n      window.removeEventListener('resize', updatePosition);\n    };\n  }, [isOpen, targetRef, inputRef, openUp, maxHeight, showBackdrop]);\n\n  if (!isOpen || typeof window === 'undefined') return null;\n\n  return createPortal(\n    <>\n      {/* Backdrop */}\n      {showBackdrop && (\n        <div\n          className=\"fixed inset-0 bg-black/20 dark:bg-black/40 backdrop-blur-sm z-[9998] animate-in fade-in-0 duration-200\"\n          aria-hidden=\"true\"\n          onClick={onBackdropClick}\n        />\n      )}\n\n      {/* Floating Input (above backdrop) */}\n      {showBackdrop && floatingInput && (\n        <div\n          style={{\n            position: 'fixed',\n            top: inputPosition.top,\n            left: inputPosition.left,\n            width: inputPosition.width,\n            height: inputPosition.height,\n            zIndex: 9999,\n          }}\n        >\n          {floatingInput}\n        </div>\n      )}\n\n      {/* Dropdown */}\n      <div\n        style={{\n          position: 'fixed',\n          top: position.top,\n          left: position.left,\n          width: position.width,\n          zIndex: 9999,\n        }}\n      >\n        {children}\n      </div>\n    </>,\n    document.body\n  );\n};\n\n// ============================================\n// Main CustomSelect Component\n// ============================================\nconst CustomSelect: React.FC<CustomSelectProps> = ({\n  options,\n  value,\n  onChange,\n  placeholder = 'เลือก...',\n  theme: colorTheme = 'primary',\n  disabled = false,\n  className = '',\n  label,\n  error,\n  searchable = false,\n  searchPlaceholder = 'พิมพ์เพื่อค้นหา...',\n  maxHeight = 320,\n  size = 'md',\n  clearable = false,\n  usePortal = true,\n  showBackdrop = false,\n  dropdownTitle,\n  loading = false,\n  typeToSearch = true,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [openUp, setOpenUp] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\n  const [isTyping, setIsTyping] = useState(false);\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const inputContainerRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const floatingInputRef = useRef<HTMLInputElement>(null);\n  const optionsRef = useRef<HTMLDivElement>(null);\n\n  // Normalize options\n  const normalizedOptions: Option[] = options.map((option, index) =>\n    typeof option === 'string'\n      ? { value: option, label: option }\n      : { ...option, value: option.value || `option-${index}` }\n  );\n\n  // Filter options\n  const filteredOptions = searchQuery\n    ? normalizedOptions.filter((opt) =>\n        opt.label.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        opt.value.toLowerCase().includes(searchQuery.toLowerCase())\n      )\n    : normalizedOptions;\n\n  const currentOption = normalizedOptions.find((o) => o.value === value);\n  const displayValue = currentOption?.label || '';\n\n  // Calculate dropdown direction\n  const calculateDirection = useCallback(() => {\n    if (!containerRef.current) return false;\n    const rect = containerRef.current.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const spaceBelow = viewportHeight - rect.bottom;\n    const spaceAbove = rect.top;\n    return spaceBelow < maxHeight + 20 && spaceAbove > maxHeight + 20;\n  }, [maxHeight]);\n\n  // Handle click outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n\n      if (usePortal) {\n        const portalDropdown = document.querySelector('[data-select-dropdown]');\n        const isOutsideContainer = containerRef.current && !containerRef.current.contains(target);\n        const isOutsidePortal = !portalDropdown?.contains(target);\n\n        if (isOutsideContainer && isOutsidePortal) {\n          closeDropdown();\n        }\n      } else if (containerRef.current && !containerRef.current.contains(target)) {\n        closeDropdown();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [usePortal]);\n\n  // Keyboard navigation\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setHighlightedIndex((prev) =>\n            prev < filteredOptions.length - 1 ? prev + 1 : 0\n          );\n          break;\n        case 'ArrowUp':\n          e.preventDefault();\n          setHighlightedIndex((prev) =>\n            prev > 0 ? prev - 1 : filteredOptions.length - 1\n          );\n          break;\n        case 'Enter':\n          e.preventDefault();\n          if (highlightedIndex >= 0 && filteredOptions[highlightedIndex]) {\n            handleSelect(filteredOptions[highlightedIndex].value);\n          }\n          break;\n        case 'Escape':\n          e.preventDefault();\n          closeDropdown();\n          break;\n        case 'Tab':\n          closeDropdown();\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, highlightedIndex, filteredOptions]);\n\n  // Reset highlighted on search\n  useEffect(() => {\n    if (searchQuery) {\n      setHighlightedIndex(filteredOptions.length > 0 ? 0 : -1);\n    } else {\n      const currentIndex = filteredOptions.findIndex((o) => o.value === value);\n      setHighlightedIndex(currentIndex);\n    }\n  }, [searchQuery, filteredOptions, value]);\n\n  // Scroll highlighted into view\n  useEffect(() => {\n    if (highlightedIndex >= 0 && optionsRef.current) {\n      const option = optionsRef.current.children[highlightedIndex] as HTMLElement;\n      option?.scrollIntoView({ block: 'nearest' });\n    }\n  }, [highlightedIndex]);\n\n  // Focus input when opened\n  useEffect(() => {\n    if (isOpen && typeToSearch) {\n      // Small delay to ensure portal is rendered\n      setTimeout(() => {\n        if (showBackdrop && floatingInputRef.current) {\n          floatingInputRef.current.focus();\n        } else if (inputRef.current) {\n          inputRef.current.focus();\n        }\n      }, 50);\n    }\n  }, [isOpen, typeToSearch, showBackdrop]);\n\n  const openDropdown = () => {\n    if (disabled || loading) return;\n    setOpenUp(calculateDirection());\n    setIsOpen(true);\n    setIsTyping(false);\n    const currentIndex = normalizedOptions.findIndex((o) => o.value === value);\n    setHighlightedIndex(currentIndex);\n  };\n\n  const closeDropdown = () => {\n    setIsOpen(false);\n    setSearchQuery('');\n    setIsTyping(false);\n    setHighlightedIndex(-1);\n  };\n\n  const handleSelect = (optionValue: string) => {\n    onChange(optionValue);\n    closeDropdown();\n  };\n\n  const handleClear = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onChange('');\n    setSearchQuery('');\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const val = e.target.value;\n    setSearchQuery(val);\n    setIsTyping(val.length > 0);\n    if (!isOpen) {\n      openDropdown();\n    }\n  };\n\n  const handleInputFocus = () => {\n    if (!isOpen) {\n      openDropdown();\n    }\n  };\n\n  const handleInputClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (!isOpen) {\n      openDropdown();\n    }\n  };\n\n  // Theme styles\n  const themeStyles = {\n    primary: {\n      ring: 'ring-primary-500/30',\n      border: 'border-primary-500',\n      selected: 'bg-primary-50 dark:bg-primary-500/15 text-primary-700 dark:text-primary-300',\n      hover: 'hover:bg-primary-50/50 dark:hover:bg-primary-500/10',\n      highlighted: 'bg-primary-100/70 dark:bg-primary-500/20',\n      check: 'text-primary-500',\n      indicator: 'bg-primary-500',\n    },\n    gray: {\n      ring: 'ring-slate-400/30',\n      border: 'border-slate-400',\n      selected: 'bg-slate-100 dark:bg-slate-600/20 text-slate-700 dark:text-slate-200',\n      hover: 'hover:bg-slate-50 dark:hover:bg-slate-700/50',\n      highlighted: 'bg-slate-100 dark:bg-slate-700/70',\n      check: 'text-slate-600 dark:text-slate-400',\n      indicator: 'bg-slate-500',\n    },\n    success: {\n      ring: 'ring-emerald-500/30',\n      border: 'border-emerald-500',\n      selected: 'bg-emerald-50 dark:bg-emerald-500/15 text-emerald-700 dark:text-emerald-300',\n      hover: 'hover:bg-emerald-50/50 dark:hover:bg-emerald-500/10',\n      highlighted: 'bg-emerald-100/70 dark:bg-emerald-500/20',\n      check: 'text-emerald-500',\n      indicator: 'bg-emerald-500',\n    },\n    danger: {\n      ring: 'ring-red-500/30',\n      border: 'border-red-500',\n      selected: 'bg-red-50 dark:bg-red-500/15 text-red-700 dark:text-red-300',\n      hover: 'hover:bg-red-50/50 dark:hover:bg-red-500/10',\n      highlighted: 'bg-red-100/70 dark:bg-red-500/20',\n      check: 'text-red-500',\n      indicator: 'bg-red-500',\n    },\n  };\n\n  const colors = themeStyles[colorTheme];\n\n  // Size classes\n  const sizeClasses = {\n    sm: {\n      container: 'h-9',\n      input: 'text-sm',\n      option: 'px-3 py-2 text-sm',\n      icon: 14,\n    },\n    md: {\n      container: 'h-11',\n      input: 'text-sm',\n      option: 'px-4 py-2.5 text-sm',\n      icon: 16,\n    },\n    lg: {\n      container: 'h-12',\n      input: 'text-base',\n      option: 'px-4 py-3 text-base',\n      icon: 18,\n    },\n  };\n\n  const sizes = sizeClasses[size];\n\n  // Calculate header height for maxHeight\n  const headerHeight = dropdownTitle || label ? 52 : 0;\n  const searchHeight = searchable && !typeToSearch ? 56 : 0;\n  const footerHeight = filteredOptions.length > 5 ? 40 : 0;\n  const optionsMaxHeight = maxHeight - headerHeight - searchHeight - footerHeight;\n\n  // Dropdown content\n  const dropdownContent = (\n    <div\n      data-select-dropdown\n      className=\"\n        w-full overflow-hidden\n        bg-white dark:bg-slate-800\n        border border-slate-200 dark:border-slate-700\n        rounded-xl\n        shadow-xl shadow-slate-900/10 dark:shadow-black/40\n        ring-1 ring-black/5 dark:ring-white/5\n        animate-in fade-in-0 zoom-in-95 slide-in-from-top-2\n        duration-200\n      \"\n    >\n      {/* Header */}\n      {(dropdownTitle || label) && (\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-slate-100 dark:border-slate-700/50 bg-gradient-to-r from-slate-50 to-slate-100/50 dark:from-slate-800 dark:to-slate-800/50\">\n          <div className=\"flex items-center gap-2\">\n            <div className={`size-2 rounded-full ${colors.indicator}`} />\n            <span className=\"font-medium text-sm text-slate-700 dark:text-slate-200\">\n              {dropdownTitle || label}\n            </span>\n            {filteredOptions.length > 0 && (\n              <span className=\"text-xs text-slate-400 dark:text-slate-500 tabular-nums\">\n                ({filteredOptions.length})\n              </span>\n            )}\n          </div>\n          <button\n            type=\"button\"\n            onClick={closeDropdown}\n            className=\"p-1.5 rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-200/70 dark:hover:bg-slate-700/70 transition-colors\"\n          >\n            <X size={16} />\n          </button>\n        </div>\n      )}\n\n      {/* Separate Search (when typeToSearch is false) */}\n      {searchable && !typeToSearch && (\n        <div className=\"p-2 border-b border-slate-100 dark:border-slate-700/50\">\n          <div className=\"relative\">\n            <Search\n              size={16}\n              className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500\"\n            />\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              placeholder={searchPlaceholder}\n              className=\"\n                w-full h-9 pl-9 pr-3\n                text-sm\n                bg-slate-50 dark:bg-slate-900/50\n                border border-slate-200 dark:border-slate-700\n                rounded-lg\n                placeholder:text-slate-400 dark:placeholder:text-slate-500\n                focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500\n                transition-colors\n              \"\n              autoFocus\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Options */}\n      <div\n        ref={optionsRef}\n        className=\"overflow-y-auto overscroll-contain\"\n        style={{ maxHeight: optionsMaxHeight }}\n      >\n        {loading ? (\n          <div className=\"px-4 py-8 text-center\">\n            <Loader2 className=\"size-6 text-primary-500 animate-spin mx-auto mb-2\" />\n            <div className=\"text-slate-400 dark:text-slate-500 text-sm\">กำลังโหลด...</div>\n          </div>\n        ) : filteredOptions.length === 0 ? (\n          <div className=\"px-4 py-8 text-center\">\n            <div className=\"text-slate-400 dark:text-slate-500 text-sm\">\n              {searchQuery ? (\n                <div className=\"space-y-2\">\n                  <Search size={28} className=\"mx-auto opacity-40\" />\n                  <div>\n                    ไม่พบ \"<span className=\"font-medium text-slate-600 dark:text-slate-300\">{searchQuery}</span>\"\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={() => setSearchQuery('')}\n                    className=\"text-xs text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\"\n                  >\n                    ล้างการค้นหา\n                  </button>\n                </div>\n              ) : (\n                'ไม่มีตัวเลือก'\n              )}\n            </div>\n          </div>\n        ) : (\n          <div className=\"py-1\">\n            {filteredOptions.map((option, index) => {\n              const isSelected = value === option.value;\n              const isHighlighted = highlightedIndex === index;\n\n              return (\n                <button\n                  key={`${option.value}-${index}`}\n                  type=\"button\"\n                  disabled={option.disabled}\n                  onClick={() => handleSelect(option.value)}\n                  onMouseEnter={() => setHighlightedIndex(index)}\n                  className={`\n                    relative w-full text-left transition-all duration-100\n                    flex items-center gap-3\n                    ${sizes.option}\n                    ${option.disabled ? 'opacity-40 cursor-not-allowed' : 'cursor-pointer'}\n                    ${isSelected ? colors.selected : 'text-slate-700 dark:text-slate-200'}\n                    ${isHighlighted && !isSelected ? colors.highlighted : ''}\n                    ${!isHighlighted && !isSelected ? colors.hover : ''}\n                  `}\n                >\n                  {/* Selected indicator bar */}\n                  {isSelected && (\n                    <span className={`absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 rounded-r-full ${colors.indicator}`} />\n                  )}\n\n                  {/* Icon */}\n                  {option.icon && (\n                    <span className=\"shrink-0 text-slate-400 dark:text-slate-500\">\n                      {option.icon}\n                    </span>\n                  )}\n\n                  {/* Label & Description */}\n                  <span className=\"flex-1 min-w-0\">\n                    <span className={`block truncate ${isSelected ? 'font-medium' : ''}`}>\n                      {/* Highlight matching text */}\n                      {searchQuery ? (\n                        <HighlightText text={option.label} query={searchQuery} />\n                      ) : (\n                        option.label\n                      )}\n                    </span>\n                    {option.description && (\n                      <span className=\"block text-xs text-slate-400 dark:text-slate-500 truncate mt-0.5\">\n                        {option.description}\n                      </span>\n                    )}\n                  </span>\n\n                  {/* Check icon */}\n                  {isSelected && (\n                    <span className={`shrink-0 ${colors.check}`}>\n                      <Check size={sizes.icon} strokeWidth={2.5} />\n                    </span>\n                  )}\n                </button>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Footer hint */}\n      {filteredOptions.length > 5 && (\n        <div className=\"px-3 py-2 border-t border-slate-100 dark:border-slate-700/50 bg-slate-50/50 dark:bg-slate-900/30\">\n          <p className=\"text-xs text-slate-400 dark:text-slate-500 text-center\">\n            ↑↓ เลื่อน • Enter เลือก • Esc ปิด\n          </p>\n        </div>\n      )}\n    </div>\n  );\n\n  return (\n    <div \n      className={`\n        relative \n        ${isOpen && showBackdrop ? 'z-[9999]' : ''} \n        ${className}\n      `} \n      ref={containerRef}\n    >\n      {/* Label */}\n      {label && (\n        <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5\">\n          {label}\n        </label>\n      )}\n\n      {/* Input Container */}\n      <div\n        ref={inputContainerRef}\n        onClick={openDropdown}\n        className={`\n          group relative w-full rounded-xl\n          flex items-center gap-2 px-4\n          ${sizes.container}\n          border transition-all duration-200 cursor-pointer\n          ${isOpen && showBackdrop ? 'invisible' : ''}\n          ${disabled || loading\n            ? 'opacity-50 cursor-not-allowed bg-slate-100 dark:bg-slate-800'\n            : ''\n          }\n          ${error\n            ? 'border-red-300 dark:border-red-500/50 bg-red-50/30 dark:bg-red-500/5'\n            : isOpen\n              ? `ring-2 ${colors.ring} ${colors.border} bg-white dark:bg-slate-800 shadow-lg`\n              : 'border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:border-slate-300 dark:hover:border-slate-600 hover:shadow-sm'\n          }\n        `}\n      >\n        {/* Search Icon (when typing) */}\n        {typeToSearch && isTyping && (\n          <Search size={16} className=\"shrink-0 text-slate-400 dark:text-slate-500\" />\n        )}\n\n        {/* Input Field */}\n        {typeToSearch ? (\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={isTyping || isOpen ? searchQuery : displayValue}\n            onChange={handleInputChange}\n            onFocus={handleInputFocus}\n            onClick={handleInputClick}\n            placeholder={isOpen ? searchPlaceholder : placeholder}\n            disabled={disabled || loading}\n            className={`\n              flex-1 min-w-0 bg-transparent outline-none\n              ${sizes.input}\n              ${displayValue && !isTyping && !isOpen\n                ? 'text-slate-900 dark:text-slate-100'\n                : 'text-slate-900 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500'\n              }\n              ${disabled || loading ? 'cursor-not-allowed' : 'cursor-text'}\n            `}\n            autoComplete=\"off\"\n            spellCheck={false}\n          />\n        ) : (\n          <span\n            className={`\n              flex-1 truncate ${sizes.input}\n              ${displayValue ? 'text-slate-900 dark:text-slate-100' : 'text-slate-400 dark:text-slate-500'}\n            `}\n          >\n            {displayValue || placeholder}\n          </span>\n        )}\n\n        {/* Actions */}\n        <div className=\"flex items-center gap-1 shrink-0\">\n          {/* Loading */}\n          {loading && (\n            <Loader2 size={16} className=\"text-slate-400 animate-spin\" />\n          )}\n\n          {/* Clear button */}\n          {clearable && value && !disabled && !loading && (\n            <button\n              type=\"button\"\n              onClick={handleClear}\n              className=\"p-1 rounded-md text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors\"\n            >\n              <X size={14} />\n            </button>\n          )}\n\n          {/* Chevron */}\n          {!loading && (\n            <span\n              className={`\n                text-slate-400 dark:text-slate-500 transition-transform duration-200\n                ${isOpen ? 'rotate-180' : ''}\n              `}\n            >\n              <ChevronDown size={sizes.icon} />\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Error message */}\n      {error && (\n        <p className=\"mt-1.5 text-xs text-red-500 dark:text-red-400 flex items-center gap-1\">\n          <span className=\"size-1 rounded-full bg-red-500\" />\n          {error}\n        </p>\n      )}\n\n      {/* Dropdown */}\n      {usePortal ? (\n        <DropdownPortal\n          targetRef={containerRef}\n          inputRef={inputContainerRef}\n          isOpen={isOpen}\n          openUp={openUp}\n          maxHeight={maxHeight}\n          showBackdrop={showBackdrop}\n          onBackdropClick={closeDropdown}\n          floatingInput={\n            <div\n              className={`\n                w-full rounded-xl\n                flex items-center gap-2 px-4\n                ${sizes.container}\n                border transition-all duration-200\n                ring-2 ${colors.ring} ${colors.border} \n                bg-white dark:bg-slate-800 shadow-xl\n              `}\n            >\n              {/* Search Icon (when typing) */}\n              {typeToSearch && isTyping && (\n                <Search size={16} className=\"shrink-0 text-slate-400 dark:text-slate-500\" />\n              )}\n\n              {/* Input Field */}\n              {typeToSearch ? (\n                <input\n                  ref={floatingInputRef}\n                  type=\"text\"\n                  value={isTyping || isOpen ? searchQuery : displayValue}\n                  onChange={handleInputChange}\n                  onClick={handleInputClick}\n                  placeholder={isOpen ? searchPlaceholder : placeholder}\n                  disabled={disabled || loading}\n                  className={`\n                    flex-1 min-w-0 bg-transparent outline-none\n                    ${sizes.input}\n                    text-slate-900 dark:text-slate-100 \n                    placeholder:text-slate-400 dark:placeholder:text-slate-500\n                  `}\n                  autoComplete=\"off\"\n                  spellCheck={false}\n                />\n              ) : (\n                <span\n                  className={`\n                    flex-1 truncate ${sizes.input}\n                    ${displayValue ? 'text-slate-900 dark:text-slate-100' : 'text-slate-400 dark:text-slate-500'}\n                  `}\n                >\n                  {displayValue || placeholder}\n                </span>\n              )}\n\n              {/* Actions */}\n              <div className=\"flex items-center gap-1 shrink-0\">\n                {loading && (\n                  <Loader2 size={16} className=\"text-slate-400 animate-spin\" />\n                )}\n                {clearable && value && !disabled && !loading && (\n                  <button\n                    type=\"button\"\n                    onClick={handleClear}\n                    className=\"p-1 rounded-md text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors\"\n                  >\n                    <X size={14} />\n                  </button>\n                )}\n                {!loading && (\n                  <span className=\"text-slate-400 dark:text-slate-500 rotate-180\">\n                    <ChevronDown size={sizes.icon} />\n                  </span>\n                )}\n              </div>\n            </div>\n          }\n        >\n          {dropdownContent}\n        </DropdownPortal>\n      ) : (\n        isOpen && (\n          <div className={`absolute z-50 w-full ${openUp ? 'bottom-full mb-2' : 'top-full mt-2'}`}>\n            {dropdownContent}\n          </div>\n        )\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// Highlight Text Component\n// ============================================\nconst HighlightText: React.FC<{ text: string; query: string }> = ({ text, query }) => {\n  if (!query) return <>{text}</>;\n\n  const parts = text.split(new RegExp(`(${query})`, 'gi'));\n\n  return (\n    <>\n      {parts.map((part, i) =>\n        part.toLowerCase() === query.toLowerCase() ? (\n          <mark\n            key={i}\n            className=\"bg-amber-200/70 dark:bg-amber-500/30 text-inherit rounded px-0.5\"\n          >\n            {part}\n          </mark>\n        ) : (\n          <span key={i}>{part}</span>\n        )\n      )}\n    </>\n  );\n};\n\nexport default CustomSelect;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5209, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/useSmartCardReader.ts"],"sourcesContent":["// src/hooks/useSmartCardReader.ts\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\n\n// Types for Smart Card data (Go server format)\nexport interface SmartCardData {\n  cid: string;\n  cid_formatted: string;\n  name_th: {\n    prefix: string;\n    firstname: string;\n    lastname: string;\n  };\n  name_en: {\n    prefix: string;\n    firstname: string;\n    lastname: string;\n  };\n  dob: string;\n  gender: string;\n  gender_desc: string;\n  address: string;\n  issue_date: string;\n  expire_date: string;\n  photo?: string;\n  read_time_ms?: number;\n}\n\n// Go server message types\ninterface ServerMessage {\n  type: 'connected' | 'card_inserted' | 'card_removed' | 'error';\n  payload: {\n    data?: SmartCardData;\n    success?: boolean;\n    config?: {\n      auto_read: boolean;\n      auto_read_interval: number;\n      include_photo: boolean;\n    };\n    status?: string;\n    reader?: string;\n    message?: string;\n  };\n}\n\nexport interface SmartCardReaderState {\n  isConnected: boolean;\n  isReading: boolean;\n  cardData: SmartCardData | null;\n  error: string | null;\n  readerStatus: 'disconnected' | 'connecting' | 'connected' | 'card_inserted' | 'reading' | 'success' | 'error';\n  readerName: string | null;\n}\n\ninterface UseSmartCardReaderOptions {\n  serverUrl?: string;\n  autoConnect?: boolean;\n  onCardRead?: (data: SmartCardData) => void;\n  onError?: (error: string) => void;\n  onConnect?: () => void;\n  onDisconnect?: () => void;\n}\n\nexport function useSmartCardReader(options: UseSmartCardReaderOptions = {}) {\n  const {\n    serverUrl = 'http://localhost:8080',\n    autoConnect = false,\n  } = options;\n\n  // Convert http(s) to ws(s)\n  const wsUrl = serverUrl.replace(/^http/, 'ws') + '/ws';\n\n  // Use refs for callbacks to avoid dependency issues\n  const onCardReadRef = useRef(options.onCardRead);\n  const onErrorRef = useRef(options.onError);\n  const onConnectRef = useRef(options.onConnect);\n  const onDisconnectRef = useRef(options.onDisconnect);\n\n  // Update refs when callbacks change\n  useEffect(() => {\n    onCardReadRef.current = options.onCardRead;\n    onErrorRef.current = options.onError;\n    onConnectRef.current = options.onConnect;\n    onDisconnectRef.current = options.onDisconnect;\n  }, [options.onCardRead, options.onError, options.onConnect, options.onDisconnect]);\n\n  const wsRef = useRef<WebSocket | null>(null);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const reconnectAttemptsRef = useRef(0);\n  const maxReconnectAttempts = 5;\n\n  const [state, setState] = useState<SmartCardReaderState>({\n    isConnected: false,\n    isReading: false,\n    cardData: null,\n    error: null,\n    readerStatus: 'disconnected',\n    readerName: null,\n  });\n\n  // Handle incoming messages from Go server\n  const handleMessage = useCallback((event: MessageEvent) => {\n    try {\n      const message: ServerMessage = JSON.parse(event.data);\n      console.log('WebSocket message received:', message);\n\n      switch (message.type) {\n        case 'connected':\n          console.log('Server connected, config:', message.payload.config);\n          setState(prev => ({\n            ...prev,\n            isConnected: true,\n            error: null,\n            readerStatus: 'connected',\n          }));\n          onConnectRef.current?.();\n          break;\n\n        case 'card_inserted':\n          if (message.payload.success && message.payload.data) {\n            console.log('Card data received:', message.payload.data);\n            setState(prev => ({\n              ...prev,\n              isReading: false,\n              cardData: message.payload.data!,\n              readerStatus: 'success',\n              error: null,\n            }));\n            onCardReadRef.current?.(message.payload.data);\n          } else {\n            setState(prev => ({\n              ...prev,\n              isReading: true,\n              readerStatus: 'reading',\n              error: null,\n            }));\n          }\n          break;\n\n        case 'card_removed':\n          console.log('Card removed from:', message.payload.reader);\n          setState(prev => ({\n            ...prev,\n            readerStatus: prev.isConnected ? 'connected' : 'disconnected',\n            cardData: null,\n            isReading: false,\n            readerName: message.payload.reader || null,\n          }));\n          break;\n\n        case 'error':\n          const errorMsg = message.payload.message || 'เกิดข้อผิดพลาด';\n          console.error('Server error:', errorMsg);\n          setState(prev => ({\n            ...prev,\n            isReading: false,\n            error: errorMsg,\n            readerStatus: 'error',\n          }));\n          onErrorRef.current?.(errorMsg);\n          break;\n\n        default:\n          console.log('Unknown message type:', message);\n      }\n    } catch (err) {\n      console.error('Failed to parse message:', err, event.data);\n    }\n  }, []);\n\n  // Connect to WebSocket server\n  const connect = useCallback(() => {\n    // Clean up existing connection\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n\n    // Clear any pending reconnect\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n\n    setState(prev => ({ \n      ...prev, \n      error: null, \n      readerStatus: 'connecting' \n    }));\n\n    try {\n      console.log('Connecting to WebSocket:', wsUrl);\n      const ws = new WebSocket(wsUrl);\n      wsRef.current = ws;\n\n      ws.onopen = () => {\n        console.log('WebSocket connected');\n        reconnectAttemptsRef.current = 0;\n        // Wait for 'connected' message from server to confirm\n      };\n\n      ws.onmessage = handleMessage;\n\n      ws.onclose = (event) => {\n        console.log('WebSocket closed:', event.code, event.reason);\n        wsRef.current = null;\n        \n        setState(prev => ({\n          ...prev,\n          isConnected: false,\n          isReading: false,\n          readerStatus: 'disconnected',\n        }));\n        \n        onDisconnectRef.current?.();\n\n        // Auto reconnect if not intentional close\n        if (event.code !== 1000 && reconnectAttemptsRef.current < maxReconnectAttempts) {\n          reconnectAttemptsRef.current++;\n          const delay = Math.min(1000 * Math.pow(2, reconnectAttemptsRef.current), 10000);\n          console.log(`Reconnecting in ${delay}ms (attempt ${reconnectAttemptsRef.current})`);\n          \n          reconnectTimeoutRef.current = setTimeout(() => {\n            connect();\n          }, delay);\n        }\n      };\n\n      ws.onerror = (error) => {\n        console.error('WebSocket error:', error);\n        const errorMsg = 'ไม่สามารถเชื่อมต่อเครื่องอ่านบัตรได้';\n        setState(prev => ({\n          ...prev,\n          isConnected: false,\n          isReading: false,\n          error: errorMsg,\n          readerStatus: 'error',\n        }));\n        onErrorRef.current?.(errorMsg);\n      };\n\n    } catch (error) {\n      console.error('Failed to create WebSocket:', error);\n      const errorMsg = 'ไม่สามารถสร้างการเชื่อมต่อได้';\n      setState(prev => ({\n        ...prev,\n        error: errorMsg,\n        readerStatus: 'error',\n      }));\n      onErrorRef.current?.(errorMsg);\n    }\n  }, [wsUrl, handleMessage]);\n\n  // Disconnect from server\n  const disconnect = useCallback(() => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n    \n    reconnectAttemptsRef.current = maxReconnectAttempts; // Prevent auto reconnect\n    \n    if (wsRef.current) {\n      wsRef.current.close(1000, 'User disconnect');\n      wsRef.current = null;\n    }\n\n    setState(prev => ({\n      ...prev,\n      isConnected: false,\n      isReading: false,\n      readerStatus: 'disconnected',\n    }));\n  }, []);\n\n  // Request card read (if server supports manual read request)\n  const readCard = useCallback(() => {\n    if (!wsRef.current || wsRef.current.readyState !== WebSocket.OPEN) {\n      const errorMsg = 'ยังไม่ได้เชื่อมต่อเครื่องอ่านบัตร';\n      setState(prev => ({ ...prev, error: errorMsg }));\n      onErrorRef.current?.(errorMsg);\n      return;\n    }\n\n    setState(prev => ({\n      ...prev,\n      isReading: true,\n      error: null,\n      readerStatus: 'reading',\n    }));\n\n    // Send read request to server\n    wsRef.current.send(JSON.stringify({ type: 'read_card' }));\n  }, []);\n\n  // Clear card data\n  const clearCardData = useCallback(() => {\n    setState(prev => ({\n      ...prev,\n      cardData: null,\n      error: null,\n      readerStatus: prev.isConnected ? 'connected' : 'disconnected',\n    }));\n  }, []);\n\n  // Reset state\n  const resetState = useCallback(() => {\n    setState({\n      isConnected: false,\n      isReading: false,\n      cardData: null,\n      error: null,\n      readerStatus: 'disconnected',\n      readerName: null,\n    });\n  }, []);\n\n  // Auto connect on mount if enabled\n  useEffect(() => {\n    if (autoConnect) {\n      connect();\n    }\n\n    return () => {\n      if (reconnectTimeoutRef.current) {\n        clearTimeout(reconnectTimeoutRef.current);\n      }\n      if (wsRef.current) {\n        wsRef.current.close(1000, 'Component unmount');\n        wsRef.current = null;\n      }\n    };\n  }, [autoConnect, connect]);\n\n  return {\n    ...state,\n    connect,\n    disconnect,\n    readCard,\n    clearCardData,\n    resetState,\n  };\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5535, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/ui/SmartCardButton.tsx"],"sourcesContent":["// src/components/ui/SmartCardButton.tsx\n\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport { CreditCard, Wifi, WifiOff, Loader2, Check, AlertCircle, X } from 'lucide-react';\nimport { useSmartCardReader, SmartCardData } from '@/hooks/useSmartCardReader';\nimport { patientApi } from '@/lib/api';\nimport { PatientListItem } from '@/types/patient.types';\n\ninterface SmartCardButtonProps {\n  onPatientFound: (hn: string, patient: PatientListItem, cardPhoto?: string | null) => void;\n  onNewPatient?: (cardData: SmartCardData) => void;\n  onError?: (error: string) => void;\n  disabled?: boolean;\n  className?: string;\n  serverUrl?: string;\n}\n\nexport function SmartCardButton({\n  onPatientFound,\n  onNewPatient,\n  onError,\n  disabled = false,\n  className = '',\n  serverUrl = 'http://localhost:8080',\n}: SmartCardButtonProps) {\n  const [isSearching, setIsSearching] = useState(false);\n  const [showStatus, setShowStatus] = useState(false);\n  const [statusMessage, setStatusMessage] = useState('');\n\n  const {\n    isConnected,\n    isReading,\n    cardData,\n    error,\n    readerStatus,\n    connect,\n    disconnect,\n    readCard,\n    clearCardData,\n  } = useSmartCardReader({\n    serverUrl,\n    autoConnect: false,\n    onCardRead: handleCardRead,\n    onError: (err) => {\n      setStatusMessage(err);\n      onError?.(err);\n    },\n    onConnect: () => {\n      setStatusMessage('เชื่อมต่อเครื่องอ่านบัตรแล้ว - รอเสียบบัตร');\n    },\n    onDisconnect: () => {\n      setStatusMessage('ยกเลิกการเชื่อมต่อแล้ว');\n    },\n  });\n\n  // Handle card data and search for patient\n  async function handleCardRead(data: SmartCardData) {\n    if (!data.cid) {\n      const errMsg = 'ไม่พบเลขบัตรประชาชนในข้อมูลบัตร';\n      setStatusMessage(errMsg);\n      onError?.(errMsg);\n      return;\n    }\n\n    setIsSearching(true);\n    setStatusMessage(`กำลังค้นหาผู้ป่วย CID: ${data.cid_formatted || formatCid(data.cid)}...`);\n\n    try {\n      // Search patient by CID using patientApi.getList\n      const response = await patientApi.getList({\n        search: data.cid,\n        limit: 1,\n      });\n\n      if (response.data && response.data.length > 0) {\n        // Found existing patient\n        const patient = response.data[0];\n        setStatusMessage(`พบผู้ป่วย: ${patient.fullName}`);\n        \n        // Pass card photo as fallback (base64 with data URI prefix)\n        const cardPhoto = data.photo \n          ? `data:image/jpeg;base64,${data.photo}`\n          : null;\n        onPatientFound(patient.hn, patient, cardPhoto);\n      } else {\n        // New patient - not found in database\n        setStatusMessage(`ไม่พบข้อมูลในระบบ: ${data.name_th.prefix}${data.name_th.firstname} ${data.name_th.lastname}`);\n        onNewPatient?.(data);\n      }\n    } catch (err) {\n      console.error('Error searching patient:', err);\n      const errMsg = 'เกิดข้อผิดพลาดในการค้นหาผู้ป่วย';\n      setStatusMessage(errMsg);\n      onError?.(errMsg);\n    } finally {\n      setIsSearching(false);\n    }\n  }\n\n  // Format CID for display\n  function formatCid(cid: string): string {\n    if (!cid || cid.length !== 13) return cid;\n    return `${cid.slice(0, 1)}-${cid.slice(1, 5)}-${cid.slice(5, 10)}-${cid.slice(10, 12)}-${cid.slice(12)}`;\n  }\n\n  // Handle button click\n  const handleClick = async () => {\n    if (disabled || isReading || isSearching) return;\n\n    setShowStatus(true);\n\n    if (!isConnected) {\n      setStatusMessage('กำลังเชื่อมต่อเครื่องอ่านบัตร...');\n      connect();\n    } else if (cardData) {\n      // Card already inserted, search patient\n      setStatusMessage(`กำลังค้นหาผู้ป่วย CID: ${cardData.cid_formatted || formatCid(cardData.cid)}...`);\n      handleCardRead(cardData);\n    } else {\n      // Connected but no card, wait for card\n      setStatusMessage('รอเสียบบัตรประชาชน...');\n    }\n  };\n\n  // Close status popup\n  const handleCloseStatus = () => {\n    setShowStatus(false);\n    clearCardData();\n  };\n\n  // Handle disconnect\n  const handleDisconnect = () => {\n    disconnect();\n    setShowStatus(false);\n    clearCardData();\n  };\n\n  // Auto-hide status after success\n  useEffect(() => {\n    if (readerStatus === 'success' && !isSearching) {\n      const timer = setTimeout(() => {\n        setShowStatus(false);\n      }, 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [readerStatus, isSearching]);\n\n  // Get button state\n  const isLoading = isReading || isSearching;\n  const buttonDisabled = disabled || isLoading;\n\n  // Get status icon and color\n  const getStatusIcon = () => {\n    if (isLoading) return <Loader2 size={16} className=\"animate-spin\" />;\n    if (error) return <AlertCircle size={16} />;\n    if (readerStatus === 'success') return <Check size={16} />;\n    if (isConnected) return <Wifi size={16} />;\n    return <WifiOff size={16} />;\n  };\n\n  const getStatusColor = () => {\n    if (error) return 'text-red-500';\n    if (readerStatus === 'success') return 'text-emerald-500';\n    if (isConnected) return 'text-emerald-500';\n    return 'text-slate-400';\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* Main Button */}\n      <button\n        onClick={handleClick}\n        disabled={buttonDisabled}\n        className={`\n          relative px-3 py-3 rounded-xl transition-all duration-200\n          flex items-center justify-center gap-2\n          ${buttonDisabled\n            ? 'bg-slate-100 dark:bg-slate-800 text-slate-400 cursor-not-allowed'\n            : isConnected\n              ? 'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 hover:bg-emerald-100 dark:hover:bg-emerald-500/20 border border-emerald-200 dark:border-emerald-500/30'\n              : 'bg-amber-50 dark:bg-amber-500/10 text-amber-600 dark:text-amber-400 hover:bg-amber-100 dark:hover:bg-amber-500/20 border border-amber-200 dark:border-amber-500/30'\n          }\n          ${className}\n        `}\n        title={isConnected ? 'เชื่อมต่อแล้ว - รอเสียบบัตร' : 'เชื่อมต่อเครื่องอ่านบัตร'}\n      >\n        {isLoading ? (\n          <Loader2 size={18} className=\"animate-spin\" />\n        ) : (\n          <>\n            <CreditCard size={18} />\n            <span className=\"font-medium text-sm\">SC</span>\n          </>\n        )}\n\n        {/* Connection indicator dot */}\n        <span\n          className={`\n            absolute -top-1 -right-1 size-3 rounded-full border-2 border-white dark:border-slate-900\n            ${isConnected ? 'bg-emerald-500' : 'bg-slate-300 dark:bg-slate-600'}\n            ${isLoading ? 'animate-pulse' : ''}\n          `}\n        />\n      </button>\n\n      {/* Status Popup */}\n      {showStatus && (\n        <div className=\"absolute top-full right-0 mt-2 z-50 animate-in fade-in slide-in-from-top-2 duration-200\">\n          <div className=\"bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 p-4 min-w-[300px] max-w-[360px]\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"flex items-center gap-2\">\n                <div className={`${getStatusColor()}`}>\n                  {getStatusIcon()}\n                </div>\n                <span className=\"font-medium text-sm text-slate-900 dark:text-white\">\n                  Smart Card Reader\n                </span>\n              </div>\n              <button\n                onClick={handleCloseStatus}\n                className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors\"\n              >\n                <X size={16} />\n              </button>\n            </div>\n\n            {/* Status Message */}\n            <div className={`\n              text-sm p-3 rounded-lg\n              ${error\n                ? 'bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400'\n                : readerStatus === 'success'\n                  ? 'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400'\n                  : 'bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400'\n              }\n            `}>\n              {statusMessage || 'พร้อมเชื่อมต่อ'}\n            </div>\n\n            {/* Card Data Preview (if available) */}\n            {cardData && (\n              <div className=\"mt-3 pt-3 border-t border-slate-100 dark:border-slate-800\">\n                <div className=\"flex gap-3\">\n                  {/* Photo */}\n                  {cardData.photo && (\n                    <div className=\"shrink-0\">\n                      <img \n                        src={`data:image/jpeg;base64,${cardData.photo}`}\n                        alt=\"Photo\"\n                        className=\"size-16 rounded-lg object-cover border border-slate-200 dark:border-slate-700\"\n                      />\n                    </div>\n                  )}\n                  {/* Info */}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"text-sm font-medium text-slate-900 dark:text-white truncate\">\n                      {cardData.name_th.prefix}{cardData.name_th.firstname} {cardData.name_th.lastname}\n                    </div>\n                    <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-0.5\">\n                      {cardData.name_en.prefix} {cardData.name_en.firstname} {cardData.name_en.lastname}\n                    </div>\n                    <div className=\"text-xs font-mono text-slate-500 dark:text-slate-400 mt-1\">\n                      {cardData.cid_formatted || formatCid(cardData.cid)}\n                    </div>\n                    <div className=\"text-xs text-slate-400 mt-1\">\n                      {cardData.gender_desc} | เกิด {cardData.dob}\n                    </div>\n                  </div>\n                </div>\n                {/* Address */}\n                {cardData.address && (\n                  <div className=\"mt-2 text-xs text-slate-500 dark:text-slate-400 line-clamp-2\">\n                    {cardData.address.replace(/#/g, ' ')}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Loading Progress */}\n            {isLoading && (\n              <div className=\"mt-3\">\n                <div className=\"h-1 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden\">\n                  <div className=\"h-full bg-primary-500 rounded-full animate-progress\" />\n                </div>\n              </div>\n            )}\n\n            {/* Action buttons */}\n            <div className=\"mt-3 flex gap-2\">\n              {error ? (\n                <button\n                  onClick={() => {\n                    clearCardData();\n                    handleClick();\n                  }}\n                  className=\"flex-1 px-3 py-2 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 transition-colors\"\n                >\n                  ลองใหม่\n                </button>\n              ) : isConnected ? (\n                <button\n                  onClick={handleDisconnect}\n                  className=\"flex-1 px-3 py-2 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 text-sm font-medium rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors\"\n                >\n                  ยกเลิกการเชื่อมต่อ\n                </button>\n              ) : null}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Backdrop for mobile */}\n      {showStatus && (\n        <div\n          className=\"fixed inset-0 z-40 lg:hidden\"\n          onClick={handleCloseStatus}\n        />\n      )}\n\n      <style jsx>{`\n        @keyframes progress {\n          0% {\n            width: 0%;\n          }\n          50% {\n            width: 70%;\n          }\n          100% {\n            width: 100%;\n          }\n        }\n        .animate-progress {\n          animation: progress 2s ease-in-out infinite;\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default SmartCardButton;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6037, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/client.ts"],"sourcesContent":["// src/lib/api/client.ts\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3333/api/v1';\n\ninterface RequestOptions {\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n  body?: unknown;\n  headers?: Record<string, string>;\n  token?: string;\n}\n\nexport interface ApiError {\n  message: string;\n  status: number;\n}\n\nclass ApiClient {\n  private baseUrl: string;\n  private authToken: string | null = null;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n  }\n\n  setToken(token: string | null) {\n    this.authToken = token;\n  }\n\n  private getToken(): string | null {\n    if (this.authToken) {\n      return this.authToken;\n    }\n    if (typeof window !== 'undefined') {\n      const storedToken = localStorage.getItem('token');\n      if (storedToken) {\n        this.authToken = storedToken;\n        return storedToken;\n      }\n    }\n    return null;\n  }\n\n  clearToken() {\n    this.authToken = null;\n  }\n\n  async request<T>(endpoint: string, options: RequestOptions = {}): Promise<T> {\n    const { method = 'GET', body, headers = {}, token } = options;\n\n    const authToken = token || this.getToken();\n\n    const config: RequestInit = {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n        ...(authToken && { Authorization: `Bearer ${authToken}` }),\n        ...headers,\n      },\n    };\n\n    if (body) {\n      config.body = JSON.stringify(body);\n    }\n\n    try {\n      const response = await fetch(`${this.baseUrl}${endpoint}`, config);\n      const data = await response.json();\n\n      if (!response.ok) {\n        const error: ApiError = {\n          message: data.message || 'An error occurred',\n          status: response.status,\n        };\n\n        if (response.status === 401) {\n          this.clearToken();\n          if (typeof window !== 'undefined') {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            if (!window.location.pathname.includes('/login')) {\n              window.location.href = '/login';\n            }\n          }\n        }\n\n        throw error;\n      }\n\n      return data as T;\n    } catch (error) {\n      if ((error as ApiError).status) {\n        throw error;\n      }\n      throw {\n        message: 'Network error. Please check your connection.',\n        status: 0,\n      } as ApiError;\n    }\n  }\n\n  get<T>(endpoint: string, options?: Omit<RequestOptions, 'method' | 'body'>) {\n    return this.request<T>(endpoint, { ...options, method: 'GET' });\n  }\n\n  post<T>(endpoint: string, body?: unknown, options?: Omit<RequestOptions, 'method' | 'body'>) {\n    return this.request<T>(endpoint, { ...options, method: 'POST', body });\n  }\n\n  put<T>(endpoint: string, body?: unknown, options?: Omit<RequestOptions, 'method' | 'body'>) {\n    return this.request<T>(endpoint, { ...options, method: 'PUT', body });\n  }\n\n  patch<T>(endpoint: string, body?: unknown, options?: Omit<RequestOptions, 'method' | 'body'>) {\n    return this.request<T>(endpoint, { ...options, method: 'PATCH', body });\n  }\n\n  delete<T>(endpoint: string, options?: Omit<RequestOptions, 'method' | 'body'>) {\n    return this.request<T>(endpoint, { ...options, method: 'DELETE' });\n  }\n}\n\n// Singleton instance\nexport const api = new ApiClient(API_BASE_URL);\n\nexport default api;"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;;AAEH;AAArB,MAAM,eAAe,oEAAmC;AAcxD,MAAM;IACI,QAAgB;IAChB,YAA2B,KAAK;IAExC,YAAY,OAAe,CAAE;QAC3B,IAAI,CAAC,OAAO,GAAG;IACjB;IAEA,SAAS,KAAoB,EAAE;QAC7B,IAAI,CAAC,SAAS,GAAG;IACnB;IAEQ,WAA0B;QAChC,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,OAAO,IAAI,CAAC,SAAS;QACvB;QACA,wCAAmC;YACjC,MAAM,cAAc,aAAa,OAAO,CAAC;YACzC,IAAI,aAAa;gBACf,IAAI,CAAC,SAAS,GAAG;gBACjB,OAAO;YACT;QACF;QACA,OAAO;IACT;IAEA,aAAa;QACX,IAAI,CAAC,SAAS,GAAG;IACnB;IAEA,MAAM,QAAW,QAAgB,EAAE,UAA0B,CAAC,CAAC,EAAc;QAC3E,MAAM,EAAE,SAAS,KAAK,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC,EAAE,KAAK,EAAE,GAAG;QAEtD,MAAM,YAAY,SAAS,IAAI,CAAC,QAAQ;QAExC,MAAM,SAAsB;YAC1B;YACA,SAAS;gBACP,gBAAgB;gBAChB,GAAI,aAAa;oBAAE,eAAe,CAAC,OAAO,EAAE,WAAW;gBAAC,CAAC;gBACzD,GAAG,OAAO;YACZ;QACF;QAEA,IAAI,MAAM;YACR,OAAO,IAAI,GAAG,KAAK,SAAS,CAAC;QAC/B;QAEA,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG,UAAU,EAAE;YAC3D,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,QAAkB;oBACtB,SAAS,KAAK,OAAO,IAAI;oBACzB,QAAQ,SAAS,MAAM;gBACzB;gBAEA,IAAI,SAAS,MAAM,KAAK,KAAK;oBAC3B,IAAI,CAAC,UAAU;oBACf,wCAAmC;wBACjC,aAAa,UAAU,CAAC;wBACxB,aAAa,UAAU,CAAC;wBACxB,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW;4BAChD,OAAO,QAAQ,CAAC,IAAI,GAAG;wBACzB;oBACF;gBACF;gBAEA,MAAM;YACR;YAEA,OAAO;QACT,EAAE,OAAO,OAAO;YACd,IAAI,AAAC,MAAmB,MAAM,EAAE;gBAC9B,MAAM;YACR;YACA,MAAM;gBACJ,SAAS;gBACT,QAAQ;YACV;QACF;IACF;IAEA,IAAO,QAAgB,EAAE,OAAiD,EAAE;QAC1E,OAAO,IAAI,CAAC,OAAO,CAAI,UAAU;YAAE,GAAG,OAAO;YAAE,QAAQ;QAAM;IAC/D;IAEA,KAAQ,QAAgB,EAAE,IAAc,EAAE,OAAiD,EAAE;QAC3F,OAAO,IAAI,CAAC,OAAO,CAAI,UAAU;YAAE,GAAG,OAAO;YAAE,QAAQ;YAAQ;QAAK;IACtE;IAEA,IAAO,QAAgB,EAAE,IAAc,EAAE,OAAiD,EAAE;QAC1F,OAAO,IAAI,CAAC,OAAO,CAAI,UAAU;YAAE,GAAG,OAAO;YAAE,QAAQ;YAAO;QAAK;IACrE;IAEA,MAAS,QAAgB,EAAE,IAAc,EAAE,OAAiD,EAAE;QAC5F,OAAO,IAAI,CAAC,OAAO,CAAI,UAAU;YAAE,GAAG,OAAO;YAAE,QAAQ;YAAS;QAAK;IACvE;IAEA,OAAU,QAAgB,EAAE,OAAiD,EAAE;QAC7E,OAAO,IAAI,CAAC,OAAO,CAAI,UAAU;YAAE,GAAG,OAAO;YAAE,QAAQ;QAAS;IAClE;AACF;AAGO,MAAM,MAAM,IAAI,UAAU;uCAElB"}},
    {"offset": {"line": 6161, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/lookups.ts"],"sourcesContent":["// src/lib/api/lookups.ts\n\nimport { api } from './client';\nimport type {\n  ApiResponse,\n  LookupItem,\n  PnameLookup,\n  PttypeLookup,\n  SubdistrictLookup,\n  OvstistLookup,\n  DepartmentLookup,\n  DoctorLookup,\n  SpcltyLookup,\n  AddressSearchResult,\n  OpdVisitLookups,\n  PatientRegistrationLookups,\n} from './types';\n\n// ============================================\n// Lookup API\n// ============================================\n\nexport const lookupApi = {\n  // =========================================\n  // Personal Info Lookups\n  // =========================================\n\n  // คำนำหน้าชื่อ\n  getPnames: (sex?: 'M' | 'F') =>\n    api.get<ApiResponse<PnameLookup[]>>(\n      `/lookups/pnames${sex ? `?sex=${sex}` : ''}`\n    ),\n\n  // อาชีพ\n  getOccupations: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/occupations'),\n\n  // เชื้อชาติ/สัญชาติ\n  getNationalities: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/nationalities'),\n\n  // ศาสนา\n  getReligions: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/religions'),\n\n  // สถานะสมรส\n  getMarryStatuses: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/marry-statuses'),\n\n  // การศึกษา\n  getEducations: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/educations'),\n\n  // สิทธิการรักษา\n  getPttypes: (activeOnly = true) =>\n    api.get<ApiResponse<PttypeLookup[]>>(\n      `/lookups/pttypes?active=${activeOnly}`\n    ),\n\n  // ความสัมพันธ์\n  getRelationTypes: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/relation-types'),\n\n  // =========================================\n  // Thai Address Lookups\n  // =========================================\n\n  // จังหวัด\n  getProvinces: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/provinces'),\n\n  // อำเภอ\n  getDistricts: (chwpart: string) =>\n    api.get<ApiResponse<LookupItem[]>>(\n      `/lookups/districts?chwpart=${chwpart}`\n    ),\n\n  // ตำบล\n  getSubdistricts: (chwpart: string, amppart: string) =>\n    api.get<ApiResponse<SubdistrictLookup[]>>(\n      `/lookups/subdistricts?chwpart=${chwpart}&amppart=${amppart}`\n    ),\n\n  // ค้นหาที่อยู่\n  searchAddress: (q: string, limit = 20) =>\n    api.get<ApiResponse<AddressSearchResult[]>>(\n      `/lookups/address/search?q=${encodeURIComponent(q)}&limit=${limit}`\n    ),\n\n  // =========================================\n  // Static Lookups\n  // =========================================\n\n  // หมู่เลือด\n  getBloodGroups: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/blood-groups'),\n\n  // Rh\n  getBloodGroupRhs: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/blood-group-rhs'),\n\n  // เพศ\n  getSexes: () =>\n    api.get<ApiResponse<LookupItem[]>>('/lookups/sexes'),\n\n  // =========================================\n  // OPD Visit Lookups\n  // =========================================\n\n  // ประเภทการมา\n  getOvstists: () =>\n    api.get<ApiResponse<OvstistLookup[]>>('/lookups/ovstists'),\n\n  // แผนก/ห้องตรวจ\n  getDepartments: (activeOnly = true) =>\n    api.get<ApiResponse<DepartmentLookup[]>>(\n      `/lookups/departments?active=${activeOnly}`\n    ),\n\n  // แพทย์\n  getDoctors: (depcode?: string, activeOnly = true) => {\n    const params = new URLSearchParams();\n    if (depcode) params.append('depcode', depcode);\n    params.append('active', String(activeOnly));\n    return api.get<ApiResponse<DoctorLookup[]>>(\n      `/lookups/doctors?${params.toString()}`\n    );\n  },\n\n  // ความเชี่ยวชาญ\n  getSpclties: () =>\n    api.get<ApiResponse<SpcltyLookup[]>>('/lookups/spclties'),\n\n  // ห้องตรวจ (clinic rooms)\n  getClinics: (depcode?: string) =>\n    api.get<ApiResponse<LookupItem[]>>(\n      `/lookups/clinics${depcode ? `?depcode=${depcode}` : ''}`\n    ),\n\n  // =========================================\n  // Combined Lookups (for specific pages)\n  // =========================================\n\n  // OPD ส่งตรวจ - ดึงทั้งหมดในครั้งเดียว\n  getOpdVisitLookups: () =>\n    api.get<ApiResponse<OpdVisitLookups>>('/lookups/opd-visit'),\n\n  // ลงทะเบียนผู้ป่วย - ดึงทั้งหมดในครั้งเดียว\n  getPatientRegistrationLookups: () =>\n    api.get<ApiResponse<PatientRegistrationLookups>>('/lookups/patient-registration'),\n};\n\nexport default lookupApi;"],"names":[],"mappings":"AAAA,yBAAyB;;;;;;;AAEzB;;AAoBO,MAAM,YAAY;IACvB,4CAA4C;IAC5C,wBAAwB;IACxB,4CAA4C;IAE5C,eAAe;IACf,WAAW,CAAC,MACV,mJAAG,CAAC,GAAG,CACL,CAAC,eAAe,EAAE,MAAM,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;IAGhD,QAAQ;IACR,gBAAgB,IACd,mJAAG,CAAC,GAAG,CAA4B;IAErC,oBAAoB;IACpB,kBAAkB,IAChB,mJAAG,CAAC,GAAG,CAA4B;IAErC,QAAQ;IACR,cAAc,IACZ,mJAAG,CAAC,GAAG,CAA4B;IAErC,YAAY;IACZ,kBAAkB,IAChB,mJAAG,CAAC,GAAG,CAA4B;IAErC,WAAW;IACX,eAAe,IACb,mJAAG,CAAC,GAAG,CAA4B;IAErC,gBAAgB;IAChB,YAAY,CAAC,aAAa,IAAI,GAC5B,mJAAG,CAAC,GAAG,CACL,CAAC,wBAAwB,EAAE,YAAY;IAG3C,eAAe;IACf,kBAAkB,IAChB,mJAAG,CAAC,GAAG,CAA4B;IAErC,4CAA4C;IAC5C,uBAAuB;IACvB,4CAA4C;IAE5C,UAAU;IACV,cAAc,IACZ,mJAAG,CAAC,GAAG,CAA4B;IAErC,QAAQ;IACR,cAAc,CAAC,UACb,mJAAG,CAAC,GAAG,CACL,CAAC,2BAA2B,EAAE,SAAS;IAG3C,OAAO;IACP,iBAAiB,CAAC,SAAiB,UACjC,mJAAG,CAAC,GAAG,CACL,CAAC,8BAA8B,EAAE,QAAQ,SAAS,EAAE,SAAS;IAGjE,eAAe;IACf,eAAe,CAAC,GAAW,QAAQ,EAAE,GACnC,mJAAG,CAAC,GAAG,CACL,CAAC,0BAA0B,EAAE,mBAAmB,GAAG,OAAO,EAAE,OAAO;IAGvE,4CAA4C;IAC5C,iBAAiB;IACjB,4CAA4C;IAE5C,YAAY;IACZ,gBAAgB,IACd,mJAAG,CAAC,GAAG,CAA4B;IAErC,KAAK;IACL,kBAAkB,IAChB,mJAAG,CAAC,GAAG,CAA4B;IAErC,MAAM;IACN,UAAU,IACR,mJAAG,CAAC,GAAG,CAA4B;IAErC,4CAA4C;IAC5C,oBAAoB;IACpB,4CAA4C;IAE5C,cAAc;IACd,aAAa,IACX,mJAAG,CAAC,GAAG,CAA+B;IAExC,gBAAgB;IAChB,gBAAgB,CAAC,aAAa,IAAI,GAChC,mJAAG,CAAC,GAAG,CACL,CAAC,4BAA4B,EAAE,YAAY;IAG/C,QAAQ;IACR,YAAY,CAAC,SAAkB,aAAa,IAAI;QAC9C,MAAM,SAAS,IAAI;QACnB,IAAI,SAAS,OAAO,MAAM,CAAC,WAAW;QACtC,OAAO,MAAM,CAAC,UAAU,OAAO;QAC/B,OAAO,mJAAG,CAAC,GAAG,CACZ,CAAC,iBAAiB,EAAE,OAAO,QAAQ,IAAI;IAE3C;IAEA,gBAAgB;IAChB,aAAa,IACX,mJAAG,CAAC,GAAG,CAA8B;IAEvC,0BAA0B;IAC1B,YAAY,CAAC,UACX,mJAAG,CAAC,GAAG,CACL,CAAC,gBAAgB,EAAE,UAAU,CAAC,SAAS,EAAE,SAAS,GAAG,IAAI;IAG7D,4CAA4C;IAC5C,wCAAwC;IACxC,4CAA4C;IAE5C,uCAAuC;IACvC,oBAAoB,IAClB,mJAAG,CAAC,GAAG,CAA+B;IAExC,4CAA4C;IAC5C,+BAA+B,IAC7B,mJAAG,CAAC,GAAG,CAA0C;AACrD;uCAEe"}},
    {"offset": {"line": 6244, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/hooks/useOpdVisitLookups.ts"],"sourcesContent":["// src/hooks/useOpdVisitLookups.ts\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { lookupApi } from '@/lib/api/lookups';\nimport type { \n  OvstistLookup, \n  PttypeLookup, \n  DepartmentLookup, \n  DoctorLookup,\n  SpcltyLookup,\n} from '@/lib/api/types';\n\ninterface UseOpdVisitLookupsResult {\n  // Data\n  ovstists: OvstistLookup[];\n  pttypes: PttypeLookup[];\n  departments: DepartmentLookup[];\n  doctors: DoctorLookup[];\n  spclties: SpcltyLookup[];\n  \n  // Options formatted for select components\n  visitTypeOptions: { value: string; label: string }[];\n  pttypeOptions: { value: string; label: string }[];\n  departmentOptions: { value: string; label: string }[];\n  doctorOptions: { value: string; label: string }[];\n  spcltyOptions: { value: string; label: string }[];\n  \n  // State\n  isLoading: boolean;\n  error: string | null;\n  \n  // Actions\n  refetch: () => Promise<void>;\n  getDoctorsByDepartment: (depcode: string) => DoctorLookup[];\n  getDoctorsBySpclty: (spclty: string) => DoctorLookup[];\n  getSpcltyByDepartment: (depcode: string) => string | undefined;\n}\n\nexport function useOpdVisitLookups(): UseOpdVisitLookupsResult {\n  const [ovstists, setOvstists] = useState<OvstistLookup[]>([]);\n  const [pttypes, setPttypes] = useState<PttypeLookup[]>([]);\n  const [departments, setDepartments] = useState<DepartmentLookup[]>([]);\n  const [doctors, setDoctors] = useState<DoctorLookup[]>([]);\n  const [spclties, setSpclties] = useState<SpcltyLookup[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchLookups = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const response = await lookupApi.getOpdVisitLookups();\n      \n      if (response.success && response.data) {\n        setOvstists(response.data.ovstists);\n        setPttypes(response.data.pttypes);\n        setDepartments(response.data.departments);\n        setDoctors(response.data.doctors);\n        setSpclties(response.data.spclties || []);\n      }\n    } catch (err) {\n      console.error('Failed to fetch OPD visit lookups:', err);\n      setError('ไม่สามารถโหลดข้อมูลได้');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchLookups();\n  }, [fetchLookups]);\n\n  // Format for select components\n  const visitTypeOptions = ovstists.map((item) => ({\n    value: item.code,\n    label: item.label || `${item.code} - ${item.name}`,\n  }));\n\n  const pttypeOptions = pttypes.map((item) => ({\n    value: item.code,\n    label: item.label || `${item.code} - ${item.name}`,\n  }));\n\n  const departmentOptions = [\n    { value: '', label: 'เลือกห้องตรวจ...' },\n    ...departments.map((item) => ({\n      value: item.code,\n      label: item.label || `${item.code} - ${item.name}`,\n    })),\n  ];\n\n  const doctorOptions = [\n    { value: '', label: 'เลือกแพทย์...' },\n    ...doctors.map((item) => ({\n      value: item.code,\n      label: item.label || item.name,\n    })),\n  ];\n\n  const spcltyOptions = [\n    //{ value: '', label: 'เลือกแผนก/ความเชี่ยวชาญ...' },\n    ...spclties.map((item) => ({\n      value: item.code,\n      label: item.label || `${item.code} - ${item.name}`,\n    })),\n  ];\n\n  // Filter doctors by department\n  const getDoctorsByDepartment = useCallback(\n    (depcode: string): DoctorLookup[] => {\n      if (!depcode) return doctors;\n      return doctors.filter((doc) => doc.depcode === depcode);\n    },\n    [doctors]\n  );\n\n  // Filter doctors by specialty\n  const getDoctorsBySpclty = useCallback(\n    (spclty: string): DoctorLookup[] => {\n      if (!spclty) return doctors;\n      return doctors.filter((doc) => doc.specialty === spclty);\n    },\n    [doctors]\n  );\n\n  // Get spclty by department code\n  const getSpcltyByDepartment = useCallback(\n    (depcode: string): string | undefined => {\n      if (!depcode) return undefined;\n      const dept = departments.find((d) => d.code === depcode);\n      return dept?.spclty;\n    },\n    [departments]\n  );\n\n  return {\n    // Data\n    ovstists,\n    pttypes,\n    departments,\n    doctors,\n    spclties,\n    \n    // Options\n    visitTypeOptions,\n    pttypeOptions,\n    departmentOptions,\n    doctorOptions,\n    spcltyOptions,\n    \n    // State\n    isLoading,\n    error,\n    \n    // Actions\n    refetch: fetchLookups,\n    getDoctorsByDepartment,\n    getDoctorsBySpclty,\n    getSpcltyByDepartment,\n  };\n}"],"names":[],"mappings":"AAAA,kCAAkC;;;;;AAElC;AACA;;;;AAmCO,SAAS;;IACd,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,uLAAQ,EAAkB,EAAE;IAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uLAAQ,EAAiB,EAAE;IACzD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,uLAAQ,EAAqB,EAAE;IACrE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uLAAQ,EAAiB,EAAE;IACzD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,uLAAQ,EAAiB,EAAE;IAC3D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,uLAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,uLAAQ,EAAgB;IAElD,MAAM,eAAe,IAAA,0LAAW;wDAAC;YAC/B,aAAa;YACb,SAAS;YAET,IAAI;gBACF,MAAM,WAAW,MAAM,0JAAS,CAAC,kBAAkB;gBAEnD,IAAI,SAAS,OAAO,IAAI,SAAS,IAAI,EAAE;oBACrC,YAAY,SAAS,IAAI,CAAC,QAAQ;oBAClC,WAAW,SAAS,IAAI,CAAC,OAAO;oBAChC,eAAe,SAAS,IAAI,CAAC,WAAW;oBACxC,WAAW,SAAS,IAAI,CAAC,OAAO;oBAChC,YAAY,SAAS,IAAI,CAAC,QAAQ,IAAI,EAAE;gBAC1C;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,sCAAsC;gBACpD,SAAS;YACX,SAAU;gBACR,aAAa;YACf;QACF;uDAAG,EAAE;IAEL,IAAA,wLAAS;wCAAC;YACR;QACF;uCAAG;QAAC;KAAa;IAEjB,+BAA+B;IAC/B,MAAM,mBAAmB,SAAS,GAAG,CAAC,CAAC,OAAS,CAAC;YAC/C,OAAO,KAAK,IAAI;YAChB,OAAO,KAAK,KAAK,IAAI,GAAG,KAAK,IAAI,CAAC,GAAG,EAAE,KAAK,IAAI,EAAE;QACpD,CAAC;IAED,MAAM,gBAAgB,QAAQ,GAAG,CAAC,CAAC,OAAS,CAAC;YAC3C,OAAO,KAAK,IAAI;YAChB,OAAO,KAAK,KAAK,IAAI,GAAG,KAAK,IAAI,CAAC,GAAG,EAAE,KAAK,IAAI,EAAE;QACpD,CAAC;IAED,MAAM,oBAAoB;QACxB;YAAE,OAAO;YAAI,OAAO;QAAmB;WACpC,YAAY,GAAG,CAAC,CAAC,OAAS,CAAC;gBAC5B,OAAO,KAAK,IAAI;gBAChB,OAAO,KAAK,KAAK,IAAI,GAAG,KAAK,IAAI,CAAC,GAAG,EAAE,KAAK,IAAI,EAAE;YACpD,CAAC;KACF;IAED,MAAM,gBAAgB;QACpB;YAAE,OAAO;YAAI,OAAO;QAAgB;WACjC,QAAQ,GAAG,CAAC,CAAC,OAAS,CAAC;gBACxB,OAAO,KAAK,IAAI;gBAChB,OAAO,KAAK,KAAK,IAAI,KAAK,IAAI;YAChC,CAAC;KACF;IAED,MAAM,gBAAgB;QACpB,qDAAqD;WAClD,SAAS,GAAG,CAAC,CAAC,OAAS,CAAC;gBACzB,OAAO,KAAK,IAAI;gBAChB,OAAO,KAAK,KAAK,IAAI,GAAG,KAAK,IAAI,CAAC,GAAG,EAAE,KAAK,IAAI,EAAE;YACpD,CAAC;KACF;IAED,+BAA+B;IAC/B,MAAM,yBAAyB,IAAA,0LAAW;kEACxC,CAAC;YACC,IAAI,CAAC,SAAS,OAAO;YACrB,OAAO,QAAQ,MAAM;0EAAC,CAAC,MAAQ,IAAI,OAAO,KAAK;;QACjD;iEACA;QAAC;KAAQ;IAGX,8BAA8B;IAC9B,MAAM,qBAAqB,IAAA,0LAAW;8DACpC,CAAC;YACC,IAAI,CAAC,QAAQ,OAAO;YACpB,OAAO,QAAQ,MAAM;sEAAC,CAAC,MAAQ,IAAI,SAAS,KAAK;;QACnD;6DACA;QAAC;KAAQ;IAGX,gCAAgC;IAChC,MAAM,wBAAwB,IAAA,0LAAW;iEACvC,CAAC;YACC,IAAI,CAAC,SAAS,OAAO;YACrB,MAAM,OAAO,YAAY,IAAI;8EAAC,CAAC,IAAM,EAAE,IAAI,KAAK;;YAChD,OAAO,MAAM;QACf;gEACA;QAAC;KAAY;IAGf,OAAO;QACL,OAAO;QACP;QACA;QACA;QACA;QACA;QAEA,UAAU;QACV;QACA;QACA;QACA;QACA;QAEA,QAAQ;QACR;QACA;QAEA,UAAU;QACV,SAAS;QACT;QACA;QACA;IACF;AACF;GA3HgB"}},
    {"offset": {"line": 6392, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/nhso.ts"],"sourcesContent":["// src/lib/api/nhso.ts\n\n// src/lib/api/nhso.ts\n//\n// NHSO API - ตรวจสอบสิทธิการรักษา สปสช.\n//\n// Usage:\n//   import { nhsoApi } from '@/lib/api/nhso';\n//   \n//   // Login\n//   const loginResult = await nhsoApi.login('username', 'password');\n//   \n//   // Check token status\n//   const status = await nhsoApi.getTokenStatus();\n//   \n//   // Search by PID (auto-refresh token)\n//   const rights = await nhsoApi.searchByPid('3301700333333');\n//   \n//   // Or use checkRights (login + search in one call)\n//   const result = await nhsoApi.checkRights('username', 'password', '3301700333333');\n//\n\nimport { api } from './client';\nimport type {\n  NhsoLoginRequest,\n  NhsoLoginResponse,\n  NhsoTokenStatusResponse,\n  NhsoRefreshTokenResponse,\n  NhsoSearchByPidResponse,\n  NhsoCheckRightsRequest,\n  NhsoCheckRightsResponse,\n  NhsoLogoutResponse,\n  NhsoCleanupResponse,\n  NhsoPersonalFund,\n  NhsoTokenStatus,\n} from './types/nhso';\n\n// ============================================\n// Local Storage Keys\n// ============================================\nconst NHSO_USERNAME_KEY = 'nhso_username';\nconst NHSO_CREDENTIALS_KEY = 'nhso_credentials'; // Encrypted or session-only\n\n// ============================================\n// NHSO API Class\n// ============================================\nclass NhsoApi {\n  private username: string | null = null;\n\n  constructor() {\n    // Load username from localStorage on init\n    if (typeof window !== 'undefined') {\n      this.username = localStorage.getItem(NHSO_USERNAME_KEY);\n    }\n  }\n\n  // ============================================\n  // Authentication\n  // ============================================\n\n  /**\n   * Login to NHSO\n   * @param username - NHSO username\n   * @param password - NHSO password\n   * @param remember - Save username for future use\n   */\n  async login(\n    username: string,\n    password: string,\n    remember: boolean = true\n  ): Promise<NhsoLoginResponse> {\n    const response = await api.post<NhsoLoginResponse>('/nhso/login', {\n      username,\n      password,\n    } as NhsoLoginRequest);\n\n    if (response.success && remember) {\n      this.username = username;\n      if (typeof window !== 'undefined') {\n        localStorage.setItem(NHSO_USERNAME_KEY, username);\n      }\n    }\n\n    return response;\n  }\n\n  /**\n   * Logout from NHSO\n   */\n  async logout(): Promise<NhsoLogoutResponse> {\n    const username = this.getUsername();\n    if (!username) {\n      return { success: false, message: 'No active session' };\n    }\n\n    const response = await api.post<NhsoLogoutResponse>(\n      '/nhso/logout',\n      { username },\n      { headers: { 'X-NHSO-Username': username } }\n    );\n\n    if (response.success) {\n      this.clearSession();\n    }\n\n    return response;\n  }\n\n  /**\n   * Clear local session data\n   */\n  clearSession(): void {\n    this.username = null;\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem(NHSO_USERNAME_KEY);\n      localStorage.removeItem(NHSO_CREDENTIALS_KEY);\n    }\n  }\n\n  // ============================================\n  // Token Management\n  // ============================================\n\n  /**\n   * Get current token status\n   */\n  async getTokenStatus(): Promise<NhsoTokenStatusResponse> {\n    const username = this.getUsername();\n    if (!username) {\n      return {\n        success: false,\n        message: 'No active session. Please login first.',\n      };\n    }\n\n    return api.get<NhsoTokenStatusResponse>('/nhso/token-status', {\n      headers: { 'X-NHSO-Username': username },\n    });\n  }\n\n  /**\n   * Manually refresh access token\n   */\n  async refreshToken(): Promise<NhsoRefreshTokenResponse> {\n    const username = this.getUsername();\n    if (!username) {\n      return {\n        success: false,\n        message: 'No active session. Please login first.',\n        needsRelogin: true,\n      };\n    }\n\n    return api.post<NhsoRefreshTokenResponse>(\n      '/nhso/refresh-token',\n      { username },\n      { headers: { 'X-NHSO-Username': username } }\n    );\n  }\n\n  /**\n   * Check if token is valid and not expired\n   */\n  async isTokenValid(): Promise<boolean> {\n    const status = await this.getTokenStatus();\n    return status.success && status.data?.isValid === true;\n  }\n\n  /**\n   * Check if needs to re-login\n   */\n  async needsRelogin(): Promise<boolean> {\n    const status = await this.getTokenStatus();\n    return !status.success || status.data?.needsRelogin === true;\n  }\n\n  // ============================================\n  // Rights Verification (ตรวจสอบสิทธิ)\n  // ============================================\n\n  /**\n   * Search patient rights by PID (เลขบัตรประชาชน)\n   * Auto-refreshes token if needed\n   * \n   * @param pid - เลขบัตรประชาชน 13 หลัก\n   */\n  async searchByPid(pid: string): Promise<NhsoSearchByPidResponse> {\n    const username = this.getUsername();\n    if (!username) {\n      return {\n        success: false,\n        message: 'No active session. Please login first.',\n      };\n    }\n\n    // Validate PID\n    if (!this.isValidPid(pid)) {\n      return {\n        success: false,\n        message: 'Invalid PID format. Must be 13 digits.',\n      };\n    }\n\n    return api.get<NhsoSearchByPidResponse>(`/nhso/search-by-pid/${pid}`, {\n      headers: { 'X-NHSO-Username': username },\n    });\n  }\n\n  /**\n   * Check rights with auto-login\n   * Combines login and search in one call\n   * \n   * @param username - NHSO username\n   * @param password - NHSO password\n   * @param pid - เลขบัตรประชาชน 13 หลัก\n   */\n  async checkRights(\n    username: string,\n    password: string,\n    pid: string\n  ): Promise<NhsoCheckRightsResponse> {\n    // Validate PID\n    if (!this.isValidPid(pid)) {\n      return {\n        success: false,\n        message: 'Invalid PID format. Must be 13 digits.',\n      };\n    }\n\n    const response = await api.post<NhsoCheckRightsResponse>('/nhso/check-rights', {\n      username,\n      password,\n      pid,\n    } as NhsoCheckRightsRequest);\n\n    // Save username if successful\n    if (response.success) {\n      this.username = username;\n      if (typeof window !== 'undefined') {\n        localStorage.setItem(NHSO_USERNAME_KEY, username);\n      }\n    }\n\n    return response;\n  }\n\n  /**\n   * Quick check rights using stored credentials\n   * Falls back to checkRights if no session\n   * \n   * @param pid - เลขบัตรประชาชน 13 หลัก\n   * @param credentials - Optional credentials for auto-login\n   */\n  async quickCheckRights(\n    pid: string,\n    credentials?: { username: string; password: string }\n  ): Promise<NhsoSearchByPidResponse | NhsoCheckRightsResponse> {\n    // Try with existing session first\n    const searchResult = await this.searchByPid(pid);\n\n    // If successful or no credentials provided, return result\n    if (searchResult.success || !credentials) {\n      return searchResult;\n    }\n\n    // If failed and credentials provided, try login + search\n    return this.checkRights(credentials.username, credentials.password, pid);\n  }\n\n  // ============================================\n  // Admin Functions\n  // ============================================\n\n  /**\n   * Cleanup expired tokens (admin only)\n   */\n  async cleanup(): Promise<NhsoCleanupResponse> {\n    return api.post<NhsoCleanupResponse>('/nhso/cleanup');\n  }\n\n  // ============================================\n  // Helper Methods\n  // ============================================\n\n  /**\n   * Get stored username\n   */\n  getUsername(): string | null {\n    return this.username;\n  }\n\n  /**\n   * Set username (for external login flows)\n   */\n  setUsername(username: string): void {\n    this.username = username;\n    if (typeof window !== 'undefined') {\n      localStorage.setItem(NHSO_USERNAME_KEY, username);\n    }\n  }\n\n  /**\n   * Check if logged in (has username)\n   */\n  isLoggedIn(): boolean {\n    return !!this.username;\n  }\n\n  /**\n   * Validate PID format (13 digits)\n   */\n  isValidPid(pid: string): boolean {\n    return /^\\d{13}$/.test(pid);\n  }\n\n  /**\n   * Format PID for display (x-xxxx-xxxxx-xx-x)\n   */\n  formatPid(pid: string): string {\n    if (!pid || pid.length !== 13) return pid;\n    return `${pid[0]}-${pid.slice(1, 5)}-${pid.slice(5, 10)}-${pid.slice(10, 12)}-${pid[12]}`;\n  }\n\n  /**\n   * Parse rights data to Thai display format\n   */\n  formatRights(rights: NhsoPersonalFund): {\n    mainRight: string;\n    subRight: string;\n    mainHospital: string;\n    subHospital: string;\n    status: string;\n    expireDate: string;\n  } {\n    return {\n      mainRight: rights.mainInsclName || rights.mainInscl || '-',\n      subRight: rights.subInsclName || rights.subInscl || '-',\n      mainHospital: rights.hospMainName || rights.hospMain || '-',\n      subHospital: rights.hospSubName || rights.hospSub || '-',\n      status: rights.statusName || rights.status || '-',\n      expireDate: rights.expireDate || '-',\n    };\n  }\n}\n\n// ============================================\n// Singleton Instance\n// ============================================\nexport const nhsoApi = new NhsoApi();\n\n// ============================================\n// Re-export types\n// ============================================\nexport type {\n  NhsoLoginRequest,\n  NhsoLoginResponse,\n  NhsoTokenStatus,\n  NhsoTokenStatusResponse,\n  NhsoRefreshTokenResponse,\n  NhsoPersonalFund,\n  NhsoSearchByPidResponse,\n  NhsoCheckRightsRequest,\n  NhsoCheckRightsResponse,\n  NhsoLogoutResponse,\n  NhsoCleanupResponse,\n} from './types/nhso';"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6671, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/nhso/NhsoLoginModal.tsx"],"sourcesContent":["// src/components/nhso/NhsoLoginModal.tsx\n'use client';\n\nimport { useState } from 'react';\nimport { X, Shield, Loader2, Eye, EyeOff, AlertCircle } from 'lucide-react';\nimport { nhsoApi } from '@/lib/api/nhso';\n\ninterface NhsoLoginModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: (username: string) => void;\n}\n\nexport function NhsoLoginModal({ isOpen, onClose, onSuccess }: NhsoLoginModalProps) {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [rememberUsername, setRememberUsername] = useState(true);\n\n  // Load saved username on mount\n  useState(() => {\n    const savedUsername = nhsoApi.getUsername();\n    if (savedUsername) {\n      setUsername(savedUsername);\n    }\n  });\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!username.trim() || !password.trim()) {\n      setError('กรุณากรอก Username และ Password');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const result = await nhsoApi.login(username, password, rememberUsername);\n      \n      if (result.success) {\n        onSuccess(username);\n        onClose();\n        // Clear password after successful login\n        setPassword('');\n      } else {\n        setError(result.message || 'เข้าสู่ระบบไม่สำเร็จ');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'เกิดข้อผิดพลาด');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n      {/* Backdrop */}\n      <div \n        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n        onClick={onClose}\n      />\n\n      {/* Modal */}\n      <div className=\"relative w-full max-w-md bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200\">\n        {/* Header */}\n        <div className=\"relative bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 text-white\">\n          {/* Close button */}\n          <button\n            onClick={onClose}\n            className=\"absolute top-4 right-4 p-1 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors\"\n          >\n            <X size={20} />\n          </button>\n\n          {/* Icon & Title */}\n          <div className=\"flex items-center gap-4\">\n            <div className=\"size-14 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center\">\n              <Shield size={28} className=\"text-white\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-bold\">เข้าสู่ระบบ NHSO</h2>\n              <p className=\"text-blue-100 text-sm mt-0.5\">สำนักงานหลักประกันสุขภาพแห่งชาติ</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Form */}\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-5\">\n          {/* Error Message */}\n          {error && (\n            <div className=\"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/30 rounded-xl text-red-600 dark:text-red-400\">\n              <AlertCircle size={20} className=\"shrink-0\" />\n              <p className=\"text-sm\">{error}</p>\n            </div>\n          )}\n\n          {/* Username */}\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300\">\n              Username <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              placeholder=\"กรอก Username\"\n              disabled={isLoading}\n              className=\"\n                w-full px-4 py-3 \n                bg-slate-50 dark:bg-slate-800 \n                border border-slate-200 dark:border-slate-700 \n                rounded-xl text-sm\n                focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500\n                disabled:opacity-50 disabled:cursor-not-allowed\n                transition-colors\n              \"\n              autoFocus\n            />\n          </div>\n\n          {/* Password */}\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300\">\n              Password <span className=\"text-red-500\">*</span>\n            </label>\n            <div className=\"relative\">\n              <input\n                type={showPassword ? 'text' : 'password'}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"กรอก Password\"\n                disabled={isLoading}\n                className=\"\n                  w-full px-4 py-3 pr-12\n                  bg-slate-50 dark:bg-slate-800 \n                  border border-slate-200 dark:border-slate-700 \n                  rounded-xl text-sm\n                  focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500\n                  disabled:opacity-50 disabled:cursor-not-allowed\n                  transition-colors\n                \"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300\"\n              >\n                {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}\n              </button>\n            </div>\n          </div>\n\n          {/* Remember Username */}\n          <label className=\"flex items-center gap-3 cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={rememberUsername}\n              onChange={(e) => setRememberUsername(e.target.checked)}\n              className=\"size-4 rounded border-slate-300 text-blue-500 focus:ring-blue-500/20\"\n            />\n            <span className=\"text-sm text-slate-600 dark:text-slate-400\">\n              จดจำ Username\n            </span>\n          </label>\n\n          {/* Actions */}\n          <div className=\"flex gap-3 pt-2\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              disabled={isLoading}\n              className=\"\n                flex-1 px-4 py-3 \n                bg-slate-100 dark:bg-slate-800 \n                text-slate-600 dark:text-slate-400 \n                rounded-xl font-medium\n                hover:bg-slate-200 dark:hover:bg-slate-700\n                disabled:opacity-50\n                transition-colors\n              \"\n            >\n              ยกเลิก\n            </button>\n            <button\n              type=\"submit\"\n              disabled={isLoading || !username.trim() || !password.trim()}\n              className=\"\n                flex-1 px-4 py-3 \n                bg-blue-500 text-white \n                rounded-xl font-medium\n                hover:bg-blue-600\n                disabled:opacity-50 disabled:cursor-not-allowed\n                transition-colors\n                flex items-center justify-center gap-2\n              \"\n            >\n              {isLoading ? (\n                <>\n                  <Loader2 size={18} className=\"animate-spin\" />\n                  กำลังเข้าสู่ระบบ...\n                </>\n              ) : (\n                'เข้าสู่ระบบ'\n              )}\n            </button>\n          </div>\n\n          {/* Footer Note */}\n          <p className=\"text-xs text-slate-400 dark:text-slate-500 text-center pt-2\">\n            Token จะหมดอายุใน 24 ชั่วโมง หลังจากนั้นต้องเข้าสู่ระบบใหม่\n          </p>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default NhsoLoginModal;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7068, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/nhso/NhsoRightsModal.tsx"],"sourcesContent":["// src/components/nhso/NhsoRightsModal.tsx\n'use client';\n\nimport { useState } from 'react';\nimport { \n  X, \n  Shield, \n  Loader2, \n  AlertCircle, \n  CheckCircle2, \n  Building2, \n  Calendar,\n  User,\n  RefreshCw,\n  Copy,\n  Check,\n  Clock,\n  XCircle,\n} from 'lucide-react';\nimport type { NhsoPersonalFund } from '@/lib/api/types/nhso';\n\ninterface NhsoRightsModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  isLoading: boolean;\n  error: string | null;\n  rights: NhsoPersonalFund | null;\n  patientName?: string;\n  patientCid?: string;\n  onRetry?: () => void;\n  onApplyRights?: (rights: NhsoPersonalFund) => void;\n}\n\n// Helper functions\nconst safeString = (value: unknown): string => {\n  if (value === null || value === undefined) return '';\n  if (typeof value === 'string') return value;\n  if (typeof value === 'number') return String(value);\n  if (typeof value === 'object') {\n    const obj = value as Record<string, unknown>;\n    if (obj.rightName) return String(obj.rightName);\n    if (obj.insclName) return String(obj.insclName);\n    if (obj.hname) return String(obj.hname);\n    if (obj.name) return String(obj.name);\n    if (obj.codeWithName) return String(obj.codeWithName);\n    if (obj.statusDesc) return String(obj.statusDesc);\n    return '';\n  }\n  return String(value);\n};\n\nconst safeCode = (value: unknown): string => {\n  if (value === null || value === undefined) return '';\n  if (typeof value === 'string') return value;\n  if (typeof value === 'number') return String(value);\n  if (typeof value === 'object') {\n    const obj = value as Record<string, unknown>;\n    if (obj.rightId) return String(obj.rightId);\n    if (obj.inscl) return String(obj.inscl);\n    if (obj.hcode) return String(obj.hcode);\n    if (obj.code) return String(obj.code);\n    return '';\n  }\n  return String(value);\n};\n\ntype RightType = 'UCS' | 'SSS' | 'OFC' | 'OTHER';\n\nconst getRightType = (rights: NhsoPersonalFund | null): RightType => {\n  if (!rights) return 'OTHER';\n  const r = rights as Record<string, unknown>;\n  const mainInscl = r.mainInscl as Record<string, unknown> | undefined;\n  const rightId = mainInscl?.rightId as string | undefined;\n  \n  if (rightId === 'UCS') return 'UCS';\n  if (rightId?.startsWith('S') || rightId === 'SSS') return 'SSS';\n  if (rightId === 'OFC') return 'OFC';\n  return 'OTHER';\n};\n\nconst getRightTypeInfo = (rightType: RightType) => {\n  switch (rightType) {\n    case 'UCS':\n      return { \n        label: 'บัตรทอง', \n        bgColor: 'bg-emerald-50 dark:bg-emerald-500/10',\n        borderColor: 'border-emerald-200 dark:border-emerald-500/30',\n        textColor: 'text-emerald-700 dark:text-emerald-400',\n        badgeColor: 'bg-emerald-500',\n        buttonColor: 'bg-emerald-500 hover:bg-emerald-600',\n      };\n    case 'SSS':\n      return { \n        label: 'ประกันสังคม', \n        bgColor: 'bg-blue-50 dark:bg-blue-500/10',\n        borderColor: 'border-blue-200 dark:border-blue-500/30',\n        textColor: 'text-blue-700 dark:text-blue-400',\n        badgeColor: 'bg-blue-500',\n        buttonColor: 'bg-blue-500 hover:bg-blue-600',\n      };\n    case 'OFC':\n      return { \n        label: 'ข้าราชการ', \n        bgColor: 'bg-amber-50 dark:bg-amber-500/10',\n        borderColor: 'border-amber-200 dark:border-amber-500/30',\n        textColor: 'text-amber-700 dark:text-amber-400',\n        badgeColor: 'bg-amber-500',\n        buttonColor: 'bg-amber-500 hover:bg-amber-600',\n      };\n    default:\n      return { \n        label: 'อื่นๆ', \n        bgColor: 'bg-slate-50 dark:bg-slate-500/10',\n        borderColor: 'border-slate-200 dark:border-slate-500/30',\n        textColor: 'text-slate-700 dark:text-slate-400',\n        badgeColor: 'bg-slate-500',\n        buttonColor: 'bg-slate-500 hover:bg-slate-600',\n      };\n  }\n};\n\nexport function NhsoRightsModal({ \n  isOpen, \n  onClose, \n  isLoading, \n  error, \n  rights,\n  patientName,\n  patientCid,\n  onRetry,\n  onApplyRights,\n}: NhsoRightsModalProps) {\n  const [copiedField, setCopiedField] = useState<string | null>(null);\n\n  const handleCopy = (text: string, field: string) => {\n    navigator.clipboard.writeText(text);\n    setCopiedField(field);\n    setTimeout(() => setCopiedField(null), 2000);\n  };\n\n  if (!isOpen) return null;\n\n  const formatDate = (dateStr?: unknown) => {\n    const str = safeString(dateStr);\n    if (!str) return '-';\n    try {\n      return new Date(str).toLocaleDateString('th-TH', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n      });\n    } catch {\n      return str;\n    }\n  };\n\n  const rightType = getRightType(rights);\n  const rightTypeInfo = getRightTypeInfo(rightType);\n  const r = rights as Record<string, unknown> | null;\n\n  // Extract data\n  const mainRight = {\n    name: safeString(r?.mainInscl) || '-',\n    code: safeCode(r?.mainInscl),\n  };\n\n  const subRight = {\n    name: safeString(r?.subInscl) || '',\n    code: safeCode(r?.subInscl),\n  };\n\n  const personData = r?.personData as Record<string, unknown> | undefined;\n  const age = personData?.age as { years?: number } | undefined;\n\n  // Hospitals\n  const hospMain = r?.hospMain as Record<string, unknown> | undefined;\n  const hospSub = r?.hospSub as Record<string, unknown> | undefined;\n\n  // Status\n  const isActive = r?.flag === '0' || r?.flag === 0 || r?.fundFlag === '1' || r?.fundFlag === 1;\n  const fundStatus = r?.fundStatus as Record<string, unknown> | undefined;\n  const statusText = fundStatus ? safeString(fundStatus) : '';\n\n  // Dates\n  const startDate = r?.startDateTime || r?.startDate;\n  const expireDate = r?.expireDateTime || r?.expireDate;\n  const searchDate = r?.searchDate;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n      {/* Backdrop */}\n      <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" onClick={onClose} />\n\n      {/* Modal */}\n      <div className=\"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200 max-h-[90vh] flex flex-col\">\n        \n        {/* Header */}\n        <div className={`\n          relative px-6 py-5 text-white shrink-0\n          ${error \n            ? 'bg-gradient-to-r from-red-500 to-red-600' \n            : isActive \n              ? rightType === 'UCS' \n                ? 'bg-gradient-to-r from-emerald-500 to-emerald-600'\n                : rightType === 'SSS'\n                  ? 'bg-gradient-to-r from-blue-500 to-blue-600'\n                  : rightType === 'OFC'\n                    ? 'bg-gradient-to-r from-amber-500 to-amber-600'\n                    : 'bg-gradient-to-r from-slate-500 to-slate-600'\n              : 'bg-gradient-to-r from-slate-500 to-slate-600'\n          }\n        `}>\n          {/* Close button */}\n          <button\n            onClick={onClose}\n            className=\"absolute top-4 right-4 p-1 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors\"\n          >\n            <X size={20} />\n          </button>\n\n          {/* Icon & Title */}\n          <div className=\"flex items-center gap-4\">\n            <div className=\"size-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center\">\n              {isLoading ? (\n                <Loader2 size={24} className=\"animate-spin\" />\n              ) : error ? (\n                <XCircle size={24} />\n              ) : isActive ? (\n                <CheckCircle2 size={24} />\n              ) : (\n                <Shield size={24} />\n              )}\n            </div>\n            <div>\n              <h2 className=\"text-lg font-bold\">\n                {isLoading \n                  ? 'กำลังตรวจสอบสิทธิ์...' \n                  : error \n                    ? 'ไม่สามารถตรวจสอบได้'\n                    : isActive\n                      ? 'ตรวจสอบสิทธิ์สำเร็จ'\n                      : 'ผลการตรวจสอบสิทธิ์'\n                }\n              </h2>\n              <p className=\"text-white/80 text-sm\">สำนักงานหลักประกันสุขภาพแห่งชาติ (สปสช.)</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Content - Scrollable */}\n        <div className=\"flex-1 overflow-y-auto p-6\">\n          {/* Loading State */}\n          {isLoading && (\n            <div className=\"py-12 text-center\">\n              <Loader2 size={48} className=\"animate-spin text-blue-500 mx-auto mb-4\" />\n              <p className=\"text-slate-600 dark:text-slate-400\">กำลังตรวจสอบสิทธิ์การรักษา...</p>\n              <p className=\"text-sm text-slate-400 dark:text-slate-500 mt-1\">กรุณารอสักครู่</p>\n            </div>\n          )}\n\n          {/* Error State */}\n          {!isLoading && error && (\n            <div className=\"py-8\">\n              <div className=\"flex flex-col items-center text-center\">\n                <div className=\"size-16 bg-red-100 dark:bg-red-500/10 rounded-full flex items-center justify-center mb-4\">\n                  <AlertCircle size={32} className=\"text-red-500\" />\n                </div>\n                <p className=\"text-red-600 dark:text-red-400 font-medium mb-2\">เกิดข้อผิดพลาด</p>\n                <p className=\"text-sm text-slate-500 dark:text-slate-400 mb-6\">{error}</p>\n                \n                {onRetry && (\n                  <button\n                    onClick={onRetry}\n                    className=\"px-4 py-2 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2\"\n                  >\n                    <RefreshCw size={16} />\n                    ลองใหม่อีกครั้ง\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Success State - Rights Data */}\n          {!isLoading && !error && rights && (\n            <div className=\"space-y-4\">\n              {/* Patient Info */}\n              <div className=\"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl\">\n                <div className=\"size-10 bg-slate-200 dark:bg-slate-700 rounded-full flex items-center justify-center\">\n                  <User size={20} className=\"text-slate-500\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"font-medium text-slate-900 dark:text-white truncate\">\n                    {safeString(personData?.fullName) || patientName || '-'}\n                  </p>\n                  <div className=\"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400\">\n                    <span className=\"font-mono\">{safeString(personData?.pid) || patientCid || '-'}</span>\n                    {safeString(personData?.sexDesc) && (\n                      <>\n                        <span>•</span>\n                        <span>{safeString(personData?.sexDesc)}</span>\n                      </>\n                    )}\n                    {age?.years && (\n                      <>\n                        <span>•</span>\n                        <span>{age.years} ปี</span>\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Main Rights Card */}\n              <div className={`p-4 rounded-xl border-2 ${rightTypeInfo.bgColor} ${rightTypeInfo.borderColor}`}>\n                <div className=\"flex items-start justify-between mb-3\">\n                  <div className=\"flex-1 min-w-0 pr-3\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <span className={`px-2 py-0.5 ${rightTypeInfo.badgeColor} text-white text-xs font-bold rounded-full`}>\n                        {rightTypeInfo.label}\n                      </span>\n                    </div>\n                    <p className={`text-lg font-bold ${rightTypeInfo.textColor}`}>\n                      {mainRight.name}\n                    </p>\n                    {mainRight.code && (\n                      <p className=\"text-xs text-slate-400 font-mono mt-0.5\">รหัส: {mainRight.code}</p>\n                    )}\n                  </div>\n                  \n                  {/* Status Badge - Pill style */}\n                  <span className={`\n                    shrink-0 px-3 py-1.5 rounded-full text-xs font-bold\n                    ${isActive \n                      ? 'bg-emerald-500 text-white' \n                      : 'bg-red-500 text-white'\n                    }\n                  `}>\n                    {isActive ? 'ใช้งานได้' : 'ไม่พร้อมใช้'}\n                  </span>\n                </div>\n\n                {/* Sub Right */}\n                {subRight.name && (\n                  <div className=\"pt-3 border-t border-slate-200/50 dark:border-slate-600/30\">\n                    <p className=\"text-xs text-slate-500 dark:text-slate-400\">สิทธิย่อย</p>\n                    <p className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">\n                      {subRight.name}\n                    </p>\n                  </div>\n                )}\n\n                {/* Status Description */}\n                {statusText && (\n                  <div className=\"pt-3 border-t border-slate-200/50 dark:border-slate-600/30\">\n                    <p className=\"text-xs text-slate-500 dark:text-slate-400\">สถานะ</p>\n                    <p className=\"text-sm text-slate-700 dark:text-slate-300\">{statusText}</p>\n                  </div>\n                )}\n              </div>\n\n              {/* Hospitals Section */}\n              <div className=\"space-y-3\">\n                <h4 className=\"text-sm font-semibold text-slate-700 dark:text-slate-300 flex items-center gap-2\">\n                  <Building2 size={16} />\n                  สถานบริการ\n                </h4>\n\n                {/* UCS: Grid 2 columns for หลัก + รอง */}\n                {rightType === 'UCS' && (hospMain || hospSub) && (\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    {/* หน่วยบริการหลัก */}\n                    {hospMain && (() => {\n                      const mainName = safeString(hospMain);\n                      const mainCode = safeCode(hospMain);\n                      return (\n                        <div className=\"p-3 bg-emerald-50 dark:bg-emerald-500/10 rounded-xl border border-emerald-200 dark:border-emerald-500/20\">\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <p className=\"text-xs text-emerald-600 dark:text-emerald-400 font-medium\">หลัก</p>\n                            {mainCode && (\n                              <button\n                                onClick={() => handleCopy(mainCode, 'hospMain')}\n                                className=\"p-1 text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 hover:bg-emerald-100 dark:hover:bg-emerald-500/20 rounded transition-colors\"\n                              >\n                                {copiedField === 'hospMain' ? <Check size={12} /> : <Copy size={12} />}\n                              </button>\n                            )}\n                          </div>\n                          <p className=\"text-sm font-medium text-slate-900 dark:text-white truncate\">\n                            {mainName}\n                          </p>\n                          {mainCode && (\n                            <p className=\"text-xs text-slate-400 font-mono\">{mainCode}</p>\n                          )}\n                        </div>\n                      );\n                    })()}\n\n                    {/* หน่วยบริการรอง */}\n                    {hospSub && (() => {\n                      const subName = safeString(hospSub);\n                      const subCode = safeCode(hospSub);\n                      return (\n                        <div className=\"p-3 bg-blue-50 dark:bg-blue-500/10 rounded-xl border border-blue-200 dark:border-blue-500/20\">\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <p className=\"text-xs text-blue-600 dark:text-blue-400 font-medium\">รอง</p>\n                            {subCode && (\n                              <button\n                                onClick={() => handleCopy(subCode, 'hospSub')}\n                                className=\"p-1 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-500/20 rounded transition-colors\"\n                              >\n                                {copiedField === 'hospSub' ? <Check size={12} /> : <Copy size={12} />}\n                              </button>\n                            )}\n                          </div>\n                          <p className=\"text-sm font-medium text-slate-900 dark:text-white truncate\">\n                            {subName}\n                          </p>\n                          {subCode && (\n                            <p className=\"text-xs text-slate-400 font-mono\">{subCode}</p>\n                          )}\n                        </div>\n                      );\n                    })()}\n                  </div>\n                )}\n\n                {/* SSS: Only main hospital */}\n                {rightType === 'SSS' && hospMain && (() => {\n                  const mainName = safeString(hospMain);\n                  const mainCode = safeCode(hospMain);\n                  return (\n                    <div className=\"flex items-start gap-3 p-3 bg-blue-50 dark:bg-blue-500/10 rounded-xl border border-blue-200 dark:border-blue-500/20\">\n                      <div className=\"size-9 bg-blue-100 dark:bg-blue-500/20 rounded-lg flex items-center justify-center shrink-0\">\n                        <Building2 size={18} className=\"text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-xs text-blue-600 dark:text-blue-400 font-medium\">สถานพยาบาลหลัก</p>\n                        <p className=\"text-sm font-medium text-slate-900 dark:text-white\">\n                          {mainName}\n                        </p>\n                        {mainCode && (\n                          <p className=\"text-xs text-slate-400 font-mono\">รหัส: {mainCode}</p>\n                        )}\n                      </div>\n                      {mainCode && (\n                        <button\n                          onClick={() => handleCopy(mainCode, 'hospMain')}\n                          className=\"p-1.5 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-500/20 rounded-lg transition-colors\"\n                        >\n                          {copiedField === 'hospMain' ? <Check size={14} /> : <Copy size={14} />}\n                        </button>\n                      )}\n                    </div>\n                  );\n                })()}\n\n                {/* OFC: Department */}\n                {rightType === 'OFC' && r?.departmentName && (() => {\n                  const deptName = safeString(r.departmentName);\n                  const deptCode = safeString(r.departmentCode);\n                  return (\n                    <div className=\"flex items-start gap-3 p-3 bg-amber-50 dark:bg-amber-500/10 rounded-xl border border-amber-200 dark:border-amber-500/20\">\n                      <div className=\"size-9 bg-amber-100 dark:bg-amber-500/20 rounded-lg flex items-center justify-center shrink-0\">\n                        <Building2 size={18} className=\"text-amber-600 dark:text-amber-400\" />\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-xs text-amber-600 dark:text-amber-400 font-medium\">หน่วยงานต้นสังกัด</p>\n                        <p className=\"text-sm font-medium text-slate-900 dark:text-white\">\n                          {deptName}\n                        </p>\n                        {deptCode && (\n                          <p className=\"text-xs text-slate-400 font-mono\">รหัส: {deptCode}</p>\n                        )}\n                      </div>\n                    </div>\n                  );\n                })()}\n\n                {/* OTHER: show any available hospital */}\n                {rightType === 'OTHER' && hospMain && (() => {\n                  const mainName = safeString(hospMain);\n                  const mainCode = safeCode(hospMain);\n                  return (\n                    <div className=\"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl\">\n                      <div className=\"size-9 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center shrink-0\">\n                        <Building2 size={18} className=\"text-slate-500\" />\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-xs text-slate-500 dark:text-slate-400\">หน่วยบริการหลัก</p>\n                        <p className=\"text-sm font-medium text-slate-900 dark:text-white\">\n                          {mainName}\n                        </p>\n                        {mainCode && (\n                          <p className=\"text-xs text-slate-400 font-mono\">รหัส: {mainCode}</p>\n                        )}\n                      </div>\n                    </div>\n                  );\n                })()}\n              </div>\n\n              {/* Dates */}\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div className=\"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl\">\n                  <div className=\"flex items-center gap-2 text-slate-500 dark:text-slate-400 mb-1\">\n                    <Calendar size={14} />\n                    <span className=\"text-xs\">วันที่เริ่มสิทธิ์</span>\n                  </div>\n                  <p className=\"text-sm font-medium text-slate-900 dark:text-white\">\n                    {formatDate(startDate)}\n                  </p>\n                </div>\n                <div className=\"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl\">\n                  <div className=\"flex items-center gap-2 text-slate-500 dark:text-slate-400 mb-1\">\n                    <Clock size={14} />\n                    <span className=\"text-xs\">วันที่หมดอายุ</span>\n                  </div>\n                  <p className=\"text-sm font-medium text-slate-900 dark:text-white\">\n                    {formatDate(expireDate)}\n                  </p>\n                </div>\n              </div>\n\n              {/* Search Date */}\n              {searchDate && (\n                <div className=\"text-center text-xs text-slate-400\">\n                  ตรวจสอบเมื่อ: {formatDate(searchDate)}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* No Rights Found */}\n          {!isLoading && !error && !rights && (\n            <div className=\"py-8 text-center\">\n              <div className=\"size-16 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4\">\n                <Shield size={32} className=\"text-slate-400\" />\n              </div>\n              <p className=\"text-slate-600 dark:text-slate-400\">ไม่พบข้อมูลสิทธิ์การรักษา</p>\n            </div>\n          )}\n        </div>\n\n        {/* Sticky Bottom Buttons */}\n        {!isLoading && !error && rights && (\n          <div className=\"shrink-0 p-4 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700\">\n            <div className=\"flex gap-3\">\n              <button\n                onClick={onClose}\n                className=\"flex-1 px-4 py-3 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl font-medium hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors\"\n              >\n                ปิด\n              </button>\n              {onApplyRights && isActive && (\n                <button\n                  onClick={() => onApplyRights(rights)}\n                  className={`flex-1 px-4 py-3 text-white rounded-xl font-medium transition-colors flex items-center justify-center gap-2 ${rightTypeInfo.buttonColor}`}\n                >\n                  <CheckCircle2 size={18} />\n                  ใช้สิทธิ์นี้\n                </button>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default NhsoRightsModal;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8249, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/components/nhso/index.ts"],"sourcesContent":["// src/components/nhso/index.ts\n\nexport { NhsoLoginModal } from './NhsoLoginModal';\nexport { NhsoRightsModal } from './NhsoRightsModal';"],"names":[],"mappings":"AAAA,+BAA+B;;AAE/B;AACA"}},
    {"offset": {"line": 8262, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/types/common.ts"],"sourcesContent":["// src/lib/api/types/common.ts\n\n// ============================================\n// Common API Types\n// ============================================\n\nexport interface ApiResponse<T> {\n    success: boolean;\n    data: T;\n    message?: string;\n  }\n  \n  export interface PaginationMeta {\n    total: number;\n    per_page: number;\n    current_page: number;\n    last_page: number;\n  }\n  \n  export interface PaginatedResponse<T> {\n    success: boolean;\n    data: T[];\n    meta: PaginationMeta;\n  }\n  \n  // ============================================\n  // Lookup Types\n  // ============================================\n  \n  export interface LookupItem {\n    code: string;\n    name: string;\n  }\n  \n  export interface LookupItemWithLabel extends LookupItem {\n    label: string;\n  }\n  \n  export interface PnameLookup extends LookupItem {\n    ename?: string;\n    sex?: string;\n  }\n  \n  export interface PttypeLookup extends LookupItem {\n    is_active: boolean;\n    pcode?: string;\n    nhso_code?: string;\n    label?: string;\n  }\n  \n  export interface SubdistrictLookup extends LookupItem {\n    pocode?: string;\n    full_name?: string;\n  }\n  \n  export interface OvstistLookup extends LookupItem {\n    label?: string;\n  }\n  \n  export interface DepartmentLookup extends LookupItem {\n    isActive?: boolean;\n    label?: string;\n    spclty?: string;\n  }\n  \n  export interface DoctorLookup extends LookupItem {\n    licenseNo?: string | null;\n    depcode?: string | null;\n    specialty?: string | null;\n    isActive?: boolean;\n    label?: string;\n  }\n  \n  export interface SpcltyLookup extends LookupItem {\n    label?: string;\n  }\n  \n  export interface AddressSearchResult {\n    addressid?: string;\n    code: string;\n    name: string;\n    full_name: string;\n    chwpart: string;\n    amppart: string;\n    tmbpart: string;\n    pocode: string;\n  }\n  \n  // ============================================\n  // Combined Lookup Types\n  // ============================================\n  \n  export interface OpdVisitLookups {\n    ovstists: OvstistLookup[];\n    pttypes: PttypeLookup[];\n    departments: DepartmentLookup[];\n    doctors: DoctorLookup[];\n    spclties: SpcltyLookup[];\n  }\n  \n  export interface PatientRegistrationLookups {\n    pnames: PnameLookup[];\n    occupations: LookupItem[];\n    nationalities: LookupItem[];\n    religions: LookupItem[];\n    marryStatuses: LookupItem[];\n    educations: LookupItem[];\n    pttypes: PttypeLookup[];\n    provinces: LookupItem[];\n    bloodGroups: LookupItem[];\n    bloodGroupRhs: LookupItem[];\n    sexes: LookupItem[];\n  }"],"names":[],"mappings":"AAAA,8BAA8B;AAE9B,+CAA+C;AAC/C,mBAAmB;AACnB,+CAA+C"}},
    {"offset": {"line": 8275, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/types/patient.ts"],"sourcesContent":["// src/lib/api/types/patient.ts\n\n// ============================================\n// Patient List Types\n// ============================================\n\nexport interface PatientListItem {\n    hn: string;\n    fullName: string;\n    cid: string | null;\n    sex: 'M' | 'F' | '1' | '2' | null;\n    age: number | null;\n    birthday: string | null;\n    phone: string | null;\n    pttype: string | null;\n    pttypeName?: string;\n    bloodgrp: string | null;\n    hasAllergy: boolean;\n    lastVisit: string | null;\n    isDead: boolean;\n  }\n  \n  export interface PatientListResponse {\n    data: PatientListItem[];\n    pagination: {\n      page: number;\n      limit: number;\n      total: number;\n      totalPages: number;\n    };\n  }\n  \n  export interface PatientSearchParams {\n    page?: number;\n    limit?: number;\n    search?: string;\n    pttype?: string;\n    chwpart?: string;\n    amppart?: string;\n    isActive?: boolean;\n  }\n  \n  // ============================================\n  // Patient Detail Types\n  // ============================================\n  \n  export interface PatientDetail {\n    hn: string;\n    pname: string | null;\n    fname: string | null;\n    lname: string | null;\n    midname: string | null;\n    sex: 'M' | 'F' | '1' | '2' | null;\n    birthday: string | null;\n    cid: string | null;\n    mobilePhone: string | null;\n    hometel: string | null;\n    email: string | null;\n    addrpart: string | null;\n    moopart: string | null;\n    road: string | null;\n    tmbpart: string | null;\n    amppart: string | null;\n    chwpart: string | null;\n    poCode: string | null;\n    bloodgrp: string | null;\n    bloodgroupRh: string | null;\n    drugallergy: string | null;\n    g6pd: 'Y' | 'N' | null;\n    pttype: string | null;\n    lastVisit: string | null;\n    firstday: string | null;\n    death: 'Y' | 'N' | null;\n    deathday: string | null;\n    fathername: string | null;\n    mathername: string | null;\n    spsname: string | null;\n    marrystatus: string | null;\n    informname: string | null;\n    informtel: string | null;\n    informrelation: string | null;\n    nationality: string | null;\n    religion: string | null;\n    occupation: string | null;\n    passportNo: string | null;\n    lastUpdate: string | null;\n    // Computed fields\n    fullName: string;\n    age: number | null;\n    ageText: string;\n    fullAddress: string;\n    // Joined data from lookups\n    pttypeName?: string;\n    tmbName?: string;\n    ampName?: string;\n    chwName?: string;\n    nationalityName?: string;\n    religionName?: string;\n    occupationName?: string;\n    // Related data\n    allergies: string[];\n    photo: string | null;\n  }\n  \n  // ============================================\n  // Patient Form Types\n  // ============================================\n  \n  export interface PatientFormData {\n    pname?: string;\n    fname?: string;\n    lname?: string;\n    sex?: string;\n    birthday?: string;\n    cid?: string;\n    mobilePhone?: string;\n    hometel?: string;\n    email?: string;\n    addrpart?: string;\n    moopart?: string;\n    road?: string;\n    tmbpart?: string;\n    amppart?: string;\n    chwpart?: string;\n    poCode?: string;\n    bloodgrp?: string;\n    bloodgroupRh?: string;\n    drugallergy?: string;\n    g6pd?: string;\n    pttype?: string;\n    nationality?: string;\n    religion?: string;\n    occupation?: string;\n    marrystatus?: string;\n    fathername?: string;\n    mathername?: string;\n    spsname?: string;\n    informname?: string;\n    informtel?: string;\n    informrelation?: string;\n  }\n  \n  // ============================================\n  // Patient Stats Types\n  // ============================================\n  \n  export interface PatientStats {\n    total: number;\n    active: number;\n    newThisMonth: number;\n    newToday: number;\n  }\n  \n  // ============================================\n  // Patient Image Types\n  // ============================================\n  \n  export interface PatientImageItem {\n    hn: string;\n    imageName: string;\n    width: number | null;\n    height: number | null;\n    captureDate: string | null;\n  }\n  \n  export interface PatientImageDetail extends PatientImageItem {\n    image: string; // Base64 encoded\n  }"],"names":[],"mappings":"AAAA,+BAA+B;AAE/B,+CAA+C;AAC/C,qBAAqB;AACrB,+CAA+C"}},
    {"offset": {"line": 8288, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/types/settings.ts"],"sourcesContent":["// src/lib/api/types/settings.ts\n\n// ============================================\n// Menu Types\n// ============================================\n\nexport interface MenuItem {\n    id: number;\n    menu_code: string;\n    menu_name: string;\n    menu_name_th: string | null;\n    parent_id: number | null;\n    icon: string | null;\n    route_path: string | null;\n    sort_order: number;\n    is_active: boolean;\n    children?: MenuItem[];\n  }\n  \n  export interface MenuAccess {\n    can_view: boolean;\n    can_create: boolean;\n    can_edit: boolean;\n    can_delete: boolean;\n    can_export: boolean;\n    can_print: boolean;\n  }\n  \n  // ============================================\n  // Role Types\n  // ============================================\n  \n  export interface Role {\n    id: number;\n    role_code: string;\n    role_name: string;\n    description: string | null;\n    is_active: boolean;\n    created_at?: string;\n    updated_at?: string;\n  }\n  \n  export interface RoleMenuAccess {\n    role_id: number;\n    menu_id: number;\n    can_view: number;\n    can_create: number;\n    can_edit: number;\n    can_delete: number;\n    can_export: number;\n    can_print: number;\n  }\n  \n  export interface RoleCreateData {\n    role_code: string;\n    role_name: string;\n    description?: string;\n    is_active?: number;\n  }\n  \n  export interface RoleUpdateData {\n    role_code?: string;\n    role_name?: string;\n    description?: string;\n    is_active?: number;\n  }\n  \n  // ============================================\n  // Group Types\n  // ============================================\n  \n  export interface Group {\n    id: number;\n    group_code: string;\n    group_name: string;\n    description: string | null;\n    parent_id: number | null;\n    is_active: boolean;\n    created_at?: string;\n    updated_at?: string;\n    children?: Group[];\n  }\n  \n  export interface GroupCreateData {\n    group_code: string;\n    group_name: string;\n    description?: string;\n    parent_id?: number;\n    is_active?: number;\n  }\n  \n  export interface GroupUpdateData {\n    group_code?: string;\n    group_name?: string;\n    description?: string;\n    parent_id?: number | null;\n    is_active?: number;\n  }\n  \n  // ============================================\n  // Permission Types\n  // ============================================\n  \n  export interface Permission {\n    id: number;\n    permission_code: string;\n    permission_name: string;\n    description: string | null;\n    created_at?: string;\n    updated_at?: string;\n  }\n  \n  export interface PermissionCreateData {\n    permission_code: string;\n    permission_name: string;\n    description?: string;\n  }\n  \n  export interface PermissionUpdateData {\n    permission_code?: string;\n    permission_name?: string;\n    description?: string;\n  }\n  \n  // ============================================\n  // User Settings Types\n  // ============================================\n  \n  export interface UserMenuAccessCheck {\n    has_access: boolean;\n    can_view: boolean;\n    can_create: boolean;\n    can_edit: boolean;\n    can_delete: boolean;\n    can_export: boolean;\n    can_print: boolean;\n  }\n  \n  export interface UserPermissionCheck {\n    permission_code: string;\n    has_permission: boolean;\n  }"],"names":[],"mappings":"AAAA,gCAAgC;AAEhC,+CAA+C;AAC/C,aAAa;AACb,+CAA+C"}},
    {"offset": {"line": 8301, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/types/index.ts"],"sourcesContent":["// src/lib/api/types/index.ts\n\n// Re-export all types\nexport * from './common';\nexport * from './patient';\nexport * from './settings';"],"names":[],"mappings":"AAAA,6BAA6B;AAE7B,sBAAsB;;AACtB;AACA;AACA"}},
    {"offset": {"line": 8317, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/auth.ts"],"sourcesContent":["// src/lib/api/auth.ts\n\nimport { api } from './client';\n\n// ============================================\n// Auth Response Types\n// ============================================\n\nexport interface LoginResponse {\n  success: boolean;\n  data: {\n    token: string;\n    expiresIn: number;\n    user: {\n      officerId: number;\n      username: string;\n      name: string;\n      role: string;\n      department: string | null;\n      permissions: string[];\n    };\n    loginInfo: {\n      clientIP: string;\n      serverIP: string;\n      serverMAC: string;\n      serverHostname: string;\n      loginTime: string;\n    };\n  };\n}\n\nexport interface MeResponse {\n  success: boolean;\n  data: {\n    user: unknown;\n  };\n}\n\n// ============================================\n// Auth API\n// ============================================\n\nexport const authApi = {\n  login: (username: string, password: string) =>\n    api.post<LoginResponse>('/auth/login', { username, password }),\n\n  logout: () => {\n    api.clearToken();\n    return api.post('/auth/logout');\n  },\n\n  refreshToken: () => api.post<{ token: string }>('/auth/refresh'),\n\n  me: () => api.get<MeResponse>('/auth/me'),\n};\n\nexport default authApi;"],"names":[],"mappings":"AAAA,sBAAsB;;;;;;;AAEtB;;AAwCO,MAAM,UAAU;IACrB,OAAO,CAAC,UAAkB,WACxB,mJAAG,CAAC,IAAI,CAAgB,eAAe;YAAE;YAAU;QAAS;IAE9D,QAAQ;QACN,mJAAG,CAAC,UAAU;QACd,OAAO,mJAAG,CAAC,IAAI,CAAC;IAClB;IAEA,cAAc,IAAM,mJAAG,CAAC,IAAI,CAAoB;IAEhD,IAAI,IAAM,mJAAG,CAAC,GAAG,CAAa;AAChC;uCAEe"}},
    {"offset": {"line": 8346, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/patient.ts"],"sourcesContent":["// src/lib/api/patient.ts\n\nimport { api } from './client';\nimport type { ApiResponse } from './types';\nimport type {\n  PatientListItem,\n  PatientDetail,\n  PatientFormData,\n  PatientSearchParams,\n  PatientListResponse,\n  PatientStats,\n  PatientImageItem,\n  PatientImageDetail,\n} from './types/patient';\n\n// ============================================\n// Internal Response Types\n// ============================================\n\ninterface PatientApiListResponse {\n  success: boolean;\n  data: Array<{\n    hn: string;\n    cid: string | null;\n    full_name: string;\n    sex: 'M' | 'F' | null;\n    age: number | null;\n    birthday: string | null;\n    phone: string | null;\n    pttype: string | null;\n    pttype_name?: string;\n    bloodgrp: string | null;\n    has_allergy: boolean;\n    last_visit: string | null;\n    is_dead: boolean;\n  }>;\n  meta: {\n    total: number;\n    per_page: number;\n    current_page: number;\n    last_page: number;\n  };\n}\n\ninterface PatientApiDetailResponse {\n  success: boolean;\n  data: Record<string, unknown> & {\n    lookups?: {\n      pname_name?: string;\n      pttype_name?: string;\n      occupation_name?: string;\n      nationality_name?: string;\n      religion_name?: string;\n      education_name?: string;\n      marrystatus_name?: string;\n      chwpart_name?: string;\n      amppart_name?: string;\n      tmbpart_name?: string;\n    };\n  };\n}\n\ninterface PatientApiSearchResponse {\n  success: boolean;\n  data: Array<{\n    hn: string;\n    cid: string | null;\n    full_name: string;\n    sex: 'M' | 'F' | null;\n    age: number | null;\n    birthday: string | null;\n    pttype: string | null;\n  }>;\n}\n\ninterface PatientApiStatsResponse {\n  success: boolean;\n  data: PatientStats;\n}\n\ninterface PatientImagesResponse {\n  success: boolean;\n  data: Array<{\n    hn: string;\n    image_name: string;\n    width: number | null;\n    height: number | null;\n    capture_date: string | null;\n  }>;\n}\n\ninterface PatientImageApiResponse {\n  success: boolean;\n  data: {\n    hn: string;\n    image_name: string;\n    image: string;\n    width: number | null;\n    height: number | null;\n    capture_date: string | null;\n  };\n}\n\n// ============================================\n// Transform Functions\n// ============================================\n\nconst transformPatientListItem = (item: PatientApiListResponse['data'][0]): PatientListItem => ({\n  hn: item.hn,\n  fullName: item.full_name,\n  cid: item.cid,\n  sex: item.sex,\n  age: item.age,\n  birthday: item.birthday,\n  phone: item.phone,\n  pttype: item.pttype,\n  pttypeName: item.pttype_name,\n  bloodgrp: item.bloodgrp,\n  hasAllergy: item.has_allergy,\n  lastVisit: item.last_visit,\n  isDead: item.is_dead,\n});\n\nconst transformPatientDetail = (data: PatientApiDetailResponse['data']): PatientDetail => {\n  const lookups = data.lookups || {};\n\n  return {\n    hn: data.hn as string,\n    pname: data.pname as string | null,\n    fname: data.fname as string | null,\n    lname: data.lname as string | null,\n    midname: data.midname as string | null,\n    sex: data.sex as 'M' | 'F' | '1' | '2' | null,\n    birthday: data.birthday as string | null,\n    cid: data.cid as string | null,\n    mobilePhone: data.mobile_phone_number as string | null,\n    hometel: data.hometel as string | null,\n    email: data.email as string | null,\n    addrpart: data.addrpart as string | null,\n    moopart: data.moopart as string | null,\n    road: data.road as string | null,\n    tmbpart: data.tmbpart as string | null,\n    amppart: data.amppart as string | null,\n    chwpart: data.chwpart as string | null,\n    poCode: data.po_code as string | null,\n    bloodgrp: data.bloodgrp as string | null,\n    bloodgroupRh: data.bloodgroup_rh as string | null,\n    drugallergy: data.drugallergy as string | null,\n    g6pd: data.g6pd as 'Y' | 'N' | null,\n    pttype: data.pttype as string | null,\n    lastVisit: data.last_visit as string | null,\n    firstday: data.firstday as string | null,\n    death: data.death as 'Y' | 'N' | null,\n    deathday: data.deathday as string | null,\n    fathername: data.fathername as string | null,\n    mathername: data.mathername as string | null,\n    spsname: data.spsname as string | null,\n    marrystatus: data.marrystatus as string | null,\n    informname: data.informname as string | null,\n    informtel: data.informtel as string | null,\n    informrelation: data.informrelation as string | null,\n    nationality: data.nationality as string | null,\n    religion: data.religion as string | null,\n    occupation: data.occupation as string | null,\n    passportNo: data.passport_no as string | null,\n    lastUpdate: data.last_update as string | null,\n    // Computed fields\n    fullName: [data.pname, data.fname, data.lname].filter(Boolean).join(' '),\n    age: data.age as number | null,\n    ageText: (data.age_text as string) || '',\n    fullAddress: (data.full_address as string) || '',\n    // Joined data from lookups\n    pttypeName: lookups.pttype_name,\n    tmbName: lookups.tmbpart_name,\n    ampName: lookups.amppart_name,\n    chwName: lookups.chwpart_name,\n    nationalityName: lookups.nationality_name,\n    religionName: lookups.religion_name,\n    occupationName: lookups.occupation_name,\n    // Related data\n    allergies: data.drugallergy\n      ? (data.drugallergy as string)\n          .split(',')\n          .map((s) => s.trim())\n          .filter(Boolean)\n      : [],\n    photo: data.photo as string | null,\n  };\n};\n\n// ============================================\n// Patient API\n// ============================================\n\nexport const patientApi = {\n  // Get patient list with pagination\n  getList: async (params: PatientSearchParams = {}): Promise<PatientListResponse> => {\n    const queryParams = new URLSearchParams();\n    if (params.page) queryParams.append('page', String(params.page));\n    if (params.limit) queryParams.append('limit', String(params.limit));\n    if (params.search) queryParams.append('search', params.search);\n    if (params.pttype) queryParams.append('pttype', params.pttype);\n    if (params.chwpart) queryParams.append('chwpart', params.chwpart);\n    if (params.amppart) queryParams.append('amppart', params.amppart);\n    if (params.isActive !== undefined) queryParams.append('is_active', String(params.isActive));\n\n    const response = await api.get<PatientApiListResponse>(`/patients?${queryParams.toString()}`);\n\n    return {\n      data: response.data.map(transformPatientListItem),\n      pagination: {\n        page: response.meta.current_page,\n        limit: response.meta.per_page,\n        total: response.meta.total,\n        totalPages: response.meta.last_page,\n      },\n    };\n  },\n\n  // Get patient detail by HN\n  getByHn: async (hn: string): Promise<{ success: boolean; data: PatientDetail }> => {\n    const response = await api.get<PatientApiDetailResponse>(`/patients/${hn}`);\n    return {\n      success: response.success,\n      data: transformPatientDetail(response.data),\n    };\n  },\n\n  // Get patient detail by CID\n  getByCid: async (cid: string): Promise<{ success: boolean; data: PatientDetail }> => {\n    const response = await api.get<PatientApiDetailResponse>(`/patients/cid/${cid}`);\n    return {\n      success: response.success,\n      data: transformPatientDetail(response.data),\n    };\n  },\n\n  // Quick search patients\n  search: async (q: string, limit = 10): Promise<PatientListItem[]> => {\n    if (!q || q.length < 2) return [];\n\n    const response = await api.get<PatientApiSearchResponse>(\n      `/patients/search?q=${encodeURIComponent(q)}&limit=${limit}`\n    );\n\n    return response.data.map((item) => ({\n      hn: item.hn,\n      fullName: item.full_name,\n      cid: item.cid,\n      sex: item.sex,\n      age: item.age,\n      birthday: item.birthday,\n      phone: null,\n      pttype: item.pttype,\n      bloodgrp: null,\n      hasAllergy: false,\n      lastVisit: null,\n      isDead: false,\n    }));\n  },\n\n  // Create new patient\n  create: async (data: PatientFormData): Promise<ApiResponse<{ hn: string }>> => {\n    return api.post<ApiResponse<{ hn: string }>>('/patients', {\n      pname: data.pname,\n      fname: data.fname,\n      lname: data.lname,\n      sex: data.sex,\n      birthday: data.birthday,\n      cid: data.cid,\n      mobile_phone_number: data.mobilePhone,\n      hometel: data.hometel,\n      email: data.email,\n      addrpart: data.addrpart,\n      moopart: data.moopart,\n      road: data.road,\n      tmbpart: data.tmbpart,\n      amppart: data.amppart,\n      chwpart: data.chwpart,\n      po_code: data.poCode,\n      bloodgrp: data.bloodgrp,\n      bloodgroup_rh: data.bloodgroupRh,\n      drugallergy: data.drugallergy,\n      g6pd: data.g6pd,\n      pttype: data.pttype,\n      nationality: data.nationality,\n      religion: data.religion,\n      occupation: data.occupation,\n      marrystatus: data.marrystatus,\n      fathername: data.fathername,\n      mathername: data.mathername,\n      spsname: data.spsname,\n      informname: data.informname,\n      informtel: data.informtel,\n      informrelation: data.informrelation,\n    });\n  },\n\n  // Update patient\n  update: async (hn: string, data: Partial<PatientFormData>): Promise<ApiResponse<void>> => {\n    const payload: Record<string, unknown> = {};\n\n    if (data.pname !== undefined) payload.pname = data.pname;\n    if (data.fname !== undefined) payload.fname = data.fname;\n    if (data.lname !== undefined) payload.lname = data.lname;\n    if (data.sex !== undefined) payload.sex = data.sex;\n    if (data.birthday !== undefined) payload.birthday = data.birthday;\n    if (data.cid !== undefined) payload.cid = data.cid;\n    if (data.mobilePhone !== undefined) payload.mobile_phone_number = data.mobilePhone;\n    if (data.hometel !== undefined) payload.hometel = data.hometel;\n    if (data.email !== undefined) payload.email = data.email;\n    if (data.addrpart !== undefined) payload.addrpart = data.addrpart;\n    if (data.moopart !== undefined) payload.moopart = data.moopart;\n    if (data.road !== undefined) payload.road = data.road;\n    if (data.tmbpart !== undefined) payload.tmbpart = data.tmbpart;\n    if (data.amppart !== undefined) payload.amppart = data.amppart;\n    if (data.chwpart !== undefined) payload.chwpart = data.chwpart;\n    if (data.poCode !== undefined) payload.po_code = data.poCode;\n    if (data.bloodgrp !== undefined) payload.bloodgrp = data.bloodgrp;\n    if (data.bloodgroupRh !== undefined) payload.bloodgroup_rh = data.bloodgroupRh;\n    if (data.drugallergy !== undefined) payload.drugallergy = data.drugallergy;\n    if (data.g6pd !== undefined) payload.g6pd = data.g6pd;\n    if (data.pttype !== undefined) payload.pttype = data.pttype;\n    if (data.nationality !== undefined) payload.nationality = data.nationality;\n    if (data.religion !== undefined) payload.religion = data.religion;\n    if (data.occupation !== undefined) payload.occupation = data.occupation;\n    if (data.marrystatus !== undefined) payload.marrystatus = data.marrystatus;\n    if (data.fathername !== undefined) payload.fathername = data.fathername;\n    if (data.mathername !== undefined) payload.mathername = data.mathername;\n    if (data.spsname !== undefined) payload.spsname = data.spsname;\n    if (data.informname !== undefined) payload.informname = data.informname;\n    if (data.informtel !== undefined) payload.informtel = data.informtel;\n    if (data.informrelation !== undefined) payload.informrelation = data.informrelation;\n\n    return api.put<ApiResponse<void>>(`/patients/${hn}`, payload);\n  },\n\n  // Delete patient\n  delete: async (hn: string): Promise<ApiResponse<void>> => {\n    return api.delete<ApiResponse<void>>(`/patients/${hn}`);\n  },\n\n  // Get patient statistics\n  getStats: async (): Promise<PatientStats> => {\n    const response = await api.get<PatientApiStatsResponse>('/patients/stats');\n    return response.data;\n  },\n};\n\n// ============================================\n// Patient Image API\n// ============================================\n\nexport const patientImageApi = {\n  // Get all images for a patient\n  getByHn: async (hn: string): Promise<PatientImageItem[]> => {\n    const response = await api.get<PatientImagesResponse>(`/patients/${hn}/images`);\n    return response.data.map((item) => ({\n      hn: item.hn,\n      imageName: item.image_name,\n      width: item.width,\n      height: item.height,\n      captureDate: item.capture_date,\n    }));\n  },\n\n  // Get profile image (primary image)\n  getProfileImage: async (hn: string): Promise<PatientImageDetail | null> => {\n    try {\n      const response = await api.get<PatientImageApiResponse>(`/patients/${hn}/image`);\n      return {\n        hn: response.data.hn,\n        imageName: response.data.image_name,\n        image: response.data.image,\n        width: response.data.width,\n        height: response.data.height,\n        captureDate: response.data.capture_date,\n      };\n    } catch {\n      return null;\n    }\n  },\n\n  // Get raw image URL for img src\n  getProfileImageUrl: (hn: string): string => {\n    const baseUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3333/api/v1';\n    return `${baseUrl}/patients/${hn}/image/raw`;\n  },\n\n  // Upload profile image\n  upload: async (\n    hn: string,\n    imageData: string,\n    width?: number,\n    height?: number\n  ): Promise<{ success: boolean; message: string }> => {\n    const response = await api.post<{ success: boolean; message: string }>(`/patients/${hn}/image`, {\n      image: imageData,\n      width,\n      height,\n    });\n    return response;\n  },\n\n  // Delete profile image\n  delete: async (hn: string): Promise<void> => {\n    await api.delete(`/patients/${hn}/image`);\n  },\n};\n\nexport default patientApi;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8634, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/settings.ts"],"sourcesContent":["// src/lib/api/settings.ts\n\nimport { api } from './client';\nimport type { ApiResponse } from './types';\nimport type {\n  MenuItem,\n  Role,\n  RoleMenuAccess,\n  RoleCreateData,\n  RoleUpdateData,\n  Group,\n  GroupCreateData,\n  GroupUpdateData,\n  Permission,\n  PermissionCreateData,\n  PermissionUpdateData,\n  UserMenuAccessCheck,\n  UserPermissionCheck,\n} from './types/settings';\n\n// ============================================\n// Helper: Transform menu from API response\n// ============================================\n\nconst transformMenuFromApi = (menu: Record<string, unknown>): MenuItem => ({\n  id: menu.id as number,\n  menu_code: (menu.menuCode || menu.menu_code) as string,\n  menu_name: (menu.menuName || menu.menu_name) as string,\n  menu_name_th: (menu.menuNameTh || menu.menu_name_th) as string | null,\n  parent_id: (menu.parentId ?? menu.parent_id ?? null) as number | null,\n  icon: (menu.icon || null) as string | null,\n  route_path: (menu.routePath || menu.route_path) as string | null,\n  sort_order: (menu.sortOrder ?? menu.sort_order ?? 0) as number,\n  is_active: Boolean(menu.isActive ?? menu.is_active),\n});\n\n// ============================================\n// Menu API\n// ============================================\n\nexport const menuApi = {\n  // =========================================\n  // Public Menu Operations\n  // =========================================\n\n  getAll: async (): Promise<ApiResponse<MenuItem[]>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>[]>>('/settings/menus');\n    return {\n      ...response,\n      data: response.data.map(transformMenuFromApi),\n    };\n  },\n\n  getActive: async (): Promise<ApiResponse<MenuItem[]>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>[]>>('/settings/menus/active');\n    return {\n      ...response,\n      data: response.data.map(transformMenuFromApi),\n    };\n  },\n\n  getTree: async (): Promise<ApiResponse<MenuItem[]>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>[]>>('/settings/menus/tree');\n    return {\n      ...response,\n      data: response.data.map(transformMenuFromApi),\n    };\n  },\n\n  getFullTree: async (): Promise<ApiResponse<MenuItem[]>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>[]>>('/settings/menus/tree/full');\n    return {\n      ...response,\n      data: response.data.map(transformMenuFromApi),\n    };\n  },\n\n  getById: async (id: number): Promise<ApiResponse<MenuItem>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>>>(`/settings/menus/${id}`);\n    return {\n      ...response,\n      data: transformMenuFromApi(response.data),\n    };\n  },\n\n  getByCode: async (code: string): Promise<ApiResponse<MenuItem>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>>>(`/settings/menus/code/${code}`);\n    return {\n      ...response,\n      data: transformMenuFromApi(response.data),\n    };\n  },\n\n  getByParentId: async (parentId: number | null): Promise<ApiResponse<MenuItem[]>> => {\n    const response = await api.get<ApiResponse<Record<string, unknown>[]>>(\n      `/settings/menus/parent/${parentId === null ? 'null' : parentId}`\n    );\n    return {\n      ...response,\n      data: response.data.map(transformMenuFromApi),\n    };\n  },\n\n  // =========================================\n  // CRUD Operations\n  // =========================================\n\n  create: (data: {\n    menu_code: string;\n    menu_name: string;\n    menu_name_th?: string;\n    parent_id?: number | null;\n    icon?: string;\n    route_path?: string;\n    sort_order?: number;\n    is_active?: number;\n  }) => api.post<ApiResponse<MenuItem>>('/settings/menus', data),\n\n  update: (id: number, data: Partial<MenuItem>) =>\n    api.put<ApiResponse<MenuItem>>(`/settings/menus/${id}`, data),\n\n  delete: (id: number) => api.delete<ApiResponse<void>>(`/settings/menus/${id}`),\n\n  // =========================================\n  // Bulk Operations\n  // =========================================\n\n  reorder: (items: { id: number; sort_order: number }[]) =>\n    api.post<ApiResponse<void>>('/settings/menus/reorder', { items }),\n\n  move: (id: number, parentId: number | null) =>\n    api.put<ApiResponse<MenuItem>>(`/settings/menus/${id}/move`, { parent_id: parentId }),\n\n  // =========================================\n  // User Menu Access\n  // =========================================\n\n  getUserAccess: (userId: number) =>\n    api.get<ApiResponse<MenuItem[]>>(`/settings/menus/user/${userId}/access`),\n\n  getUserTree: (userId: number) =>\n    api.get<ApiResponse<MenuItem[]>>(`/settings/menus/user/${userId}/tree`),\n\n  checkUserAccess: (userId: number, menuCode: string) =>\n    api.get<ApiResponse<UserMenuAccessCheck>>(`/settings/menus/user/${userId}/check/${menuCode}`),\n\n  // =========================================\n  // Current User Menu Access (my)\n  // =========================================\n\n  getMyAccess: () => api.get<ApiResponse<MenuItem[]>>('/settings/menus/my/access'),\n\n  getMyTree: () => api.get<ApiResponse<MenuItem[]>>('/settings/menus/my/tree'),\n\n  checkMyAccess: (menuCode: string) =>\n    api.get<ApiResponse<UserMenuAccessCheck>>(`/settings/menus/my/check/${menuCode}`),\n\n  // Alias for backward compatibility\n  getUserMenus: () => api.get<ApiResponse<MenuItem[]>>('/settings/menus/my/tree'),\n};\n\n// ============================================\n// Role API\n// ============================================\n\nexport const roleApi = {\n  getAll: () => api.get<ApiResponse<Role[]>>('/settings/roles'),\n\n  getActive: () => api.get<ApiResponse<Role[]>>('/settings/roles/active'),\n\n  getById: (id: number) => api.get<ApiResponse<Role>>(`/settings/roles/${id}`),\n\n  getWithDetails: (id: number) => api.get<ApiResponse<Role>>(`/settings/roles/${id}/details`),\n\n  getMenuAccess: (id: number) => api.get<ApiResponse<RoleMenuAccess[]>>(`/settings/roles/${id}/menus`),\n\n  getPermissions: (id: number) => api.get<ApiResponse<Permission[]>>(`/settings/roles/${id}/permissions`),\n\n  create: (data: RoleCreateData) => api.post<ApiResponse<Role>>('/settings/roles', data),\n\n  update: (id: number, data: RoleUpdateData) => api.put<ApiResponse<Role>>(`/settings/roles/${id}`, data),\n\n  delete: (id: number) => api.delete<ApiResponse<void>>(`/settings/roles/${id}`),\n\n  setMenuAccess: (\n    roleId: number,\n    menuId: number,\n    access: {\n      can_view?: number;\n      can_create?: number;\n      can_edit?: number;\n      can_delete?: number;\n      can_export?: number;\n      can_print?: number;\n    }\n  ) => api.post<ApiResponse<void>>(`/settings/roles/${roleId}/menus/${menuId}`, access),\n\n  removeMenuAccess: (roleId: number, menuId: number) =>\n    api.delete<ApiResponse<void>>(`/settings/roles/${roleId}/menus/${menuId}`),\n\n  addPermission: (roleId: number, permissionId: number) =>\n    api.post<ApiResponse<void>>(`/settings/roles/${roleId}/permissions/${permissionId}`),\n\n  removePermission: (roleId: number, permissionId: number) =>\n    api.delete<ApiResponse<void>>(`/settings/roles/${roleId}/permissions/${permissionId}`),\n};\n\n// ============================================\n// Group API\n// ============================================\n\nexport const groupApi = {\n  getAll: () => api.get<ApiResponse<Group[]>>('/settings/groups'),\n\n  getActive: () => api.get<ApiResponse<Group[]>>('/settings/groups/active'),\n\n  getTree: () => api.get<ApiResponse<Group[]>>('/settings/groups/tree'),\n\n  getById: (id: number) => api.get<ApiResponse<Group>>(`/settings/groups/${id}`),\n\n  getWithRoles: (id: number) => api.get<ApiResponse<Group>>(`/settings/groups/${id}/roles`),\n\n  create: (data: GroupCreateData) => api.post<ApiResponse<Group>>('/settings/groups', data),\n\n  update: (id: number, data: GroupUpdateData) => api.put<ApiResponse<Group>>(`/settings/groups/${id}`, data),\n\n  delete: (id: number) => api.delete<ApiResponse<void>>(`/settings/groups/${id}`),\n\n  addRole: (groupId: number, roleId: number) =>\n    api.post<ApiResponse<void>>(`/settings/groups/${groupId}/roles/${roleId}`),\n\n  removeRole: (groupId: number, roleId: number) =>\n    api.delete<ApiResponse<void>>(`/settings/groups/${groupId}/roles/${roleId}`),\n};\n\n// ============================================\n// Permission API\n// ============================================\n\nexport const permissionApi = {\n  getAll: () => api.get<ApiResponse<Permission[]>>('/settings/permissions'),\n\n  getById: (id: number) => api.get<ApiResponse<Permission>>(`/settings/permissions/${id}`),\n\n  create: (data: PermissionCreateData) => api.post<ApiResponse<Permission>>('/settings/permissions', data),\n\n  update: (id: number, data: PermissionUpdateData) =>\n    api.put<ApiResponse<Permission>>(`/settings/permissions/${id}`, data),\n\n  delete: (id: number) => api.delete<ApiResponse<void>>(`/settings/permissions/${id}`),\n};\n\n// ============================================\n// User Settings API\n// ============================================\n\nexport const userSettingsApi = {\n  getGroups: (userId: number) => api.get<ApiResponse<Group[]>>(`/settings/users/${userId}/groups`),\n\n  getRoles: (userId: number) => api.get<ApiResponse<Role[]>>(`/settings/users/${userId}/roles`),\n\n  getEffectiveRoles: (userId: number) => api.get<ApiResponse<Role[]>>(`/settings/users/${userId}/effective-roles`),\n\n  getMenuAccess: (userId: number) => api.get<ApiResponse<MenuItem[]>>(`/settings/users/${userId}/menu-access`),\n\n  getPermissions: (userId: number) => api.get<ApiResponse<Permission[]>>(`/settings/users/${userId}/permissions`),\n\n  checkMenuAccess: (userId: number, menuCode: string) =>\n    api.get<ApiResponse<RoleMenuAccess>>(`/settings/users/${userId}/check-menu/${menuCode}`),\n\n  checkPermission: (userId: number, permissionCode: string) =>\n    api.get<ApiResponse<UserPermissionCheck>>(`/settings/users/${userId}/check-permission/${permissionCode}`),\n\n  addGroup: (userId: number, groupId: number, isPrimary?: number) =>\n    api.post<ApiResponse<void>>(`/settings/users/${userId}/groups/${groupId}`, { is_primary: isPrimary }),\n\n  removeGroup: (userId: number, groupId: number) =>\n    api.delete<ApiResponse<void>>(`/settings/users/${userId}/groups/${groupId}`),\n\n  setPrimaryGroup: (userId: number, groupId: number) =>\n    api.put<ApiResponse<void>>(`/settings/users/${userId}/groups/${groupId}/primary`),\n\n  addRole: (userId: number, roleId: number) =>\n    api.post<ApiResponse<void>>(`/settings/users/${userId}/roles/${roleId}`),\n\n  removeRole: (userId: number, roleId: number) =>\n    api.delete<ApiResponse<void>>(`/settings/users/${userId}/roles/${roleId}`),\n};\n\n// ============================================\n// Current User (My) Settings API\n// ============================================\n\nexport const mySettingsApi = {\n  getEffectiveRoles: () => api.get<ApiResponse<Role[]>>('/settings/my/effective-roles'),\n\n  getMenuAccess: () => api.get<ApiResponse<MenuItem[]>>('/settings/my/menu-access'),\n\n  getPermissions: () => api.get<ApiResponse<Permission[]>>('/settings/my/permissions'),\n\n  checkMenuAccess: (menuCode: string) =>\n    api.get<ApiResponse<RoleMenuAccess>>(`/settings/my/check-menu/${menuCode}`),\n\n  checkPermission: (permissionCode: string) =>\n    api.get<ApiResponse<UserPermissionCheck>>(`/settings/my/check-permission/${permissionCode}`),\n};\n\n// ============================================\n// Combined Settings API (backward compatible)\n// ============================================\n\nexport const settingsApi = {\n  roles: roleApi,\n  groups: groupApi,\n  menus: {\n    getAll: () => menuApi.getAll(),\n    getTree: () => menuApi.getTree(),\n    getById: (id: number) => menuApi.getById(id),\n    create: menuApi.create,\n    update: menuApi.update,\n    delete: menuApi.delete,\n  },\n  permissions: permissionApi,\n  users: userSettingsApi,\n  my: mySettingsApi,\n};\n\nexport default settingsApi;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8832, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/user.ts"],"sourcesContent":["// src/lib/api/user.ts\n\nimport { api } from './client';\nimport type { ApiResponse } from './types';\nimport type { Role, Group } from './types/settings';\n\n// ============================================\n// User API\n// ============================================\n\nexport const userApi = {\n  // Get all users\n  getAll: (params?: { page?: number; limit?: number; search?: string }) => {\n    const query = new URLSearchParams();\n    if (params?.page) query.set('page', String(params.page));\n    if (params?.limit) query.set('limit', String(params.limit));\n    if (params?.search) query.set('search', params.search);\n    const queryString = query.toString();\n    return api.get<ApiResponse<unknown[]>>(`/users${queryString ? `?${queryString}` : ''}`);\n  },\n\n  // Get user by ID\n  getById: (id: number) => api.get<ApiResponse<unknown>>(`/users/${id}`),\n\n  // Create user\n  create: (data: unknown) => api.post<ApiResponse<unknown>>('/users', data),\n\n  // Update user\n  update: (id: number, data: unknown) => api.put<ApiResponse<unknown>>(`/users/${id}`, data),\n\n  // Delete user\n  delete: (id: number) => api.delete<ApiResponse<void>>(`/users/${id}`),\n\n  // Get user roles\n  getRoles: (userId: number) => api.get<ApiResponse<Role[]>>(`/users/${userId}/roles`),\n\n  // Assign roles to user\n  assignRoles: (userId: number, roleIds: number[]) =>\n    api.put<ApiResponse<void>>(`/users/${userId}/roles`, { roleIds }),\n\n  // Get user groups\n  getGroups: (userId: number) => api.get<ApiResponse<Group[]>>(`/users/${userId}/groups`),\n\n  // Assign groups to user\n  assignGroups: (userId: number, groupIds: number[]) =>\n    api.put<ApiResponse<void>>(`/users/${userId}/groups`, { groupIds }),\n};\n\nexport default userApi;"],"names":[],"mappings":"AAAA,sBAAsB;;;;;;;AAEtB;;AAQO,MAAM,UAAU;IACrB,gBAAgB;IAChB,QAAQ,CAAC;QACP,MAAM,QAAQ,IAAI;QAClB,IAAI,QAAQ,MAAM,MAAM,GAAG,CAAC,QAAQ,OAAO,OAAO,IAAI;QACtD,IAAI,QAAQ,OAAO,MAAM,GAAG,CAAC,SAAS,OAAO,OAAO,KAAK;QACzD,IAAI,QAAQ,QAAQ,MAAM,GAAG,CAAC,UAAU,OAAO,MAAM;QACrD,MAAM,cAAc,MAAM,QAAQ;QAClC,OAAO,mJAAG,CAAC,GAAG,CAAyB,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC,EAAE,aAAa,GAAG,IAAI;IACxF;IAEA,iBAAiB;IACjB,SAAS,CAAC,KAAe,mJAAG,CAAC,GAAG,CAAuB,CAAC,OAAO,EAAE,IAAI;IAErE,cAAc;IACd,QAAQ,CAAC,OAAkB,mJAAG,CAAC,IAAI,CAAuB,UAAU;IAEpE,cAAc;IACd,QAAQ,CAAC,IAAY,OAAkB,mJAAG,CAAC,GAAG,CAAuB,CAAC,OAAO,EAAE,IAAI,EAAE;IAErF,cAAc;IACd,QAAQ,CAAC,KAAe,mJAAG,CAAC,MAAM,CAAoB,CAAC,OAAO,EAAE,IAAI;IAEpE,iBAAiB;IACjB,UAAU,CAAC,SAAmB,mJAAG,CAAC,GAAG,CAAsB,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC;IAEnF,uBAAuB;IACvB,aAAa,CAAC,QAAgB,UAC5B,mJAAG,CAAC,GAAG,CAAoB,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC,EAAE;YAAE;QAAQ;IAEjE,kBAAkB;IAClB,WAAW,CAAC,SAAmB,mJAAG,CAAC,GAAG,CAAuB,CAAC,OAAO,EAAE,OAAO,OAAO,CAAC;IAEtF,wBAAwB;IACxB,cAAc,CAAC,QAAgB,WAC7B,mJAAG,CAAC,GAAG,CAAoB,CAAC,OAAO,EAAE,OAAO,OAAO,CAAC,EAAE;YAAE;QAAS;AACrE;uCAEe"}},
    {"offset": {"line": 8880, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/lib/api/index.ts"],"sourcesContent":["// src/lib/api/index.ts\n//\n// Main entry point - Re-exports everything for backward compatibility\n// \n// Usage (existing code still works):\n//   import { patientApi, lookupApi, authApi } from '@/lib/api';\n//\n// Usage (new, more specific imports):\n//   import { patientApi } from '@/lib/api/patient';\n//   import { lookupApi } from '@/lib/api/lookups';\n//\n\n// ============================================\n// Client\n// ============================================\nexport { api } from './client';\nexport type { default as ApiClient } from './client';\n\n// ============================================\n// Types (re-export all)\n// ============================================\nexport * from './types';\n\n// ============================================\n// Auth API\n// ============================================\nexport { authApi } from './auth';\nexport type { LoginResponse, MeResponse } from './auth';\n\n// ============================================\n// Lookup API\n// ============================================\nexport { lookupApi } from './lookups';\n\n// ============================================\n// Patient API\n// ============================================\nexport { patientApi, patientImageApi } from './patient';\n\n// ============================================\n// Settings API (Menu, Role, Group, Permission)\n// ============================================\nexport {\n  menuApi,\n  roleApi,\n  groupApi,\n  permissionApi,\n  userSettingsApi,\n  mySettingsApi,\n  settingsApi,\n} from './settings';\n\n// ============================================\n// User API\n// ============================================\nexport { userApi } from './user';\n\n// ============================================\n// NHSO API (ตรวจสอบสิทธิ สปสช.)\n// ============================================\nexport { nhsoApi } from './nhso';\nexport type {\n  NhsoLoginResponse,\n  NhsoTokenStatus,\n  NhsoPersonalFund,\n  NhsoSearchByPidResponse,\n  NhsoCheckRightsResponse,\n} from './nhso';\n\n// ============================================\n// Default export\n// ============================================\nexport { api as default } from './client';"],"names":[],"mappings":"AAAA,uBAAuB;AACvB,EAAE;AACF,sEAAsE;AACtE,GAAG;AACH,qCAAqC;AACrC,gEAAgE;AAChE,EAAE;AACF,sCAAsC;AACtC,oDAAoD;AACpD,mDAAmD;AACnD,EAAE;AAEF,+CAA+C;AAC/C,SAAS;AACT,+CAA+C;;AAC/C;AAGA,+CAA+C;AAC/C,wBAAwB;AACxB,+CAA+C;AAC/C;AAEA,+CAA+C;AAC/C,WAAW;AACX,+CAA+C;AAC/C;AAGA,+CAA+C;AAC/C,aAAa;AACb,+CAA+C;AAC/C;AAEA,+CAA+C;AAC/C,cAAc;AACd,+CAA+C;AAC/C;AAEA,+CAA+C;AAC/C,+CAA+C;AAC/C,+CAA+C;AAC/C;AAUA,+CAA+C;AAC/C,WAAW;AACX,+CAA+C;AAC/C;AAEA,+CAA+C;AAC/C,gCAAgC;AAChC,+CAA+C;AAC/C"}},
    {"offset": {"line": 8940, "column": 0}, "map": {"version":3,"sources":["file:///Users/auto/programming/gwt/gwt-his/his-web/src/app/mr/newvisit/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport {\n  Calendar,\n  Clock,\n  Save,\n  X,\n  FileText,\n  AlertCircle,\n  User,\n  Lock,\n  Unlock,\n  Camera,\n  Trash2,\n  ChevronDown,\n  ChevronUp,\n  Phone,\n  MapPin,\n  CreditCard,\n  Stethoscope,\n  Building2,\n  ClipboardList,\n  Shield,\n  Activity,\n  QrCode,\n  Scan,\n  History,\n  MoreVertical,\n  Check,\n  ArrowLeft,\n  Loader2,\n} from 'lucide-react';\nimport { AdminLayout } from '@/components/layout';\nimport CustomSelect from '@/components/ui/CustomSelect';\nimport { SearchablePatientSelect } from '@/components/ui';\nimport { PatientListItem } from '@/types/patient.types';\nimport { patientApi, patientImageApi } from '@/lib/api';\nimport type { NhsoPersonalFund } from '@/lib/api/types/nhso';\n\nimport { SmartCardButton } from '@/components/ui/SmartCardButton';\nimport { SmartCardData } from '@/hooks/useSmartCardReader';\nimport { useOpdVisitLookups } from '@/hooks/useOpdVisitLookups';\nimport { NhsoLoginModal, NhsoRightsModal } from '@/components/nhso';\nimport { nhsoApi } from '@/lib/api/index';\n\n// Types\ninterface Patient {\n  hn: string;\n  name: string;\n  age: string;\n  gender: string;\n  birthDate: string;\n  address: string;\n  cid: string;\n  phone: string;\n  photo: string | null;\n  bloodType?: string;\n  allergies?: string[];\n  lastVisit?: string;\n  pttypeName?: string;\n}\n\ninterface FormData {\n  visitDate: string;\n  visitTime: string;\n  visitType: string;\n  pttype: string;\n  pttypeName: string;\n  chiefComplaint: string;\n  department: string;\n  spclty: string;\n  cid: string;\n  patientType: string;\n  timeType: string;\n  urgency: string;\n  patientStatus: string;\n}\n\n// Static options (ไม่มีใน database)\nconst patientStatusOptions = [\n  { value: 'walkin', label: 'เดินมา', icon: '🚶' },\n  { value: 'wheelchair', label: 'รถเข็น', icon: '🦽' },\n  { value: 'stretcher', label: 'เปลนอน', icon: '🛏️' },\n];\n\n// ============================================\n// Sub Components\n// ============================================\n\n// Patient Card Component (Mobile-first)\nconst PatientCard: React.FC<{\n  patient: Patient | null;\n  loading: boolean;\n  onCapture?: () => void;\n}> = ({ patient, loading, onCapture }) => {\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4 animate-pulse\">\n        <div className=\"flex gap-4\">\n          <div className=\"size-20 lg:size-24 bg-slate-200 dark:bg-slate-700 rounded-xl\" />\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"h-5 bg-slate-200 dark:bg-slate-700 rounded w-3/4\" />\n            <div className=\"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/2\" />\n            <div className=\"h-4 bg-slate-200 dark:bg-slate-700 rounded w-2/3\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!patient) {\n    return (\n      <div className=\"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-900 rounded-2xl border-2 border-dashed border-slate-300 dark:border-slate-700 p-6 lg:p-8\">\n        <div className=\"text-center\">\n          <div className=\"size-16 lg:size-20 mx-auto bg-slate-200 dark:bg-slate-700 rounded-2xl flex items-center justify-center mb-3\">\n            <User size={32} className=\"text-slate-400 dark:text-slate-500\" />\n          </div>\n          <p className=\"text-sm text-slate-500 dark:text-slate-400\">\n            ค้นหา HN เพื่อแสดงข้อมูลผู้ป่วย\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden\">\n      {/* Patient Header */}\n      <div className=\"p-4 bg-gradient-to-r from-primary-500 to-primary-600 text-white\">\n        <div className=\"flex items-start gap-4\">\n          {/* Photo */}\n          <div className=\"relative shrink-0\">\n            <div className=\"size-20 lg:size-24 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center overflow-hidden\">\n              {patient.photo ? (\n                <img src={patient.photo} alt={patient.name} className=\"size-full object-cover\" />\n              ) : (\n                <User size={32} className=\"text-white/60\" />\n              )}\n            </div>\n            <button\n              onClick={onCapture}\n              className=\"absolute -bottom-1 -right-1 size-8 bg-white text-primary-600 rounded-full shadow-lg flex items-center justify-center hover:scale-110 transition-transform\"\n            >\n              <Camera size={14} />\n            </button>\n          </div>\n\n          {/* Info */}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-start justify-between gap-2\">\n              <div>\n                <h3 className=\"font-bold text-lg truncate\">{patient.name}</h3>\n                <p className=\"text-white/80 text-sm font-mono\">HN: {patient.hn}</p>\n              </div>\n              {patient.bloodType && (\n                <span className=\"px-2 py-1 bg-white/20 rounded-lg text-xs font-bold\">\n                  {patient.bloodType}\n                </span>\n              )}\n            </div>\n            <div className=\"mt-2 flex flex-wrap gap-2 text-xs\">\n              <span className=\"px-2 py-1 bg-white/20 rounded-lg\">{patient.gender}</span>\n              <span className=\"px-2 py-1 bg-white/20 rounded-lg\">{patient.age}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Patient Details */}\n      <div className=\"p-4 space-y-3\">\n        <div className=\"flex items-center gap-3 text-sm\">\n          <CreditCard size={16} className=\"text-slate-400 shrink-0\" />\n          <span className=\"text-slate-600 dark:text-slate-400 font-mono\">{patient.cid}</span>\n        </div>\n        {patient.phone && (\n          <div className=\"flex items-center gap-3 text-sm\">\n            <Phone size={16} className=\"text-slate-400 shrink-0\" />\n            <a href={`tel:${patient.phone}`} className=\"text-primary-600 dark:text-primary-400\">\n              {patient.phone}\n            </a>\n          </div>\n        )}\n        <div className=\"flex items-start gap-3 text-sm\">\n          <MapPin size={16} className=\"text-slate-400 shrink-0 mt-0.5\" />\n          <span className=\"text-slate-600 dark:text-slate-400 line-clamp-2\">{patient.address}</span>\n        </div>\n\n        {/* Allergies Warning */}\n        {patient.allergies && patient.allergies.length > 0 && (\n          <div className=\"mt-3 p-3 bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/30 rounded-xl\">\n            <div className=\"flex items-center gap-2 text-red-600 dark:text-red-400 text-sm font-medium\">\n              <AlertCircle size={16} />\n              <span>แพ้ยา</span>\n            </div>\n            <div className=\"mt-1 flex flex-wrap gap-1\">\n              {patient.allergies.map((allergy, i) => (\n                <span key={i} className=\"px-2 py-0.5 bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-300 rounded text-xs\">\n                  {allergy}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Last Visit */}\n        {patient.lastVisit && (\n          <div className=\"flex items-center gap-2 text-xs text-slate-400 pt-2 border-t border-slate-100 dark:border-slate-800\">\n            <History size={12} />\n            <span>มาครั้งสุดท้าย: {patient.lastVisit}</span>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\n// Collapsible Section Component\nconst CollapsibleSection: React.FC<{\n  title: string;\n  icon: React.ReactNode;\n  children: React.ReactNode;\n  defaultOpen?: boolean;\n  badge?: string;\n  badgeColor?: 'blue' | 'amber' | 'red' | 'emerald';\n}> = ({ title, icon, children, defaultOpen = true, badge, badgeColor = 'blue' }) => {\n  const [isOpen, setIsOpen] = useState(defaultOpen);\n\n  const badgeColors = {\n    blue: 'bg-blue-100 text-blue-700 dark:bg-blue-500/20 dark:text-blue-400',\n    amber: 'bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-400',\n    red: 'bg-red-100 text-red-700 dark:bg-red-500/20 dark:text-red-400',\n    emerald: 'bg-emerald-100 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-400',\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden\">\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"w-full px-4 py-3 flex items-center justify-between bg-slate-50 dark:bg-slate-800/50 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors\"\n      >\n        <div className=\"flex items-center gap-3\">\n          <span className=\"text-slate-500 dark:text-slate-400\">{icon}</span>\n          <span className=\"font-medium text-slate-900 dark:text-white text-sm lg:text-base\">{title}</span>\n          {badge && (\n            <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${badgeColors[badgeColor]}`}>\n              {badge}\n            </span>\n          )}\n        </div>\n        {isOpen ? (\n          <ChevronUp size={18} className=\"text-slate-400\" />\n        ) : (\n          <ChevronDown size={18} className=\"text-slate-400\" />\n        )}\n      </button>\n      {isOpen && <div className=\"p-4\">{children}</div>}\n    </div>\n  );\n};\n\n// Form Field Component\nconst FormField: React.FC<{\n  label: string;\n  required?: boolean;\n  children: React.ReactNode;\n  className?: string;\n}> = ({ label, required, children, className = '' }) => (\n  <div className={`space-y-1.5 ${className}`}>\n    <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300\">\n      {label}\n      {required && <span className=\"text-red-500 ml-1\">*</span>}\n    </label>\n    {children}\n  </div>\n);\n\n// Urgency Selector Component\nconst UrgencySelector: React.FC<{\n  value: string;\n  onChange: (value: string) => void;\n}> = ({ value, onChange }) => {\n  const options = [\n    { value: 'normal', label: 'ปกติ', color: 'emerald', icon: '🟢' },\n    { value: 'urgent', label: 'เร่งด่วน', color: 'amber', icon: '🟡' },\n    { value: 'emergency', label: 'ฉุกเฉิน', color: 'red', icon: '🔴' },\n  ];\n\n  return (\n    <div className=\"flex gap-2\">\n      {options.map((opt) => (\n        <button\n          key={opt.value}\n          onClick={() => onChange(opt.value)}\n          className={`\n            flex-1 px-3 py-2.5 rounded-xl text-sm font-medium transition-all\n            flex items-center justify-center gap-2\n            ${value === opt.value\n              ? opt.color === 'emerald'\n                ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/30'\n                : opt.color === 'amber'\n                  ? 'bg-amber-500 text-white shadow-lg shadow-amber-500/30'\n                  : 'bg-red-500 text-white shadow-lg shadow-red-500/30 animate-pulse'\n              : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700'\n            }\n          `}\n        >\n          <span>{opt.icon}</span>\n          <span className=\"hidden sm:inline\">{opt.label}</span>\n        </button>\n      ))}\n    </div>\n  );\n};\n\n// Patient Status Selector\nconst PatientStatusSelector: React.FC<{\n  value: string;\n  onChange: (value: string) => void;\n}> = ({ value, onChange }) => {\n  return (\n    <div className=\"flex gap-2\">\n      {patientStatusOptions.map((opt) => (\n        <button\n          key={opt.value}\n          onClick={() => onChange(opt.value)}\n          className={`\n            flex-1 px-3 py-2.5 rounded-xl text-sm font-medium transition-all\n            flex flex-col items-center gap-1\n            ${value === opt.value\n              ? 'bg-primary-500 text-white shadow-lg shadow-primary-500/30'\n              : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700'\n            }\n          `}\n        >\n          <span className=\"text-lg\">{opt.icon}</span>\n          <span className=\"text-xs\">{opt.label}</span>\n        </button>\n      ))}\n    </div>\n  );\n};\n\n// ============================================\n// Main Component\n// ============================================\nexport default function OpdNewVisitResponsive() {\n  const router = useRouter();\n\n  // ==========================================\n  // Lookup data from API\n  // ==========================================\n  const {\n    visitTypeOptions,\n    pttypeOptions,\n    departmentOptions,\n    spcltyOptions,\n    isLoading: lookupsLoading,\n    error: lookupsError,\n  } = useOpdVisitLookups();\n\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [searchHn, setSearchHn] = useState('');\n  const [selectedPatientItem, setSelectedPatientItem] = useState<PatientListItem | null>(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [lockLastVisit, setLockLastVisit] = useState(false);\n  const [showMoreActions, setShowMoreActions] = useState(false);\n\n  // Patient data\n  const [patient, setPatient] = useState<Patient | null>(null);\n  \n  // Smart Card photo (fallback when no photo in DB)\n  const [smartCardPhoto, setSmartCardPhoto] = useState<string | null>(null);\n\n  // NHSO states\n  const [showNhsoLoginModal, setShowNhsoLoginModal] = useState(false);\n  const [showNhsoRightsModal, setShowNhsoRightsModal] = useState(false);\n  const [nhsoLoading, setNhsoLoading] = useState(false);\n  const [nhsoError, setNhsoError] = useState<string | null>(null);\n  const [nhsoRights, setNhsoRights] = useState<NhsoPersonalFund | null>(null);\n\n  // Form data\n  const [formData, setFormData] = useState<FormData>({\n    visitDate: new Date().toISOString().split('T')[0],\n    visitTime: '',\n    visitType: '',\n    pttype: '',\n    pttypeName: '',\n    chiefComplaint: '',\n    department: '',\n    spclty: '',\n    cid: '',\n    patientType: 'general',\n    timeType: 'intime',\n    urgency: 'normal',\n    patientStatus: 'walkin',\n  });\n\n  // ==========================================\n  // Set default values when lookups loaded\n  // ==========================================\n  useEffect(() => {\n    if (visitTypeOptions.length > 0 && !formData.visitType) {\n      // Find default visit type (e.g., 'W' for Walk-in or first option)\n      const defaultVisitType = visitTypeOptions.find(v => v.value === 'W') || visitTypeOptions[0];\n      if (defaultVisitType) {\n        setFormData(prev => ({\n          ...prev,\n          visitType: defaultVisitType.value,\n        }));\n      }\n    }\n  }, [visitTypeOptions, formData.visitType]);\n\n  useEffect(() => {\n    if (pttypeOptions.length > 0 && !formData.pttype) {\n      // Find default pttype (e.g., '10' for ชำระเงินเอง or first option)\n      const defaultPttype = pttypeOptions.find(p => p.value === '10') || pttypeOptions[0];\n      if (defaultPttype) {\n        setFormData(prev => ({\n          ...prev,\n          pttype: defaultPttype.value,\n          pttypeName: defaultPttype.label.split(' - ')[1] || defaultPttype.label,\n        }));\n      }\n    }\n  }, [pttypeOptions, formData.pttype]);\n\n  // Update time\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  // Handle patient selection from search\n  const handlePatientSelect = async (\n    hn: string, \n    patientItem: PatientListItem | null,\n    cardPhoto?: string | null\n  ) => {\n    setSearchHn(hn);\n    setSelectedPatientItem(patientItem);\n\n    // Store smart card photo for fallback\n    if (cardPhoto) {\n      setSmartCardPhoto(cardPhoto);\n    }\n\n    if (!hn || !patientItem) {\n      setPatient(null);\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // Fetch full patient details and image in parallel\n      const [detailResponse, imageData] = await Promise.all([\n        patientApi.getByHn(hn),\n        patientImageApi.getProfileImage(hn).catch(() => null),\n      ]);\n\n      if (detailResponse.success && detailResponse.data) {\n        const detail = detailResponse.data;\n\n        // Build photo URL or base64 data\n        // Priority: DB image > Smart Card image > null\n        let photoUrl: string | null = null;\n        if (imageData?.image) {\n          // Image from database (base64 encoded)\n          photoUrl = imageData.image.startsWith('data:')\n            ? imageData.image\n            : `data:image/jpeg;base64,${imageData.image}`;\n        } else if (cardPhoto) {\n          // Fallback to Smart Card photo\n          photoUrl = cardPhoto.startsWith('data:')\n            ? cardPhoto\n            : `data:image/jpeg;base64,${cardPhoto}`;\n        }\n\n        setPatient({\n          hn: detail.hn,\n          name: detail.fullName,\n          gender: String(detail.sex) === '1' ? 'ชาย' : String(detail.sex) === '2' ? 'หญิง' : '-',\n          age: detail.ageText || `${detail.age || 0} ปี`,\n          birthDate: detail.birthday || '',\n          address: detail.fullAddress || '',\n          cid: detail.cid ? detail.cid.replace(/(\\d{1})(\\d{4})(\\d{5})(\\d{2})(\\d{1})/, '$1-$2-$3-$4-$5') : '',\n          phone: detail.mobilePhone || detail.hometel || '',\n          photo: photoUrl,\n          bloodType: detail.bloodgrp ? `${detail.bloodgrp}${detail.bloodgroupRh || ''}` : undefined,\n          allergies: detail.allergies || [],\n          lastVisit: detail.lastVisit || undefined,\n          pttypeName: detail.pttypeName,\n        });\n\n        // Update form with patient's pttype\n        const patientPttype = pttypeOptions.find(p => p.value === detail.pttype);\n        setFormData((prev) => ({\n          ...prev,\n          cid: detail.cid || '',\n          pttype: detail.pttype || prev.pttype,\n          pttypeName: patientPttype?.label.split(' - ')[1] || detail.pttypeName || prev.pttypeName,\n        }));\n      }\n    } catch (error) {\n      console.error('Error fetching patient details:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleSave = async () => {\n    if (!patient) return;\n    setSaving(true);\n    await new Promise((r) => setTimeout(r, 1500));\n    setSaving(false);\n    // Show success & redirect\n  };\n\n  const handleClear = () => {\n    setPatient(null);\n    setSearchHn('');\n    setSelectedPatientItem(null);\n    setSmartCardPhoto(null);\n\n    // Reset to default values from lookups\n    const defaultVisitType = visitTypeOptions.find(v => v.value === 'W') || visitTypeOptions[0];\n    const defaultPttype = pttypeOptions.find(p => p.value === '10') || pttypeOptions[0];\n\n    setFormData({\n      visitDate: new Date().toISOString().split('T')[0],\n      visitTime: '',\n      visitType: defaultVisitType?.value || '',\n      pttype: defaultPttype?.value || '',\n      pttypeName: defaultPttype?.label.split(' - ')[1] || '',\n      chiefComplaint: '',\n      department: '',\n      spclty: '',\n      cid: '',\n      patientType: 'general',\n      timeType: 'intime',\n      urgency: 'normal',\n      patientStatus: 'walkin',\n    });\n  };\n\n  const handleNewPatientFromCard = (cardData: SmartCardData) => {\n    router.push(`/patients/register?cid=${cardData.cid}`);\n  };\n\n  // ==========================================\n  // NHSO Functions\n  // ==========================================\n  \n  /**\n   * Get clean CID (remove dashes)\n   */\n  const getCleanCid = (): string => {\n    const cid = formData.cid || patient?.cid || '';\n    return cid.replace(/-/g, '');\n  };\n\n  /**\n   * Check if NHSO button should be enabled\n   */\n  const canCheckNhso = (): boolean => {\n    const cleanCid = getCleanCid();\n    return cleanCid.length === 13 && !!patient;\n  };\n\n  /**\n   * Handle NHSO button click\n   */\n  const handleNHSO = async () => {\n    const cleanCid = getCleanCid();\n    \n    if (!cleanCid || cleanCid.length !== 13) {\n      return;\n    }\n\n    // Check if we have a valid token\n    const tokenStatus = await nhsoApi.getTokenStatus();\n    \n    if (!tokenStatus.success || tokenStatus.data?.needsRelogin) {\n      // No token or expired - show login modal\n      setShowNhsoLoginModal(true);\n    } else {\n      // Have valid token - search directly\n      await searchNhsoRights(cleanCid);\n    }\n  };\n\n  /**\n   * Handle successful NHSO login\n   */\n  const handleNhsoLoginSuccess = async (username: string) => {\n    const cleanCid = getCleanCid();\n    if (cleanCid) {\n      await searchNhsoRights(cleanCid);\n    }\n  };\n\n  /**\n   * Search NHSO rights by CID\n   */\n  const searchNhsoRights = async (cid: string) => {\n    setShowNhsoRightsModal(true);\n    setNhsoLoading(true);\n    setNhsoError(null);\n    setNhsoRights(null);\n\n    try {\n      const result = await nhsoApi.searchByPid(cid);\n\n      if (result.success && result.data) {\n        setNhsoRights(result.data);\n      } else {\n        setNhsoError(result.message || 'ไม่สามารถตรวจสอบสิทธิ์ได้');\n      }\n    } catch (err) {\n      setNhsoError(err instanceof Error ? err.message : 'เกิดข้อผิดพลาดในการตรวจสอบ');\n    } finally {\n      setNhsoLoading(false);\n    }\n  };\n\n  /**\n   * Retry NHSO search\n   */\n  const handleNhsoRetry = () => {\n    const cleanCid = getCleanCid();\n    if (cleanCid) {\n      searchNhsoRights(cleanCid);\n    }\n  };\n\n  /**\n   * Apply NHSO rights to form\n   */\n  const handleApplyNhsoRights = (rights: NhsoPersonalFund) => {\n    // Map NHSO rights to pttype if possible\n    // This mapping depends on your hospital's pttype configuration\n    const nhsoToPttypeMap: Record<string, string> = {\n      'UCS': 'T1',    // บัตรทอง\n      'OFC': 'A7',    // ข้าราชการ  \n      'SSS': 'B1',    // ประกันสังคม\n      'LGO': 'A1',    // อปท.\n      // Add more mappings as needed\n    };\n\n    const mappedPttype = rights.mainInscl ? nhsoToPttypeMap[rights.mainInscl] : null;\n    \n    if (mappedPttype) {\n      const pttypeOption = pttypeOptions.find(p => p.value === mappedPttype);\n      if (pttypeOption) {\n        setFormData(prev => ({\n          ...prev,\n          pttype: mappedPttype,\n          pttypeName: pttypeOption.label.split(' - ')[1] || pttypeOption.label,\n        }));\n      }\n    }\n\n    // Close modal\n    setShowNhsoRightsModal(false);\n  };\n  \n\n  // ==========================================\n  // Loading State\n  // ==========================================\n  if (lookupsLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <div className=\"text-center\">\n            <Loader2 className=\"size-10 text-primary-500 animate-spin mx-auto mb-4\" />\n            <p className=\"text-slate-500 dark:text-slate-400\">กำลังโหลดข้อมูล...</p>\n          </div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  // ==========================================\n  // Error State\n  // ==========================================\n  if (lookupsError) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <div className=\"text-center\">\n            <AlertCircle className=\"size-12 text-red-500 mx-auto mb-4\" />\n            <p className=\"text-red-500 mb-4\">{lookupsError}</p>\n            <button\n              onClick={() => window.location.reload()}\n              className=\"px-4 py-2 bg-primary-500 text-white rounded-xl hover:bg-primary-600 transition-colors\"\n            >\n              ลองใหม่\n            </button>\n          </div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"min-h-screen pb-24 lg:pb-6\">\n        {/* ============================================ */}\n        {/* Header - Sticky on mobile */}\n        {/* ============================================ */}\n        <div className=\"sticky top-0 z-30 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 -mx-4 px-4 lg:mx-0 lg:px-0 lg:bg-transparent lg:border-0 lg:static\">\n          <div className=\"py-3 lg:py-0 lg:mb-6\">\n            {/* Mobile Header */}\n            <div className=\"flex items-center justify-between lg:hidden\">\n              <button\n                onClick={() => router.back()}\n                className=\"p-2 -ml-2 text-slate-600 dark:text-slate-400\"\n              >\n                <ArrowLeft size={20} />\n              </button>\n              <h1 className=\"font-bold text-slate-900 dark:text-white\">ส่งตรวจผู้ป่วยนอก</h1>\n              <button\n                onClick={() => setShowMoreActions(!showMoreActions)}\n                className=\"p-2 -mr-2 text-slate-600 dark:text-slate-400\"\n              >\n                <MoreVertical size={20} />\n              </button>\n            </div>\n\n            {/* Desktop Header */}\n            <div className=\"hidden lg:flex items-center justify-between bg-gradient-to-r from-primary-600 to-primary-700 dark:from-primary-700 dark:to-primary-800 rounded-2xl p-4 shadow-lg\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"size-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center\">\n                  <ClipboardList size={24} className=\"text-white\" />\n                </div>\n                <div>\n                  <h1 className=\"text-xl font-bold text-white\">ส่งตรวจผู้ป่วยนอก (OPD)</h1>\n                  <p className=\"text-white/70 text-sm\">ลงทะเบียนส่งตรวจผู้ป่วยใหม่</p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <div className=\"text-right text-white\">\n                  <div className=\"text-2xl font-bold font-mono\">\n                    {currentTime.toLocaleTimeString('th-TH')}\n                  </div>\n                  <div className=\"text-sm text-white/70\">\n                    {currentTime.toLocaleDateString('th-TH', {\n                      weekday: 'long',\n                      day: 'numeric',\n                      month: 'long',\n                      year: 'numeric'\n                    })}\n                  </div>\n                </div>\n                <button\n                  onClick={() => router.back()}\n                  className=\"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors\"\n                >\n                  <X size={20} />\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Search Bar - Always visible */}\n          <div className=\"py-3 lg:py-0 lg:mb-6\">\n            <div className=\"bg-white dark:bg-slate-900 lg:bg-slate-50 lg:dark:bg-slate-800/50 rounded-2xl p-4 border border-slate-200 dark:border-slate-700 shadow-sm lg:shadow-none\">\n\n              {/* Main Search Row */}\n              <div className=\"flex items-center gap-2\">\n                {/* Patient Search - Full width on mobile */}\n                <div className=\"flex-1 min-w-0\">\n                  <SearchablePatientSelect\n                    value={searchHn}\n                    onChange={handlePatientSelect}\n                    placeholder=\"ค้นหา HN, ชื่อ, เลขบัตร...\"\n                    disabled={loading}\n                    initialPatient={selectedPatientItem}\n                    limit={20}\n                    className=\"w-full\"\n                  />\n                </div>\n\n                {/* Action Buttons - Compact on mobile */}\n                <div className=\"flex items-center gap-1.5 shrink-0\">\n                  {/* QR Code Button */}\n                  <button\n                    className=\"\n                      size-11 rounded-xl flex items-center justify-center\n                      bg-slate-100 dark:bg-slate-800 \n                      text-slate-600 dark:text-slate-400 \n                      hover:bg-slate-200 dark:hover:bg-slate-700 \n                      active:scale-95 transition-all\n                    \"\n                    title=\"สแกน QR Code\"\n                  >\n                    <QrCode size={20} />\n                  </button>\n\n                  {/* Smart Card Button */}\n                  <SmartCardButton\n                    onPatientFound={handlePatientSelect}\n                    onNewPatient={handleNewPatientFromCard}\n                    onError={(err) => console.error(err)}\n                    disabled={loading}\n                    serverUrl=\"http://localhost:8080\"\n                    className=\"size-11\"\n                  />\n                </div>\n              </div>\n\n              {/* Date/Time Bar - Mobile Only */}\n              <div className=\"flex items-center justify-between mt-3 pt-3 border-t border-slate-100 dark:border-slate-700/50 lg:hidden\">\n                <div className=\"flex items-center gap-3\">\n                  {/* Date Chip */}\n                  <div className=\"flex items-center gap-1.5 px-2.5 py-1.5 bg-slate-100 dark:bg-slate-800 rounded-lg\">\n                    <Calendar size={14} className=\"text-slate-400\" />\n                    <span className=\"text-xs font-medium text-slate-600 dark:text-slate-300\">\n                      {currentTime.toLocaleDateString('th-TH', {\n                        day: 'numeric',\n                        month: 'short',\n                        year: '2-digit'\n                      })}\n                    </span>\n                  </div>\n\n                  {/* Time Chip */}\n                  <div className=\"flex items-center gap-1.5 px-2.5 py-1.5 bg-primary-50 dark:bg-primary-500/10 rounded-lg\">\n                    <Clock size={14} className=\"text-primary-500\" />\n                    <span className=\"text-xs font-mono font-semibold text-primary-600 dark:text-primary-400\">\n                      {currentTime.toLocaleTimeString('th-TH', {\n                        hour: '2-digit',\n                        minute: '2-digit'\n                      })}\n                    </span>\n                  </div>\n                </div>\n\n                {/* Quick Status Indicator */}\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"size-2 rounded-full bg-emerald-500 animate-pulse\" />\n                  <span className=\"text-xs text-slate-400\">Online</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ============================================ */}\n        {/* Main Content */}\n        {/* ============================================ */}\n        <div className=\"mt-4 lg:mt-0\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6\">\n\n            {/* ============================================ */}\n            {/* Left Column - Patient Card (Mobile: Top) */}\n            {/* ============================================ */}\n            <div className=\"lg:col-span-1 order-1 lg:order-2\">\n              <div className=\"lg:sticky lg:top-6 space-y-4\">\n                <PatientCard patient={patient} loading={loading} />\n\n                {/* Quick Options - Desktop Only */}\n                {patient && (\n                  <div className=\"hidden lg:block bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden\">\n                    {/* Header */}\n                    <div className=\"px-4 py-3 bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-800/50 border-b border-slate-200 dark:border-slate-700\">\n                      <h3 className=\"text-sm font-semibold text-slate-700 dark:text-slate-300\">ตัวเลือกด่วน</h3>\n                    </div>\n\n                    <div className=\"p-4 space-y-5\">\n                      {/* Urgency Selector - Modern Card Style */}\n                      <div className=\"space-y-2\">\n                        <label className=\"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider\">\n                          ความเร่งด่วน\n                        </label>\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {[\n                            { value: 'normal', label: 'ปกติ', icon: '●', color: 'emerald' },\n                            { value: 'urgent', label: 'เร่งด่วน', icon: '●', color: 'amber' },\n                            { value: 'emergency', label: 'ฉุกเฉิน', icon: '●', color: 'red' },\n                          ].map((opt) => (\n                            <button\n                              key={opt.value}\n                              onClick={() => setFormData({ ...formData, urgency: opt.value })}\n                              className={`\n                                relative group p-3 rounded-xl border-2 transition-all duration-200\n                                ${formData.urgency === opt.value\n                                  ? opt.color === 'emerald'\n                                    ? 'border-emerald-500 bg-emerald-50 dark:bg-emerald-500/10'\n                                    : opt.color === 'amber'\n                                      ? 'border-amber-500 bg-amber-50 dark:bg-amber-500/10'\n                                      : 'border-red-500 bg-red-50 dark:bg-red-500/10 animate-pulse'\n                                  : 'border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800/50'\n                                }\n                              `}\n                            >\n                              <div className=\"flex flex-col items-center gap-1.5\">\n                                <span className={`\n                                  text-lg transition-transform group-hover:scale-110\n                                  ${formData.urgency === opt.value\n                                    ? opt.color === 'emerald'\n                                      ? 'text-emerald-500'\n                                      : opt.color === 'amber'\n                                        ? 'text-amber-500'\n                                        : 'text-red-500'\n                                    : 'text-slate-300 dark:text-slate-600'\n                                  }\n                                `}>\n                                  {opt.icon}\n                                </span>\n                                <span className={`\n                                  text-xs font-medium\n                                  ${formData.urgency === opt.value\n                                    ? opt.color === 'emerald'\n                                      ? 'text-emerald-700 dark:text-emerald-400'\n                                      : opt.color === 'amber'\n                                        ? 'text-amber-700 dark:text-amber-400'\n                                        : 'text-red-700 dark:text-red-400'\n                                    : 'text-slate-600 dark:text-slate-400'\n                                  }\n                                `}>\n                                  {opt.label}\n                                </span>\n                              </div>\n                              {/* Selected indicator */}\n                              {formData.urgency === opt.value && (\n                                <div className={`\n                                  absolute -top-1 -right-1 size-4 rounded-full flex items-center justify-center\n                                  ${opt.color === 'emerald' ? 'bg-emerald-500' : opt.color === 'amber' ? 'bg-amber-500' : 'bg-red-500'}\n                                `}>\n                                  <svg className=\"size-2.5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={3}>\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n                                  </svg>\n                                </div>\n                              )}\n                            </button>\n                          ))}\n                        </div>\n                      </div>\n\n                      {/* Divider */}\n                      <div className=\"border-t border-dashed border-slate-200 dark:border-slate-700\" />\n\n                      {/* Patient Status - Icon Cards */}\n                      <div className=\"space-y-2\">\n                        <label className=\"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider\">\n                          สภาพผู้ป่วย\n                        </label>\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {patientStatusOptions.map((opt) => (\n                            <button\n                              key={opt.value}\n                              onClick={() => setFormData({ ...formData, patientStatus: opt.value })}\n                              className={`\n                                relative group p-3 rounded-xl border-2 transition-all duration-200\n                                ${formData.patientStatus === opt.value\n                                  ? 'border-primary-500 bg-primary-50 dark:bg-primary-500/10 shadow-sm shadow-primary-500/20'\n                                  : 'border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800/50'\n                                }\n                              `}\n                            >\n                              <div className=\"flex flex-col items-center gap-1.5\">\n                                <span className=\"text-2xl transition-transform group-hover:scale-110\">\n                                  {opt.icon}\n                                </span>\n                                <span className={`\n                                  text-xs font-medium\n                                  ${formData.patientStatus === opt.value\n                                    ? 'text-primary-700 dark:text-primary-400'\n                                    : 'text-slate-600 dark:text-slate-400'\n                                  }\n                                `}>\n                                  {opt.label}\n                                </span>\n                              </div>\n                              {/* Selected indicator */}\n                              {formData.patientStatus === opt.value && (\n                                <div className=\"absolute -top-1 -right-1 size-4 rounded-full bg-primary-500 flex items-center justify-center\">\n                                  <svg className=\"size-2.5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={3}>\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n                                  </svg>\n                                </div>\n                              )}\n                            </button>\n                          ))}\n                        </div>\n                      </div>\n\n                      {/* Divider */}\n                      <div className=\"border-t border-dashed border-slate-200 dark:border-slate-700\" />\n\n                      {/* Time Type - Toggle Switch Style */}\n                      <div className=\"space-y-2\">\n                        <label className=\"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider\">\n                          ประเภทเวลา\n                        </label>\n                        <div className=\"relative bg-slate-100 dark:bg-slate-800 rounded-xl p-1\">\n                          {/* Sliding background */}\n                          <div\n                            className={`\n                              absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white dark:bg-slate-700 rounded-lg shadow-sm\n                              transition-all duration-300 ease-out\n                              ${formData.timeType === 'outtime' ? 'left-[calc(50%+2px)]' : 'left-1'}\n                            `}\n                          />\n                          <div className=\"relative grid grid-cols-2 gap-1\">\n                            <button\n                              onClick={() => setFormData({ ...formData, timeType: 'intime' })}\n                              className={`\n                                relative z-10 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors duration-200\n                                ${formData.timeType === 'intime'\n                                  ? 'text-primary-600 dark:text-primary-400'\n                                  : 'text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300'\n                                }\n                              `}\n                            >\n                              <div className=\"flex items-center justify-center gap-2\">\n                                <svg className=\"size-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\" />\n                                </svg>\n                                <span>ในเวลา</span>\n                              </div>\n                            </button>\n                            <button\n                              onClick={() => setFormData({ ...formData, timeType: 'outtime' })}\n                              className={`\n                                relative z-10 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors duration-200\n                                ${formData.timeType === 'outtime'\n                                  ? 'text-primary-600 dark:text-primary-400'\n                                  : 'text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300'\n                                }\n                              `}\n                            >\n                              <div className=\"flex items-center justify-center gap-2\">\n                                <svg className=\"size-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\" />\n                                </svg>\n                                <span>นอกเวลา</span>\n                              </div>\n                            </button>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* ============================================ */}\n            {/* Right Column - Form Sections */}\n            {/* ============================================ */}\n            <div className=\"lg:col-span-2 order-2 lg:order-1 space-y-4\">\n\n              {/* Visit Type & Rights */}\n              <CollapsibleSection\n                title=\"ประเภทการมา & สิทธิการรักษา\"\n                icon={<Shield size={18} />}\n                badge={formData.pttypeName}\n                badgeColor=\"blue\"\n              >\n                <div className=\"space-y-4\">\n                  {/* Visit Type */}\n                  <FormField label=\"ประเภทการมา\">\n                    <div className=\"flex gap-2\">\n                      <input\n                        type=\"text\"\n                        value={formData.visitType}\n                        readOnly\n                        className=\"w-16 px-3 py-2.5 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm text-center font-mono\"\n                      />\n                      <div className=\"flex-1\">\n                        <CustomSelect\n                          options={visitTypeOptions}\n                          value={formData.visitType}\n                          dropdownTitle='เลือกประเภทการมา'\n                          showBackdrop={true}\n                          onChange={(val) => setFormData({ ...formData, visitType: val })}\n                        />\n                      </div>\n                    </div>\n                  </FormField>\n\n                  {/* Rights */}\n                  <FormField label=\"สิทธิการรักษา\" required>\n                    <div className=\"flex flex-col sm:flex-row gap-2\">\n                      <input\n                        type=\"text\"\n                        value={formData.pttype}\n                        readOnly\n                        className=\"w-full sm:w-16 px-3 py-2.5 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm text-center font-mono\"\n                      />\n                      <div className=\"flex-1\">\n                        <CustomSelect\n                          options={pttypeOptions}\n                          value={formData.pttype}\n                          onChange={(val) => {\n                            const selected = pttypeOptions.find((o) => o.value === val);\n                            setFormData({\n                              ...formData,\n                              pttype: val,\n                              pttypeName: selected?.label.split(' - ')[1] || '',\n                            });\n                          }}\n                        />\n                      </div>\n                      <button\n                        onClick={handleNHSO}\n                        disabled={!canCheckNhso()}\n                        className={`\n                          px-4 py-2.5 rounded-xl text-sm font-medium whitespace-nowrap\n                          transition-all duration-200 flex items-center gap-2\n                          ${canCheckNhso()\n                            ? 'bg-blue-500 text-white hover:bg-blue-600 shadow-lg shadow-blue-500/30 hover:shadow-blue-500/40'\n                            : 'bg-slate-100 dark:bg-slate-800 text-slate-400 dark:text-slate-500 cursor-not-allowed'\n                          }\n                        `}\n                        title={!canCheckNhso() ? 'กรุณาเลือกผู้ป่วยที่มีเลขบัตรประชาชนก่อน' : 'ตรวจสอบสิทธิ์ สปสช.'}\n                      >\n                        <Shield size={16} />\n                        NHSO\n                      </button>\n                    </div>\n                  </FormField>\n\n                  {/* Lock Last Visit */}\n                  <label className=\"flex items-center gap-3 cursor-pointer p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl\">\n                    <input\n                      type=\"checkbox\"\n                      checked={lockLastVisit}\n                      onChange={(e) => setLockLastVisit(e.target.checked)}\n                      className=\"size-5 rounded border-slate-300 text-primary-500 focus:ring-primary-500/20\"\n                    />\n                    <div className=\"flex items-center gap-2\">\n                      {lockLastVisit ? <Lock size={16} className=\"text-primary-500\" /> : <Unlock size={16} className=\"text-slate-400\" />}\n                      <span className=\"text-sm text-slate-600 dark:text-slate-400\">Lock ตามมาครั้งสุดท้าย</span>\n                    </div>\n                  </label>\n                </div>\n              </CollapsibleSection>\n\n              {/* Chief Complaint */}\n              <CollapsibleSection\n                title=\"อาการสำคัญ\"\n                icon={<Activity size={18} />}\n              >\n                <FormField label=\"อาการสำคัญ (Chief Complaint)\" required>\n                  <textarea\n                    value={formData.chiefComplaint}\n                    onChange={(e) => setFormData({ ...formData, chiefComplaint: e.target.value })}\n                    placeholder=\"ระบุอาการสำคัญที่นำผู้ป่วยมาพบแพทย์...\"\n                    rows={3}\n                    className=\"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 resize-none\"\n                  />\n                </FormField>\n              </CollapsibleSection>\n\n              {/* Department & Specialty */}\n              <CollapsibleSection\n                title=\"ส่งต่อไปห้องตรวจ\"\n                icon={<Stethoscope size={18} />}\n              >\n                <div className=\"space-y-4\">\n                  {/* Department */}\n                  <FormField label=\"ห้องตรวจ\" required>\n                    <div className=\"flex gap-2\">\n                      <input\n                        type=\"text\"\n                        value={formData.department ? formData.department.substring(0, 3) : '###'}\n                        readOnly\n                        className=\"w-16 px-3 py-2.5 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm text-center font-mono\"\n                      />\n                      <div className=\"flex-1\">\n                        <CustomSelect\n                          options={departmentOptions}\n                          value={formData.department}\n                          showBackdrop={true}\n                          dropdownTitle=\"เลือกห้องตรวจ\"\n                          onChange={(val) => setFormData({ ...formData, department: val })}\n                          placeholder=\"เลือกห้องตรวจ...\"\n                        />\n                      </div>\n                    </div>\n                  </FormField>\n\n                  {/* Specialty */}\n                  <FormField label=\"แผนก\" required>\n                    <div className=\"flex gap-2\">\n                      <input\n                        type=\"text\"\n                        value={formData.spclty ? formData.spclty.substring(0, 3) : '###'}\n                        readOnly\n                        className=\"w-16 px-3 py-2.5 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm text-center font-mono\"\n                      />\n                      <div className=\"flex-1\">\n                        <CustomSelect\n                          options={spcltyOptions}\n                          value={formData.spclty}\n                          showBackdrop={true}\n                          dropdownTitle=\"เลือกแผนก\"\n                          onChange={(val) => setFormData({ ...formData, spclty: val })}\n                          placeholder=\"เลือกแผนก...\"\n                        />\n                      </div>\n                    </div>\n                  </FormField>\n                </div>\n              </CollapsibleSection>\n\n              {/* CID Verification */}\n              <CollapsibleSection\n                title=\"ยืนยันตัวตน\"\n                icon={<CreditCard size={18} />}\n              >\n                <FormField label=\"เลขบัตรประชาชน\">\n                  <div className=\"flex flex-col sm:flex-row gap-2\">\n                    <input\n                      type=\"text\"\n                      value={formData.cid}\n                      onChange={(e) => setFormData({ ...formData, cid: e.target.value })}\n                      placeholder=\"#-####-#####-##-#\"\n                      className=\"flex-1 px-4 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-mono focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500\"\n                    />\n                    <div className=\"flex gap-2\">\n                      <button className=\"flex-1 sm:flex-none px-4 py-2.5 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors text-sm font-medium\">\n                        DFL\n                      </button>\n                      <button className=\"flex-1 sm:flex-none p-2.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 rounded-xl transition-colors\">\n                        <AlertCircle size={20} />\n                      </button>\n                    </div>\n                  </div>\n                </FormField>\n              </CollapsibleSection>\n\n              {/* Mobile: Urgency & Status */}\n              <div className=\"lg:hidden\">\n                <CollapsibleSection\n                  title=\"ตัวเลือกเพิ่มเติม\"\n                  icon={<Activity size={18} />}\n                  defaultOpen={false}\n                >\n                  <div className=\"space-y-5\">\n                    {/* Urgency Selector - Modern Card Style */}\n                    <div className=\"space-y-2\">\n                      <label className=\"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider\">\n                        ความเร่งด่วน\n                      </label>\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {[\n                          { value: 'normal', label: 'ปกติ', icon: '●', color: 'emerald' },\n                          { value: 'urgent', label: 'เร่งด่วน', icon: '●', color: 'amber' },\n                          { value: 'emergency', label: 'ฉุกเฉิน', icon: '●', color: 'red' },\n                        ].map((opt) => (\n                          <button\n                            key={opt.value}\n                            onClick={() => setFormData({ ...formData, urgency: opt.value })}\n                            className={`\n                              relative p-3 rounded-xl border-2 transition-all duration-200 active:scale-95\n                              ${formData.urgency === opt.value\n                                ? opt.color === 'emerald'\n                                  ? 'border-emerald-500 bg-emerald-50 dark:bg-emerald-500/10'\n                                  : opt.color === 'amber'\n                                    ? 'border-amber-500 bg-amber-50 dark:bg-amber-500/10'\n                                    : 'border-red-500 bg-red-50 dark:bg-red-500/10 animate-pulse'\n                                : 'border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800'\n                              }\n                            `}\n                          >\n                            <div className=\"flex flex-col items-center gap-1\">\n                              <span className={`\n                                text-base\n                                ${formData.urgency === opt.value\n                                  ? opt.color === 'emerald'\n                                    ? 'text-emerald-500'\n                                    : opt.color === 'amber'\n                                      ? 'text-amber-500'\n                                      : 'text-red-500'\n                                  : 'text-slate-300 dark:text-slate-600'\n                                }\n                              `}>\n                                {opt.icon}\n                              </span>\n                              <span className={`\n                                text-xs font-medium\n                                ${formData.urgency === opt.value\n                                  ? opt.color === 'emerald'\n                                    ? 'text-emerald-700 dark:text-emerald-400'\n                                    : opt.color === 'amber'\n                                      ? 'text-amber-700 dark:text-amber-400'\n                                      : 'text-red-700 dark:text-red-400'\n                                  : 'text-slate-600 dark:text-slate-400'\n                                }\n                              `}>\n                                {opt.label}\n                              </span>\n                            </div>\n                            {/* Selected checkmark */}\n                            {formData.urgency === opt.value && (\n                              <div className={`\n                                absolute -top-1 -right-1 size-4 rounded-full flex items-center justify-center\n                                ${opt.color === 'emerald' ? 'bg-emerald-500' : opt.color === 'amber' ? 'bg-amber-500' : 'bg-red-500'}\n                              `}>\n                                <svg className=\"size-2.5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={3}>\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n                                </svg>\n                              </div>\n                            )}\n                          </button>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Divider */}\n                    <div className=\"border-t border-dashed border-slate-200 dark:border-slate-700\" />\n\n                    {/* Patient Status - Emoji Cards */}\n                    <div className=\"space-y-2\">\n                      <label className=\"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider\">\n                        สภาพผู้ป่วย\n                      </label>\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {patientStatusOptions.map((opt) => (\n                          <button\n                            key={opt.value}\n                            onClick={() => setFormData({ ...formData, patientStatus: opt.value })}\n                            className={`\n                              relative p-3 rounded-xl border-2 transition-all duration-200 active:scale-95\n                              ${formData.patientStatus === opt.value\n                                ? 'border-primary-500 bg-primary-50 dark:bg-primary-500/10 shadow-sm'\n                                : 'border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800'\n                              }\n                            `}\n                          >\n                            <div className=\"flex flex-col items-center gap-1\">\n                              <span className=\"text-xl\">{opt.icon}</span>\n                              <span className={`\n                                text-xs font-medium\n                                ${formData.patientStatus === opt.value\n                                  ? 'text-primary-700 dark:text-primary-400'\n                                  : 'text-slate-600 dark:text-slate-400'\n                                }\n                              `}>\n                                {opt.label}\n                              </span>\n                            </div>\n                            {/* Selected checkmark */}\n                            {formData.patientStatus === opt.value && (\n                              <div className=\"absolute -top-1 -right-1 size-4 rounded-full bg-primary-500 flex items-center justify-center\">\n                                <svg className=\"size-2.5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={3}>\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n                                </svg>\n                              </div>\n                            )}\n                          </button>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Divider */}\n                    <div className=\"border-t border-dashed border-slate-200 dark:border-slate-700\" />\n\n                    {/* Time Type - Toggle Switch */}\n                    <div className=\"space-y-2\">\n                      <label className=\"text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider\">\n                        ประเภทเวลา\n                      </label>\n                      <div className=\"relative bg-slate-100 dark:bg-slate-800 rounded-xl p-1\">\n                        {/* Sliding background */}\n                        <div\n                          className={`\n                            absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white dark:bg-slate-700 rounded-lg shadow-sm\n                            transition-all duration-300 ease-out\n                            ${formData.timeType === 'outtime' ? 'left-[calc(50%+2px)]' : 'left-1'}\n                          `}\n                        />\n                        <div className=\"relative grid grid-cols-2\">\n                          <button\n                            onClick={() => setFormData({ ...formData, timeType: 'intime' })}\n                            className={`\n                              relative z-10 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors duration-200\n                              ${formData.timeType === 'intime'\n                                ? 'text-primary-600 dark:text-primary-400'\n                                : 'text-slate-500 dark:text-slate-400'\n                              }\n                            `}\n                          >\n                            <div className=\"flex items-center justify-center gap-2\">\n                              <svg className=\"size-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\" />\n                              </svg>\n                              <span>ในเวลา</span>\n                            </div>\n                          </button>\n                          <button\n                            onClick={() => setFormData({ ...formData, timeType: 'outtime' })}\n                            className={`\n                              relative z-10 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors duration-200\n                              ${formData.timeType === 'outtime'\n                                ? 'text-primary-600 dark:text-primary-400'\n                                : 'text-slate-500 dark:text-slate-400'\n                              }\n                            `}\n                          >\n                            <div className=\"flex items-center justify-center gap-2\">\n                              <svg className=\"size-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\" />\n                              </svg>\n                              <span>นอกเวลา</span>\n                            </div>\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </CollapsibleSection>\n              </div>\n\n              {/* Desktop Action Buttons */}\n              <div className=\"hidden lg:flex gap-3 pt-4\">\n                <button\n                  onClick={handleClear}\n                  className=\"px-6 py-3 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors font-medium flex items-center gap-2\"\n                >\n                  <Trash2 size={18} />\n                  ล้างข้อมูล\n                </button>\n                <button\n                  onClick={handleSave}\n                  disabled={saving || !patient || !formData.department || !formData.spclty}\n                  className=\"flex-1 px-6 py-3 bg-primary-500 text-white rounded-xl hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2 shadow-lg shadow-primary-500/30\"\n                >\n                  {saving ? (\n                    <>\n                      <Loader2 className=\"size-5 animate-spin\" />\n                      กำลังบันทึก...\n                    </>\n                  ) : (\n                    <>\n                      <Save size={18} />\n                      บันทึกและส่งตรวจ\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ============================================ */}\n        {/* Mobile Bottom Action Bar */}\n        {/* ============================================ */}\n        <div className=\"fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 p-4 lg:hidden z-40\">\n          <div className=\"flex gap-3 max-w-lg mx-auto\">\n            <button\n              onClick={handleClear}\n              className=\"px-4 py-3 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-xl transition-colors\"\n            >\n              <Trash2 size={20} />\n            </button>\n            <button\n              onClick={handleSave}\n              disabled={saving || !patient || !formData.department || !formData.spclty}\n              className=\"flex-1 py-3 bg-primary-500 text-white rounded-xl hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2\"\n            >\n              {saving ? (\n                <>\n                  <Loader2 className=\"size-5 animate-spin\" />\n                  กำลังบันทึก...\n                </>\n              ) : (\n                <>\n                  <Check size={20} />\n                  บันทึกและส่งตรวจ\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* ============================================ */}\n      {/* NHSO Modals */}\n      {/* ============================================ */}\n      \n      {/* Login Modal */}\n      <NhsoLoginModal\n        isOpen={showNhsoLoginModal}\n        onClose={() => setShowNhsoLoginModal(false)}\n        onSuccess={handleNhsoLoginSuccess}\n      />\n\n      {/* Rights Result Modal */}\n      <NhsoRightsModal\n        isOpen={showNhsoRightsModal}\n        onClose={() => setShowNhsoRightsModal(false)}\n        isLoading={nhsoLoading}\n        error={nhsoError}\n        rights={nhsoRights}\n        patientName={patient?.name}\n        patientCid={patient?.cid}\n        onRetry={handleNhsoRetry}\n        onApplyRights={handleApplyNhsoRights}\n      />\n    </AdminLayout>\n  );\n}"],"names":[],"mappings":"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"}}]
}